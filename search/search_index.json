{"config":{"lang":["hu"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Webport\u00e1lok fejleszt\u00e9se","text":""},{"location":"#webportalok-fejlesztese","title":"Webport\u00e1lok fejleszt\u00e9se","text":""},{"location":"#celkituzes","title":"C\u00e9lkit\u0171z\u00e9s","text":"<p>A t\u00e1rgy keret\u00e9ben a hallgat\u00f3k megismerkednek a modern webes port\u00e1lokkal szemben t\u00e1masztott k\u00f6vetelm\u00e9nyekkel, \u00e9s megold\u00e1sokat l\u00e1tnak azok gyakorlati megval\u00f3s\u00edt\u00e1s\u00e1ra. A c\u00e9l, hogy a hallgat\u00f3 a webes port\u00e1lokat komplex, a gyakorlatban \u00e1ltal\u00e1ban kritikus fontoss\u00e1g\u00fa megold\u00e1sk\u00e9nt l\u00e1ssa, ismerje az ilyen jelleg\u0171 projektekhez tartoz\u00f3 probl\u00e9mak\u00f6r\u00f6ket, \u00e9s tiszt\u00e1ban legyen a lehets\u00e9ges megold\u00e1si m\u00f3dokkal.</p> <p>A t\u00e1rgy \u00e1tfog\u00f3 \u00e9s teljes k\u00e9pet ad a port\u00e1lok k\u00fcl\u00f6nb\u00f6z\u0151 felhaszn\u00e1l\u00e1si ter\u00fcleteir\u0151l, k\u00fcl\u00f6n hangs\u00falyt fektetve az architekt\u00fara, a teljes\u00edtm\u00e9ny \u00e9s a biztons\u00e1g k\u00e9rd\u00e9seire.</p> <p>A t\u00e1rgyhoz kapcsol\u00f3d\u00f3 online laborok sor\u00e1n a hallgat\u00f3k sz\u00e1m\u00e1ra lehet\u0151s\u00e9g ny\u00edlik az el\u0151ad\u00e1s anyag\u00e1nak gyakorlati alkalmaz\u00e1s\u00e1ra is ASP.NET Core 10 \u00e9s Blazor WASM seg\u00edts\u00e9g\u00e9vel, \u00edgy a f\u00e9l\u00e9v v\u00e9g\u00e9re az ASP.NET Core \u00e9s Blazor WASM \u00e1ltal ny\u00fajtott teljes palett\u00e1t megismerhetik a Webport\u00e1lok fejleszt\u00e9se c\u00edm\u0171 t\u00e1rgyat v\u00e1laszt\u00f3 hallgat\u00f3k.</p> <p>A laborok sor\u00e1n k\u00e9t komplex alkalmaz\u00e1st k\u00e9sz\u00edt\u00fcnk el. Egy ASP.NET Razor Page alap\u00fat \u00e9s egy Blazor WebApp alap\u00fat. A feladatot a funkci\u00f3k, fel\u00fcletek \u00e9s adatb\u00e1zis tervez\u00e9st\u0151l, az alkalmaz\u00e1s teljes megval\u00f3s\u00edt\u00e1s\u00e1ig mely sor\u00e1n a hallgat\u00f3k egyre m\u00e9lyebben ismerhetik meg az ASP.NET lehet\u0151s\u00e9geit \u00e9s kih\u00edv\u00e1sait, hogy a f\u00e9l\u00e9v v\u00e9g\u00e9re egy komplex ASP.NET Core Razor Page vagy egy Blazor WebApp webalkalmaz\u00e1st tudjanak \u00f6n\u00e1ll\u00f3an elk\u00e9sz\u00edteni, amit a f\u00e9l\u00e9v v\u00e9g\u00e9n nagy h\u00e1zi feladat form\u00e1j\u00e1ban prezent\u00e1lni is kell.</p>"},{"location":"#mi-az-aspnet-core","title":"Mi az ASP.NET Core?","text":"<p>A .NET Core a Microsoft ny\u00edlt forr\u00e1sk\u00f3d\u00fa, t\u00f6bb platformon is (Windows, Linux, OS X) futtathat\u00f3 alkalmaz\u00e1sfejleszt\u00e9si k\u00f6rnyezete. Az ASP.NET Core pedig ennek a technol\u00f3gi\u00e1nak a felhaszn\u00e1l\u00e1s\u00e1val Windows-on, Linux-on \u00e9s Mac OS-en futtathat\u00f3 webalkalmaz\u00e1sok fejleszt\u00e9s\u00e9re szolg\u00e1l\u00f3 eszk\u00f6z. Az ASP.NET Core 3.0-ban jelent meg a Blazor, melynek seg\u00edts\u00e9g\u00e9vel kliens oldali alkalmaz\u00e1st is lehet k\u00e9sz\u00edteni .NET platformon. \u00cdgy m\u00e1r a Microsoftnak is van egy WebAssembly-re \u00e9p\u00edt\u0151 kliens oldali megold\u00e1sa, ami az Angular \u00e9s React kih\u00edv\u00f3ja lett. A t\u00e1rgy keretein bel\u00fcl a Blazor WASM-mal is megismerked\u00fcnk, de a Blazor Servert nem.</p> <p>Az ASP.NET Core 10 jelenleg a Microsoft leg\u00fajabb webfejleszt\u0151 eszk\u00f6ze, amit Visual Studio Code vagy Visual Studio 2026 seg\u00edts\u00e9g\u00e9vel fejleszthet\u00fcnk.</p>"},{"location":"#miert-idotallo-technologia-a-webes-vilagban-az-aspnet","title":"Mi\u00e9rt id\u0151t\u00e1ll\u00f3 technol\u00f3gia a webes vil\u00e1gban az ASP.NET?","text":"<p>2002-ben jelent meg el\u0151sz\u00f6r az ASP.NET 1.0, az\u00f3ta kisebb \u00e1tnevez\u00e9sekkel, mint ASP.NET MVC vagy ASP.NET Core (aminek r\u00e9sze a Blazor) m\u00e9g mindig vir\u00e1gzik.</p> <p>Kicsit zavar\u00f3ak lehetnek az elnevez\u00e9sek, hiszen a Core elnevez\u00e9s is csak egy marketing fog\u00e1s miatt ker\u00fclt be az elnevez\u00e9sbe, sugallva az \u00fajat, mint sem egy egyszer\u0171 f\u0151verzi\u00f3sz\u00e1mot n\u00f6veltek. A .NET 10 megjelen\u00e9s\u00e9vel viszont ism\u00e9t elt\u0171nt a Core sz\u00f3 a megnevez\u00e9sb\u0151l.</p> <p>Az al\u00e1bbi \u00e1br\u00e1n l\u00e1that\u00f3 a Microsoft webes technol\u00f3gi\u00e1j\u00e1nak, az ASP.NET-nek a fejl\u0151d\u00e9se a megjelen\u00e9st\u0151l napjainkig.</p> <p></p>"},{"location":"#az-aspnet-mely-reszeit-fogjuk-hasznalni-a-laborokon","title":"Az ASP.NET mely r\u00e9szeit fogjuk haszn\u00e1lni a laborokon?","text":"<p>A r\u00f6vid v\u00e1lasz, hogy mindegyiket.</p> <ul> <li>ASP.NET Core Identity a felhaszn\u00e1l\u00f3- \u00e9s jogosults\u00e1gkezel\u00e9s megval\u00f3s\u00edt\u00e1s\u00e1hoz.</li> <li> <p>ASP.NET Razor pages</p> <ul> <li>Razor szintaxissal k\u00e9sz\u00edtett szerver oldalon renderelt n\u00e9zetek (Razor Pages).</li> <li>Felhaszn\u00e1l\u00f3i fel\u00fclet, \u0171rlapok \u00e9s m\u00f6g\u00f6ttes k\u00f3d kapcsolata, \u00e9letciklus, adatk\u00f6t\u00e9s, PageModel, PageHandler-ek.</li> <li>\u00dajrahasznos\u00edthat\u00f3 komponensek (View components, Tag helpers) k\u00e9sz\u00edt\u00e9se.</li> <li>Modellvalid\u00e1ci\u00f3 szerver \u00e9s kliens oldalon.</li> </ul> </li> <li> <p>Blazor WebApp (Blazor WASM + ASP.NET Core szerver)</p> <ul> <li>WebAPI k\u00e9sz\u00edt\u00e9se kliens oldali keretrendszerekhez, melyek JSON-ban adj\u00e1k vissza az adatokat a kliensnek.</li> <li>Szerver oldali API-b\u00f3l kliens k\u00f3d gener\u00e1l\u00e1sa (Nswag)</li> <li>\u00c9letciklus, adatk\u00f6t\u00e9s, felhaszn\u00e1l\u00f3 fel\u00fcletek k\u00e9sz\u00edt\u00e9se</li> <li>Modellvalid\u00e1ci\u00f3 szerver \u00e9s kliens oldalon. (FluentValidation)</li> <li>Radzen komponens k\u00f6nyvt\u00e1r</li> </ul> </li> </ul> <p>Ezen fel\u00fcl ahhoz, hogy teljes \u00e9rt\u00e9k\u0171 alkalmaz\u00e1st tudjunk k\u00e9sz\u00edteni a laborokon - nem pedig egyszer\u0171, k\u00fcl\u00f6n\u00e1ll\u00f3 p\u00e9ld\u00e1kat -, az al\u00e1bbi technol\u00f3gi\u00e1kat haszn\u00e1ljuk fel:</p> <ul> <li>HTML, CSS, JavaScript, jQuery (Mobil \u00e9s webes szoftvereken elsaj\u00e1t\u00edthat\u00f3)</li> <li>SQL \u00e9s Entity Framework Core az adatel\u00e9r\u00e9si r\u00e9teghez</li> </ul>"},{"location":"#elotanulmanyi-rend","title":"El\u0151tanulm\u00e1nyi rend","text":"<p>A t\u00e1rgy felv\u00e9tel\u00e9hez k\u00f6telez\u0151 el\u0151tanulm\u00e1nyi rend nincsen. A t\u00e1rgy a C# nyelv \u00e9s a HTML, CSS \u00e9s JavaScript nyelv alapjainak ismeret\u00e9re \u00e9p\u00edt, \u00edgy felv\u00e9tele csak azon hallgat\u00f3k sz\u00e1m\u00e1ra aj\u00e1nlott, akik ezekkel a technol\u00f3gi\u00e1kkal tiszt\u00e1ban vannak (a Mobil- \u00e9s webes szoftverek c\u00edm\u0171 t\u00e1rgyon elhangzottak ismerete elegend\u0151 a HTML, CSS \u00e9s JavaScript nyelvekb\u0151l). Ezen nyelvek ismerete sz\u00fcks\u00e9ges a t\u00e1rgy teljes\u00edt\u00e9s\u00e9hez, viszont a t\u00e1rgy ezekkel bevezet\u0151 szinten sem foglalkozik, hiszen k\u00f6telez\u0151 t\u00e1rgyak form\u00e1j\u00e1ban elsaj\u00e1t\u00edthat\u00f3k.</p>"},{"location":"#onallo-laboron-is-aspnet-core-ral-szeretnek-foglalkozni-felvehetem-e-ezt-a-targyat-is-melle","title":"\u00d6n\u00e1ll\u00f3 laboron is ASP.NET Core-ral szeretn\u00e9k foglalkozni. Felvehetem-e ezt a t\u00e1rgyat is mell\u00e9?","text":"<p>Az \u00f6n\u00e1ll\u00f3 labor \u00e9s a v\u00e1laszthat\u00f3 t\u00e1rgyak nem tudj\u00e1k egym\u00e1st kiz\u00e1rni. Ez\u00e9rt egy optim\u00e1lis v\u00e1laszt\u00e1s lehet, hogy a webport\u00e1lok t\u00e1rgy mell\u00e9 egy ASP.NET Core / Blazor alap\u00fa \u00f6n\u00e1ll\u00f3 labor t\u00e9m\u00e1t v\u00e1lasztasz. Ebben az esetben megfelel\u0151en komplex alkalmaz\u00e1s k\u00e9sz\u00edt\u00e9se eset\u00e9n ugyanaz az alkalmaz\u00e1s beadhat\u00f3 mindk\u00e9t t\u00e1rgyhoz, csak meg kell jel\u00f6lni, hogy mely r\u00e9szek melyik t\u00e1rgyhoz k\u00e9sz\u00fcltek.</p>"},{"location":"homework/01%20-%20Specifikacio/","title":"Specifik\u00e1ci\u00f3 k\u00e9sz\u00edt\u00e9se","text":""},{"location":"homework/01%20-%20Specifikacio/#specifikacio-keszitese","title":"Specifik\u00e1ci\u00f3 k\u00e9sz\u00edt\u00e9se","text":"<p>A hallgat\u00f3nak a v\u00e1lasztott h\u00e1zi feladat \u00edr\u00e1sos specifik\u00e1ci\u00f3j\u00e1t a 10. tan\u00edt\u00e1si h\u00e9t v\u00e9g\u00e9ig a Moodle-\u00f6n kereszt\u00fcl le kell adni.</p> <p>A specifik\u00e1ci\u00f3 elk\u00e9sz\u00edt\u00e9s\u00e9hez a  Moodle-ben tal\u00e1lhat\u00f3 dokumentum sablont kell haszn\u00e1lni (kb. 1-2 A4-es oldal).</p>"},{"location":"homework/01%20-%20Specifikacio/#specifikacio-feltoltese","title":"Specifik\u00e1ci\u00f3 felt\u00f6lt\u00e9se","text":"<p>H\u00e1zi feladat specifik\u00e1ci\u00f3 felt\u00f6lt\u00e9se</p> <ul> <li>K\u00e9sz\u00edtse el a h\u00e1zi feladat specifik\u00e1ci\u00f3j\u00e1t (maximum 2 oldal)</li> <li>Tervezze meg a legfontosabb oldalakat Balsamiq vagy Figma seg\u00edts\u00e9g\u00e9vel. (maximum 3 k\u00e9perny\u0151)</li> <li>Az elk\u00e9sz\u00edtett tervet a t\u00e1rgy Moodle oldal\u00e1n kell a H\u00e1zi feladat specifik\u00e1ci\u00f3 felt\u00f6lt\u00e9s r\u00e9szhez felt\u00f6lteni PDF form\u00e1tumban a n\u00e9v \u00e9s neptun k\u00f3d felt\u00fcntet\u00e9s\u00e9vel.</li> <li>A hat\u00e1rid\u0151 a 10. oktat\u00e1si h\u00e9t v\u00e9ge (Moodle-ben tal\u00e1lhat\u00f3), de a hat\u00e1rid\u0151 el\u0151tt is fel lehet t\u00f6lteni!</li> </ul>"},{"location":"homework/01%20-%20Specifikacio/#utolagos-specifikacio-feltoltese-potlas","title":"Ut\u00f3lagos specifik\u00e1ci\u00f3 felt\u00f6lt\u00e9se (P\u00f3tl\u00e1s)","text":"<p>Ut\u00f3lagos h\u00e1zi feladat specifik\u00e1ci\u00f3 felt\u00f6lt\u00e9se (P\u00f3tl\u00e1s)</p> <ul> <li>A specifik\u00e1ci\u00f3 felt\u00f6lt\u00e9se a A hat\u00e1rid\u0151 a 10. oktat\u00e1si h\u00e9t v\u00e9ge (Moodle-ben tal\u00e1lhat\u00f3), de a hat\u00e1rid\u0151 el\u0151tt is fel lehet t\u00f6lteni!</li> <li>Az elk\u00e9sz\u00edtett tervet a t\u00e1rgy Moodle oldal\u00e1n kell a Ut\u00f3lagos h\u00e1zi feladat specifik\u00e1ci\u00f3 felt\u00f6lt\u00e9s r\u00e9szhez felt\u00f6lteni PDF form\u00e1tumban a n\u00e9v \u00e9s neptun k\u00f3d felt\u00fcntet\u00e9s\u00e9vel.</li> </ul>"},{"location":"homework/02%20-%20Nagy%20hazi%20feladat/","title":"Nagy h\u00e1zi feladat k\u00e9sz\u00edt\u00e9se","text":""},{"location":"homework/02%20-%20Nagy%20hazi%20feladat/#nagy-hazi-feladat-keszitese","title":"Nagy h\u00e1zi feladat k\u00e9sz\u00edt\u00e9se","text":"<p>A hallgat\u00f3k a f\u00e9l\u00e9v sor\u00e1n k\u00e9sz\u00edtett specifik\u00e1ci\u00f3 alapj\u00e1n elk\u00e9sz\u00edti a nagy h\u00e1zi feladatukat. El lehet t\u00e9rni a specifik\u00e1ci\u00f3t\u00f3l, nincs semmi sem k\u0151be v\u00e9sve, viszont \u00e9rt\u00e9kelni csak az elk\u00e9sz\u00edtett munk\u00e1t tudjuk.</p>"},{"location":"homework/02%20-%20Nagy%20hazi%20feladat/#hazi-feladat-bemutatas-vedes","title":"H\u00e1zi feladat bemutat\u00e1s (v\u00e9d\u00e9s)","text":"<p>Az elk\u00e9sz\u00edtett h\u00e1zi feladatot az el\u0151re meghirdetett id\u0151pontokban be kell mutatni a gyakorlatvezet\u0151nek. Mivel a t\u00e1rgy teljesen online form\u00e1ban megy, \u00edgy ak\u00e1r t\u00f6mb\u00f6s\u00edtve is elv\u00e9gezhet\u0151.</p> <p>Tervezett id\u0151pontok:</p> <ul> <li>Tavaszi sz\u00fcnet ut\u00e1ni h\u00e9ten.</li> <li>Utols\u00f3 oktat\u00e1si h\u00e9ten.</li> <li>P\u00f3tlead\u00e1s a p\u00f3tl\u00e1si h\u00e9ten.</li> </ul>"},{"location":"homework/02%20-%20Nagy%20hazi%20feladat/#bemutatas-folyamata","title":"Bemutat\u00e1s folyamata","text":"<ul> <li>Az el\u0151re meghirdetett id\u0151pontban a hallgat\u00f3 bekapcsol\u00f3dik a ki\u00edrd Teams meetingbe. Adott id\u0151pontra jelentkezett \u00f6sszes hallgat\u00f3 jelen van a v\u00e9d\u00e9seken.</li> <li>A hallgat\u00f3 aki soron k\u00f6vetkez\u0151ik megosztja a k\u00e9perny\u0151j\u00e9t</li> <li>5 percben bemutatja az alkalmaz\u00e1st m\u0171k\u00f6d\u00e9s k\u00f6zben, a fontosabb funkci\u00f3kra koncentr\u00e1lva.</li> <li>10-15 percben k\u00e9rd\u00e9sekre kell v\u00e1laszolni a k\u00f3ddal kapcsolatban, mit hogyan oldott meg. Itt sz\u00fcks\u00e9ges, hogy a forr\u00e1sk\u00f3dot is l\u00e1ssuk.</li> </ul> <p>K\u00f6zvetlen\u00fcl a sikeres v\u00e9d\u00e9s ut\u00e1n, az elfogadott h\u00e1zi feladat forr\u00e1sk\u00f3dj\u00e1t a specifik\u00e1ci\u00f3hoz hasonl\u00f3an Moodle-be kell felt\u00f6lteni a megfelel\u0151 sz\u00e1monk\u00e9r\u00e9shez, ez a jegy be\u00edr\u00e1s\u00e1nak felt\u00e9tele.</p> <p>A megfelel\u0151 min\u0151s\u00e9g\u0171 \u00e9s komplexit\u00e1s\u00fa NHF-tal kiv\u00e1lthat\u00f3 a sz\u00f3beli vizsga. A Neptunban ilyenkor is fel kell venni az els\u0151 vizsga id\u0151pontot, hogy be lehessen \u00edrni a jegyet.</p>"},{"location":"homework/02%20-%20Nagy%20hazi%20feladat/#nhf-feltoltese","title":"NHF felt\u00f6lt\u00e9se","text":"<p>H\u00e1zi feladat forr\u00e1sk\u00f3d felt\u00f6lt\u00e9se</p> <ul> <li>A forr\u00e1sk\u00f3dot a t\u00e1rgy Moodle oldal\u00e1n kell a H\u00e1zi feladat felt\u00f6lt\u00e9s r\u00e9szhez felt\u00f6lteni ZIP form\u00e1tumban.</li> <li>A hat\u00e1rid\u0151 a sikeres v\u00e9d\u00e9s ut\u00e1n azonnal.</li> </ul>"},{"location":"homework/02%20-%20Nagy%20hazi%20feladat/#utolagos-nhf-feltoltese-potlas","title":"Ut\u00f3lagos NHF felt\u00f6lt\u00e9se (P\u00f3tl\u00e1s)","text":"<p>Ut\u00f3lagos h\u00e1zi feladat forr\u00e1sk\u00f3d felt\u00f6lt\u00e9se (P\u00f3tl\u00e1s)</p> <ul> <li>A p\u00f3tl\u00e1si h\u00e9ten is van meghirdetett bemutat\u00e1si id\u0151pont, az ott bemutatott h\u00e1zi feladatok forr\u00e1sk\u00f3dj\u00e1t is fel kell t\u00f6lteni.</li> <li>A forr\u00e1sk\u00f3dot a t\u00e1rgy Moodle oldal\u00e1n kell a Ut\u00f3lagos H\u00e1zi feladat felt\u00f6lt\u00e9s (P\u00f3tl\u00e1s) r\u00e9szhez felt\u00f6lteni ZIP form\u00e1tumban.</li> </ul>"},{"location":"information/contributing/","title":"Hozz\u00e1j\u00e1rul\u00e1s az anyaghoz","text":""},{"location":"information/contributing/#hozzajarulas-az-anyaghoz","title":"Hozz\u00e1j\u00e1rul\u00e1s az anyaghoz","text":"<p>Az anyag terjedelm\u00e9b\u0151l adand\u00f3an apr\u00f3bb hib\u00e1k esetenk\u00e9nt hi\u00e1nyoss\u00e1gok jelentkezhetnek a laborokban. Ha egy ilyennel tal\u00e1lkozol \u00e9s \u00fagy d\u00f6ntesz szeretn\u00e9l seg\u00edteni hallgat\u00f3t\u00e1rsaidnak, azt a k\u00f6vetkez\u0151kben le\u00edrtak alapj\u00e1n tudod megtenni.</p> <p>Plusz pont jegyzet jav\u00edt\u00e1s\u00e9rt</p> <p>M\u00e1s tant\u00e1rgyak mint\u00e1j\u00e1ra itt is szeretn\u00e9nk plusz pontot adni a jegyzet open-source hozz\u00e1j\u00e1rul\u00e1sai\u00e9rt. Akik a t\u00e1rgyat jelenleg hallgatj\u00e1k, pontokat kaphatnak hozz\u00e1j\u00e1rul\u00e1saik\u00e9rrt.</p> <p>A f\u00e9l\u00e9v sor\u00e1n max 3 db plusz pontot lehet szerezni fejenk\u00e9nt olyan jav\u00edt\u00e1sok\u00e9rt, amik a trivi\u00e1lis 1-2 bet\u0171 elg\u00e9pel\u00e9sen t\u00fal \u00e9rdemben jav\u00edtanak a githubon tal\u00e1lhat\u00f3 labor jegyzetek min\u0151s\u00e9g\u00e9n. Pl.: jelent\u0151s mennyis\u00e9g\u0171 elg\u00e9pel\u00e9s jav\u00edt\u00e1sa, egy\u00e9rtelm\u0171s\u00edt\u00e9sek, illusztr\u00e1ci\u00f3k kieg\u00e9sz\u00edt\u00e9sek k\u00e9sz\u00edt\u00e9se vagy ak\u00e1r egy teljes kieg\u00e9sz\u00edt\u0151 jegyzet \u00edr\u00e1sa  (term\u00e9szetesen nem azonos pont\u00e9rt\u00e9kkel).</p> <p>Persze a pont n\u00e9lk\u00fcl az 1-1 bet\u0171s elg\u00e9pel\u00e9seket is sz\u00edvesen fogadjuk, ami bemeleg\u00edt\u00e9snek is t\u00f6k\u00e9letes.</p>"},{"location":"information/contributing/#hibak-jelzese","title":"Hib\u00e1k jelz\u00e9se","text":"<p>Amennyiben hib\u00e1t tal\u00e1lsz az anyagban, vagy szeretn\u00e9d b\u0151v\u00edteni, de nem \u00e1ll m\u00f3dodban jav\u00edtani, nyithatsz egy issue-t amiben le\u00edrod a hib\u00e1t.</p> <ol> <li>N\u00e9zd meg, hogy valaki nem jelezte-e, amit szeretn\u00e9l.     Gyakran m\u00e1r l\u00e9tez\u0151 probl\u00e9m\u00e1kat tal\u00e1lnak, amire m\u00e1r van pull request,     \u00edgy miel\u0151tt b\u00e1rmit tenn\u00e9l n\u00e9zd meg valaki nem el\u0151z\u00f6tt-e meg</li> <li>Az issues tabon a new issue gombbal hozz l\u00e9tre egy \u00faj issue-t.     </li> <li>L\u00e1sd el a megfelel\u0151 c\u00edmk\u00e9kkel<ol> <li>A hiba t\u00edpusa (<code>clarification</code>, <code>typo</code>, <code>illustration</code> vagy <code>notes</code>)</li> </ol> </li> <li>\u00cdrd le, hogy mit k\u00e9ne tartalmaznia a jav\u00edt\u00e1snak</li> </ol> <p>Tip</p> <p>Az c\u00edme legyen r\u00f6vid \u00e9s l\u00e9nyegret\u00f6r\u0151, pl.: <code>Megfogalmaz\u00e1s pontos\u00edt\u00e1sa a 4. laborban</code> vagy <code>A 6. laborban a le\u00edrt k\u00f3d hib\u00e1san m\u0171k\u00f6dik Android 12-n</code></p> <p>A issue descriptionj\u00e9ben pedig fejtsd ki, hol tal\u00e1lhat\u00f3 a hi\u00e1nyoss\u00e1g, illetve ha van r\u00e1 \u00f6tleted, hogy lehetne orvosolni ezt. Ha ezeken t\u00fal m\u00e9g screenshotot is tudsz mell\u00e9kelni, az nagyban megseg\u00edti a probl\u00e9ma mihamarabbi jav\u00edt\u00e1s\u00e1t.</p> <p>Warning</p> <p>A github issues nem a laborfeladatok megold\u00e1s\u00e1val kapcsolatos probl\u00e9m\u00e1k helye, \u00edgy a \"Nem tudom megoldani hogy az \u00e9rtes\u00edt\u00e9s meg\u00e9rkezzen\" jelleg\u0171 probl\u00e9m\u00e1kat ne itt jelezz\u00e9tek, erre vannak a laboralkalmak.</p>"},{"location":"information/contributing/#valtoztatasok-javaslasa","title":"V\u00e1ltoztat\u00e1sok javasl\u00e1sa","text":"<p>Amennyiben a hozz\u00e1j\u00e1rul\u00e1sod meg tudod val\u00f3s\u00edtani ind\u00edts pull requestet</p> <ol> <li> <p>Forkold a repository-t a Githubon jobb fels\u0151 sarokban tal\u00e1lhat\u00f3 gombbal     </p> </li> <li> <p>V\u00e9gezd el a v\u00e1ltoztat\u00e1sokat.</p> <ol> <li> <p>Hozz l\u00e9tre egy branchet a saj\u00e1t forkodon, amin a v\u00e1ltoztat\u00e1sokat el fogod v\u00e9gezni.</p> </li> <li> <p>Ezen a branchen k\u00e9sz\u00edtsd el a jav\u00edt\u00e1sokat</p> </li> <li> <p>Ellen\u0151rizd, hogy ne ker\u00fclj\u00f6n bele a commitba olyan file, amit az editor gener\u00e1lt (pl.: <code>.idea</code> mappa) illetve olyan file aminek nem k\u00e9ne kiker\u00fclnie, pl.: Github Private Access Token</p> </li> <li> <p>Ha k\u00e9sz vagy ind\u00edts egy pull requestet a jegyzeteket tartalmaz\u00f3 rep\u00f3 f\u0151 \u00e1g\u00e1ra.</p> </li> <li> <p>A le\u00edr\u00e1sban r\u00e9szletezd v\u00e1ltoztat\u00e1sok ok\u00e1t.     Ne felejtsd el bele\u00edrni a NEPTUN k\u00f3dod a le\u00edr\u00e1sba, mert \u00edgy fogjuk tudni megadni a pontokat.</p> </li> </ol> </li> <li> <p>Valaki, akinek hozz\u00e1f\u00e9r\u00e9se van a repositoryhoz, ellen\u0151rzi a v\u00e1ltoztat\u00e1sok sz\u00fcks\u00e9gess\u00e9g\u00e9t, \u00e9s elb\u00edr\u00e1lja, hogy val\u00f3ban beker\u00fclhet az anyagba.</p> </li> <li>A v\u00e1ltoztat\u00e1sokra review-t ind\u00edtunk \u00e9s ha kell m\u00f3dos\u00edt\u00e1sokat fogunk k\u00e9rni.</li> <li>Ha minden k\u00e9rt v\u00e1ltoztat\u00e1s megt\u00f6rt\u00e9nt, a hozz\u00e1j\u00e1rul\u00e1sod beleker\u00fcl az anyagba.</li> </ol>"},{"location":"information/contributing/#code-style","title":"Code style","text":"<ul> <li>Markdown: Mivel az alap spec nem mindig a legtiszt\u00e1bban \u00e9rthet\u0151, a markdownlint szab\u00e1lyai alapj\u00e1n, az n\u00e9h\u00e1ny kiv\u00e9tel\u00e9vel. Ezeket a <code>.markdownlint.yaml</code>-ben tal\u00e1lod, ha VSCode-ot haszn\u00e1lsz automatikusan alkalmazza \u0151ket az editor \u00e9s jelzi ha nem megfelel\u0151 amit \u00edrsz.</li> </ul> <p>Ezek a st\u00edlusok a t\u00e1rgyban aj\u00e1nlott editorokban k\u00f6nnyen be\u00e1ll\u00edthat\u00f3ak.</p>"},{"location":"information/contributing/#vscode","title":"VSCode","text":"<p>Aj\u00e1nlott extension\u00f6k:</p> <ul> <li><code>yzhang.markdown-all-in-one</code>: MD szinkroniz\u00e1lt live preview</li> <li><code>DavidAnson.vscode-markdownlint</code>: MD form\u00e1z\u00e1s, szab\u00e1lyok stb.</li> <li>Prettier: HTML+CSS form\u00e1z\u00f3</li> <li>Error Lens: Kiemeli a hib\u00e1kat hogy gyorsabben megtal\u00e1ljuk \u0151ket</li> <li>Paste Image: egyszer\u0171s\u00edti a k\u00e9pek beilleszt\u00e9s\u00e9t markdownba</li> </ul> <p>Az editor be\u00e1ll\u00edt\u00e1s\u00e1hoz nyisd meg a repo-t a gy\u00f6ker\u00e9ben VSCode-al. A VSCode fel fogja aj\u00e1nlani a k\u00e9t markdown extension-t.</p> <p></p> <p>Ha ez megt\u00f6rt\u00e9nt, nyiss meg egy markdown dokumentumot, \u00e9s haszn\u00e1ld a Ctrl+Shift+P shortcutot, a command palette megnyit\u00e1s\u00e1hoz.</p> <p>Tip</p> <p>A command palette a VSCode parancsaihoz ny\u00fajt hozz\u00e1f\u00e9r\u00e9st, autocompleteeli a parancsokat \u00e9s egy minim\u00e1lis GUI-t is biztos\u00edt.</p> <p>A command palette-be keress\u00fck meg a <code>Format Document With...</code> men\u00fcpontot \u00e9s v\u00e1lasszuk ki. Ekkor egy almen\u00fcbe dob az editor \u00e9s kiv\u00e1laszthatjuk hogy melyik form\u00e1z\u00f3val form\u00e1zzuk a MD dokumentumokat. Legalul lesz egy <code>Configure Default Formatter</code>, v\u00e1lasszuk ezt. Ezut\u00e1n v\u00e1lasszuk a <code>markdownlint</code> extensiont, \u00e9s k\u00e9szen vagyunk.</p> <p>Megfelel\u0151 formatter kiv\u00e1laszt\u00e1sa</p> <p>Ne v\u00e1laszd ki a prettiert formatterk\u00e9nt, mert elt\u00f6ri a sz\u00f6vegbubor\u00e9kokat.</p> <p>Ezen fel\u00fcl \u00e9rdemes lehet bekapcsolni a ment\u00e9s el\u0151tti form\u00e1z\u00e1st.</p> <p>A Ctrl+, shortcuttal megnyitjuk a be\u00e1ll\u00edt\u00e1sokat, \u00e9s r\u00e1keres\u00fcnk arra, hogy format on save. Itt kipip\u00e1ljuk a checkboxot \u00e9s k\u00e9szen vagyunk.</p> <p>Ha ehhez nem lenne t\u00fcrelmed, itt a json amit a <code>settings.json</code>-ba illesztve be\u00e1ll\u00edt\u00f3dik minden.</p> <pre><code>{\n  \"[markdown]\": {\n    \"editor.defaultFormatter\": \"DavidAnson.vscode-markdownlint\",\n    \"editor.formatOnSave\": true\n  }\n}\n</code></pre>"},{"location":"information/course/","title":"T\u00e1rgy inform\u00e1ci\u00f3k","text":""},{"location":"information/course/#targy-informaciok","title":"T\u00e1rgy inform\u00e1ci\u00f3k","text":""},{"location":"information/course/#eloado-es-fontos-linkek","title":"El\u0151ad\u00f3 \u00e9s fontos linkek","text":"<p>A t\u00e1rgy el\u0151ad\u00f3ja: Gincsai G\u00e1bor</p> <ul> <li>Moodle: Webport\u00e1lok fejleszt\u00e9se - BMEVIAUJV83 2025/26/2</li> <li>Tansz\u00e9ki port\u00e1l: Webport\u00e1lok fejleszt\u00e9se (VIAUJV83)</li> <li>TAD: Webport\u00e1lok fejleszt\u00e9se</li> <li>Els\u0151dleges kommunik\u00e1ci\u00f3s csatorna a t\u00e1rgy Teams csoportja.</li> </ul>"},{"location":"information/course/#eloadasok-laborok","title":"El\u0151ad\u00e1sok, laborok","text":"<p>A Webport\u00e1lok fejleszt\u00e9se c. t\u00e1rgy online form\u00e1ban ker\u00fcl lebonyol\u00edt\u00e1sra, \u00edgy nincs \u00f3rarendi id\u0151pont \u00e9s mindenki a saj\u00e1t temp\u00f3j\u00e1ban haladhat. Ennek az a nagy el\u0151nye, hogy az el\u0151ad\u00e1s \u00e9s labor anyagokat t\u00f6mb\u00f6s\u00edtve ak\u00e1r a f\u00e9l\u00e9v els\u0151 p\u00e1r het\u00e9ben le lehet tudni \u00e9s a h\u00e1zi feladatot, amivel ak\u00e1r megaj\u00e1nlott jegyet is lehet kapni, ak\u00e1r a tavaszi sz\u00fcnet ut\u00e1n be lehet mutatni \u00e9s megszerezni az \u00e9rdemjegyet!</p>"},{"location":"information/course/#targykovetelmenyek","title":"T\u00e1rgyk\u00f6vetelm\u00e9nyek","text":"<p>K\u00e9t k\u00f6vetelm\u00e9ny van a t\u00e1rgyon, ami sz\u00fcks\u00e9ges az al\u00e1\u00edr\u00e1shoz.</p> <ul> <li>Specifik\u00e1ci\u00f3 k\u00e9sz\u00edt\u00e9se: R\u00e9szletek a H\u00e1zi feladatok - Specifik\u00e1ci\u00f3 k\u00e9sz\u00edt\u00e9se.</li> <li>Nagy h\u00e1zi feladat: R\u00e9szletek a H\u00e1zi feladatok - Nagy h\u00e1zi feladat k\u00e9sz\u00edt\u00e9se.</li> </ul> <p>A specifik\u00e1ci\u00f3 \u00e9s a h\u00e1zi feladat bead\u00e1sa az al\u00e1\u00edr\u00e1s megszerz\u00e9s\u00e9nek \u00e9s egyben a vizsg\u00e1ra bocs\u00e1jt\u00e1snak sz\u00fcks\u00e9ges felt\u00e9tele. A jegy be\u00edr\u00e1s\u00e1nak felt\u00e9tele, hogy az elfogadott h\u00e1zi feladat k\u00f3dja a Moodle-be fel legyen t\u00f6ltve.</p> <p>A t\u00e1rgy sz\u00f3beli vizsg\u00e1val z\u00e1rul, azonban a sz\u00f3beli vizsga kiv\u00e1lthat\u00f3 egy emelt szint\u0171 h\u00e1zi feladat elk\u00e9sz\u00edt\u00e9s\u00e9vel.</p> <p>A vizsgaid\u0151szakban legal\u00e1bb 3 id\u0151pont ker\u00fcl meghirdet\u00e9sre. A vizsga anyag\u00e1t az el\u0151ad\u00e1son \u00e9s a gyakorlatokon elhangzottak k\u00e9pezik, azonban kiemelked\u0151en j\u00f3 h\u00e1zi feladat hat\u00e1rid\u0151re t\u00f6rt\u00e9n\u0151 lead\u00e1sa eset\u00e9n megaj\u00e1nlott jegy lehets\u00e9ges.</p>"},{"location":"information/course/#megajanlott-jegy","title":"Megaj\u00e1nlott jegy","text":"<p>Teljesk\u00f6r\u0171en m\u0171k\u00f6d\u0151 \u00e9s ig\u00e9nyesen elk\u00e9sz\u00edtett h\u00e1zi feladatra megaj\u00e1nlott jegy kaphat\u00f3. A megaj\u00e1nlott jegy csak j\u00f3 (4) vagy jeles (5) oszt\u00e1lyzat lehet, amit a nagy h\u00e1zi feladat alapj\u00e1n \u00e1llap\u00edtunk meg.</p> <p>A specifik\u00e1ci\u00f3 lead\u00e1sa ut\u00e1n a hallgat\u00f3k visszajelz\u00e9st kapnak, hogy a h\u00e1zi feladatuk es\u00e9lyes-e a megaj\u00e1nlott jegyre. Ilyenkor m\u00e9g van lehet\u0151s\u00e9g b\u0151v\u00edteni a funkci\u00f3kat, hogy megaj\u00e1nlott jegyet szerezhessenek.</p> <p>Fontos: aki megaj\u00e1nlott jegyet szerzett, az is jelentkezzen a Neptun-on vizsg\u00e1ra, hogy a jegyet be tudjuk \u00edrni.</p>"},{"location":"information/github/","title":"Feladatok bead\u00e1sa (GitHub)","text":""},{"location":"information/github/#feladatok-beadasa-github","title":"Feladatok bead\u00e1sa (GitHub)","text":"<p>A feladatok bead\u00e1s\u00e1hoz a GitHub platformot haszn\u00e1ljuk. Az ASP.NET Core Razor Pages-es laborok, illetve a Balzor-\u00f6s laborok bead\u00e1sa egy-egy GitHub repository-ban t\u00f6rt\u00e9nik, melyet a feladatle\u00edr\u00e1sban tal\u00e1lhat\u00f3 linken kereszt\u00fcl kapsz meg. A labor feladatainak megold\u00e1s\u00e1t ezen repository-ban kell elk\u00e9sz\u00edtened, \u00e9s ide kell felt\u00f6ltened. A k\u00e9sz megold\u00e1s bead\u00e1sa a repository-ba val\u00f3 felt\u00f6lt\u00e9s ut\u00e1n egy un. pull request form\u00e1j\u00e1ban t\u00f6rt\u00e9nik, amelyet a laborvezet\u0151dh\u00f6z rendelsz.</p> <p>FONTOS</p> <p>Az itt le\u00edrt formai el\u0151\u00edr\u00e1sok betart\u00e1sa elv\u00e1r\u00e1s. A nem ilyen form\u00e1ban beadott megold\u00e1sokat nem \u00e9rt\u00e9kelj\u00fck.</p>"},{"location":"information/github/#roviditett-verzio","title":"R\u00f6vid\u00edtett verzi\u00f3","text":"<p>Al\u00e1bb r\u00e9szletesen bemutatjuk a bead\u00e1s menet\u00e9t. Itt egy r\u00f6vid \u00f6sszefoglal\u00f3 az \u00e1ttekint\u00e9shez, illetve a helyes bead\u00e1s ellen\u0151rz\u00e9s\u00e9hez.</p> <ol> <li> <p>A munk\u00e1dat Moodle-ben tal\u00e1lhat\u00f3 GitHub Classroom megh\u00edv\u00f3 linken kereszt\u00fcl l\u00e9trehozott GitHub repository-ban kell elk\u00e9sz\u00edtsd.</p> </li> <li> <p>A megold\u00e1shoz k\u00e9sz\u00edts egy k\u00fcl\u00f6n \u00e1gat, ne a main-en dolgozz. Erre az \u00e1gra ak\u00e1rh\u00e1ny kommitot tehetsz. Mindenk\u00e9ppen pushold a megold\u00e1st.</p> </li> <li> <p>A bead\u00e1st egy pull request jelzi, amely pull request-et a laborvezet\u0151dh\u00f6z kell rendelned.</p> </li> <li> <p>Ha az eredm\u00e9nnyel vagy \u00e9rt\u00e9kel\u00e9ssel kapcsolatban k\u00e9rd\u00e9sed van, pull request kommentben k\u00e9rdezhetsz. A laborvezet\u0151 \u00e9rtes\u00edt\u00e9s\u00e9hez haszn\u00e1ld a <code>@n\u00e9v</code> c\u00edmz\u00e9st a komment sz\u00f6veg\u00e9ben.</p> </li> </ol>"},{"location":"information/github/#a-munka-elkezdese-git-checkout","title":"A munka elkezd\u00e9se: git checkout","text":"<ol> <li> <p>Regisztr\u00e1lj egy GitHub accountot, ha m\u00e9g nincs.</p> </li> <li> <p>Moodle-ben a kurzus oldal\u00e1n keresd meg a laborhoz tartoz\u00f3 megh\u00edv\u00f3 URL-t. Ez az ASP.NET Razor Pages-es \u00e9s Blazor-\u00f6s laborok eset\u00e9n m\u00e1s lesz. Mindk\u00e9t t\u00e9mak\u00f6rh\u00f6z egy-egy kiinudl\u00f3 repozitory van, \u00fcgyelj r\u00e1, hogy a megfelel\u0151 linket haszn\u00e1ld.</p> </li> <li> <p>Ha k\u00e9ri, adj enged\u00e9lyt a GitHub Classroom alkalmaz\u00e1snak, hogy haszn\u00e1lja az account adataidat.</p> <p></p> <p>Enged\u00e9ly k\u00e9r\u00e9se</p> </li> <li> <p>L\u00e1tni fogsz egy oldalt, ahol elfogadhatod a feladatot (\"Accept the ... assignment\"). Kattints a gombra.</p> <p></p> <p>Feladat elfogad\u00e1sa</p> </li> <li> <p>V\u00e1rd meg, am\u00edg elk\u00e9sz\u00fcl a repository. A repository linkj\u00e9t itt kapod meg.</p> <p>Megjegyz\u00e9s</p> <p>A repository priv\u00e1t lesz, azaz az senki nem l\u00e1tja, csak te, \u00e9s az oktat\u00f3k.</p> <p></p> <p>Repository l\u00e9trehoz\u00e1sa</p> </li> <li> <p>Nyisd meg a repository-t a webes fel\u00fcleten a linkre kattintva. Ezt az URL-t \u00edrd fel, vagy mentsd el.</p> <p></p> <p>Repozitory link kim\u00e1solsa</p> </li> <li> <p>Kl\u00f3nozd le a repository-t. Ehhez sz\u00fcks\u00e9ges lesz a repository c\u00edm\u00e9re, amit a repository webes fel\u00fclet\u00e9n a Clone or download alatt tal\u00e1lsz.</p> <ul> <li>A git repository kezel\u00e9s\u00e9hez tetsz\u0151leges klienst haszn\u00e1lhatsz. Mi most a Visual Studio-t fogjuk haszn\u00e1lni.</li> <li>A Visual Studio elind\u00edt\u00e1sa ut\u00e1n v\u00e1laszd a Close a repository linket jobb oldalon, majd adjuk meg a repository linkj\u00e9t (amit kim\u00e1soltunk a v\u00e1g\u00f3lapra) \u00e9s a k\u00f6nyvt\u00e1rat, ahova kl\u00f3nozni szeretn\u00e9nk.</li> <li>Ha nem tudn\u00e1nk a linket, akkor lent ki is tudjuk tall\u00f3zni a repository-t.</li> </ul> <p></p> <p>Repository kl\u00f3noz\u00e1sa Visual Studio-ban.</p> <ul> <li> <p>Ha konzolt haszn\u00e1ln\u00e1l, az al\u00e1bbi parancs kl\u00f3nozza a repository-t (ha a <code>git</code> parancs el\u00e9rhet\u0151):</p> Git clone<pre><code>git clone &lt;repository link&gt;\n</code></pre> </li> </ul> <p>Sikertelen kl\u00f3noz\u00e1s</p> <p>Amennyiben a bejelentkez\u00e9s sikertelen felhaszn\u00e1l\u00f3n\u00e9v/jelsz\u00f3 p\u00e1rossal a \"Clone with HTTPS\" eset\u00e9n, (r\u00e9gebb \u00f3ta haszn\u00e1lt felhaszn\u00e1l\u00f3n\u00e1l) \u00e9rdemes ellen\u0151rizni a git-en tal\u00e1lhat\u00f3 Personal Access token lej\u00e1rati d\u00e1tum\u00e1t.</p> <p><code>Jobb fels\u0151 sarokban a profilk\u00e9p melletti lefel\u00e9 mutat\u00f3 nyil &gt; Settings &gt; bal oldalon (legals\u00f3) Developer settings &gt; ugyanitt Personal access tokens.</code></p> <p>Alternat\u00edv m\u00f3dszerk\u00e9nt: HTTP kl\u00f3noz\u00e1s helyett, SSH kulcs haszn\u00e1lat\u00e1hoz, angol nyelv\u0171 instrukci\u00f3k itt tal\u00e1lhat\u00f3ak.</p> </li> <li> <p>Ha siker\u00fclt a kl\u00f3noz\u00e1s, M\u00c9G NE KEZDJ EL DOLGOZNI! A megold\u00e1st ne a repository <code>main</code> \u00e1g\u00e1n k\u00e9sz\u00edtsd el. Hozz l\u00e9tre egy \u00faj \u00e1gat (branch) <code>megoldas</code> n\u00e9ven.</p> <p></p> <p>\u00daj brench l\u00e9trehoz\u00e1sa Visual Studio-ban.</p> <ul> <li> <p>Ha konzolt haszn\u00e1lsz, az \u00faj \u00e1g elk\u00e9sz\u00edthet\u0151 ezzel a paranccsal:</p> git checkout<pre><code>git checkout -b megoldas\n</code></pre> </li> </ul> </li> <li> <p>Ezen a <code>megoldas</code> \u00e1gon dolgozva k\u00e9sz\u00edtsd el a beadand\u00f3kat. Ak\u00e1rh\u00e1nyszor kommitolhatsz \u00e9s pusholhatsz. A megold\u00e1s r\u00e9sze a forr\u00e1sk\u00f3d \u00e9s a feladatokban elv\u00e1rt k\u00e9perny\u0151k\u00e9pek. Ha a feladat k\u00e9perny\u0151k\u00e9pet v\u00e1r el, akkor azt a repository gy\u00f6ker\u00e9be commitold az elv\u00e1rt n\u00e9ven.</p> </li> <li> <p>Mindig ellen\u0151rizd, hogy j\u00f3 \u00e1gon vagy-e. Miel\u0151tt commit-olod / push-olod a munk\u00e1d.</p> <ul> <li>Commit</li> </ul> Git Commit <p></p> <p>Git Commit Visual Studio-b\u00f3l</p> <ul> <li>Push</li> </ul> Git push <p></p> <p>Git Push Visual Studio-b\u00f3l</p> <ul> <li> <p>Ha konzolt haszn\u00e1lsz, akkor az al\u00e1bbi parancsokat haszn\u00e1ld (felt\u00e9ve, hogy a j\u00f3 \u00e1gon vagy):</p> Git commit and push<pre><code># Ellen\u0151rizd az \u00e1gat, \u00e9s hogy milyen f\u00e1jlok m\u00f3dosultak\ngit status\n\n# Minden v\u00e1ltoztat\u00e1st el\u0151k\u00e9sz\u00edt kommitol\u00e1sra\ngit add .\n\n# Kommit\ngit commit -m \"f1\"\n\n# Push els\u0151 alkalommal az \u00faj \u00e1g publik\u00e1l\u00e1s\u00e1hoz\ngit push --set-upstream origin megoldas\n\n# Push a tov\u00e1bbiakban, amikor az \u00e1g m\u00e1r nem \u00faj\ngit push\n</code></pre> </li> </ul> </li> </ol>"},{"location":"information/github/#a-megoldas-beadasa","title":"A megold\u00e1s bead\u00e1sa","text":"<ol> <li> <p>Ha v\u00e9gezt\u00e9l a megold\u00e1ssal, ellen\u0151rizd a GitHub webes fel\u00fclet\u00e9n, hogy mindent felt\u00f6lt\u00f6tt\u00e9l-e. Ehhez a webes fel\u00fcleten v\u00e1ltanod kell az \u00e1gak k\u00f6z\u00f6tt.</p> <p></p> <p>Branch v\u00e1lt\u00e1s GitHub weboldal\u00e1n</p> <p>Felt\u00f6lt\u00e9s a webes fel\u00fcleten</p> <p>Azt javasoljuk, hogy ne haszn\u00e1ld a GitHub f\u00e1jl felt\u00f6lt\u00e9s funkci\u00f3j\u00e1t. Ha valami hi\u00e1nyzik, a helyi git repository-ban p\u00f3told, \u00e9s kommitold majd pushold.</p> </li> <li> <p>Ha t\u00e9nyleg k\u00e9sz vagy, akkor nyiss egy pull request-et.</p> <p>Minek a pull request?</p> <p>Ez a pull request fogja \u00f6ssze a megold\u00e1sodat, \u00e9s annak \"v\u00e9geredm\u00e9ny\u00e9t\" mutatja. \u00cdgy a laborvezet\u0151nek nem az egyes kommitjaidat vagy f\u00e1jljaidat kell n\u00e9znie, hanem csak a relev\u00e1ns, v\u00e1ltozott r\u00e9szeket l\u00e1tja egyben. A pull request jelenti a feladatod bead\u00e1s\u00e1t is, \u00edgy ez a l\u00e9p\u00e9s nem hagyhat\u00f3 ki.</p> <p>A pull request nyit\u00e1s\u00e1hoz a GitHub webes fel\u00fclet\u00e9re kell menj. Itt, ha nem r\u00e9g pusholt\u00e1l, a GitHub fel is aj\u00e1nlja a pull request l\u00e9trehoz\u00e1s\u00e1t, amit az el\u0151z\u0151 k\u00e9pen is l\u00e1thatsz (s\u00e1rga cs\u00edk), vagy a fens\u0151 Pull requests men\u00fcb\u0151l is l\u00e9trehozhatsz.</p> <p>Fontos, hogy a megfelel\u0151 brancheket v\u00e1laszd ki: <code>master</code>-be megy a <code>megoldas</code> \u00e1g.</p> <p></p> <p>Pull request k\u00e9sz\u00edt\u00e9se</p> <p>Ha minden rendben siker\u00fclt, a men\u00fcben fent l\u00e1tod a kis \"1\" sz\u00e1mot a Pull request elem mellett, jelezve, hogy van egy nyitott pull request. DE M\u00c9G NEM V\u00c9GEZT\u00c9L!</p> <p></p> <p>Nyitott pull requestek</p> </li> <li> <p>V\u00c9GEZET\u00dcL, ha k\u00e9sz vagy, a pull request-et rendeld a laborvezet\u0151dh\u00f6z. Ez a l\u00e9p\u00e9s felt\u00e9tlen\u00fcl fontos, ez jelzi a bead\u00e1st.</p> <p></p> <p>Laborvezet\u0151h\u00f6z rendel\u00e9s</p> <p>Pull request n\u00e9lk\u00fcl</p> <p>Ha nincs pull request-ed, vagy nincs a laborvezet\u0151h\u00f6z rendelve, akkor \u00fagy tekintj\u00fck, hogy m\u00e9g nem vagy k\u00e9szen, \u00e9s nem adtad be a megold\u00e1st.</p> <p>V\u00e9gezt\u00e9l</p> <p>Miut\u00e1n a laborvezet\u0151h\u00f6z rendelted a pull request-et, m\u00e1r ne m\u00f3dos\u00edts semmin. A laborvezet\u0151 \u00e9rt\u00e9kelni fogja a munk\u00e1dat, \u00e9s a pull request lez\u00e1r\u00e1s\u00e1val kommentben jelzi a v\u00e9geredm\u00e9nyt.</p> </li> </ol>"},{"location":"information/github/#kapott-eredmennyel-kapcsolatban-kerdes-vagy-reklamacio","title":"Kapott eredm\u00e9nnyel kapcsolatban k\u00e9rd\u00e9s vagy reklam\u00e1ci\u00f3","text":"<p>Ha a feladatok \u00e9rt\u00e9kel\u00e9s\u00e9vel vagy az eredm\u00e9nnyel kapcsolatban k\u00e9rd\u00e9st tenn\u00e9l fel, vagy reklam\u00e1ln\u00e1l, haszn\u00e1ld a Pull Request kommentel\u00e9si lehet\u0151s\u00e9g\u00e9t erre. Annak \u00e9rdek\u00e9ben, hogy a laborvezet\u0151 biztosan \u00e9rtes\u00fclj\u00f6n a k\u00e9rd\u00e9sr\u0151l haszn\u00e1ld a <code>@n\u00e9v</code> mention funkci\u00f3t a laborvezet\u0151d megnevez\u00e9s\u00e9hez. Err\u0151l automatikusan kapni fog egy email \u00e9rtes\u00edt\u00e9st.</p> <p></p> <p>Reklam\u00e1ci\u00f3 csak indokl\u00e1ssal</p> <p>Ha nem \u00e9rtesz egyet az \u00e9rt\u00e9kel\u00e9ssel, a bizony\u00edt\u00e1s t\u00e9ged terhel, azaz al\u00e1 kell t\u00e1masztanod a reklam\u00e1ci\u00f3d (pl. annak le\u00edr\u00e1s\u00e1val, hogyan tesztelted a megold\u00e1sod, \u00e9s mi bizony\u00edtja a helyess\u00e9g\u00e9t).</p>"},{"location":"information/requirements/","title":"H\u00e1zi feladat k\u00f6vetelm\u00e9nyek","text":""},{"location":"information/requirements/#hazi-feladat-kovetelmenyek","title":"H\u00e1zi feladat k\u00f6vetelm\u00e9nyek","text":""},{"location":"information/requirements/#minimum-kovetelmenyek","title":"Minimum k\u00f6vetelm\u00e9nyek","text":"<p>Csak azok az alkalmaz\u00e1sok fogadhat\u00f3ak el, melyek a k\u00f6vetkez\u0151 k\u00f6vetelm\u00e9nyek mindegyik\u00e9t teljes\u00edtik:</p> <ul> <li>Helyesen m\u0171k\u00f6dik (nincs kiv\u00e9tel, s\u00e1rga hal\u00e1l, nem lehet hib\u00e1s vagy rosszindulat\u00fa adatok bevitel\u00e9vel kiakasztani).</li> <li>SQL injection \u00e9s cross-site scripting ellen v\u00e9dett.</li> <li>Entity Framework Core haszn\u00e1lata, legal\u00e1bb 4 adatb\u00e1zis t\u00e1bl\u00e1val.</li> <li>CSS vagy SCSS haszn\u00e1lata (ig\u00e9nyes kin\u00e9zet).</li> <li>Jogosult\u00e1g kezel\u00e9s nem egyedi megold\u00e1ssal, hanem a be\u00e9p\u00edtett m\u00f3don (ASP.NET Identity) \u00e9s legyen minimum egy anonymous \u00e9s egy bel\u00e9pett felhaszn\u00e1l\u00f3, vagy k\u00fcls\u0151 identity provider (pl. Facebook, Google, Microsoft Identity) haszn\u00e1lat\u00e1val.</li> <li>T\u00f6bbr\u00e9teg\u0171 architekt\u00fara haszn\u00e1lata. K\u00fcl\u00f6n projektekben (nem k\u00f6nyv\u00e1rakban).</li> <li>M\u00f3dos\u00edthat\u00f3, nem bedr\u00f3tozott be\u00e1ll\u00edt\u00e1sok (pl. connection string appsettings.json-ban), ha lehet Options minta haszn\u00e1lata.</li> <li>ASP.NET Razor Pages vagy Blazor WASM-ban k\u00e9sz\u00fclt alkalmaz\u00e1s.</li> </ul>"},{"location":"information/requirements/#megajanlott-jegyhez-elonyt-jelentenek","title":"Megaj\u00e1nlott jegyhez el\u0151nyt jelentenek","text":"<p>A k\u00f6vetkez\u0151 funkci\u00f3k megval\u00f3s\u00edt\u00e1sa seg\u00edt a megaj\u00e1nlott jegy megszerz\u00e9s\u00e9ben, de m\u00e9g t\u00f6bb implement\u00e1l\u00e1sa sem garant\u00e1lja azt:</p> <ul> <li>Feliratkoz\u00e1s / \u00e9rtes\u00edt\u00e9s k\u00fcld\u00e9se</li> <li>\u00d6sszetett keres\u00e9s / sz\u0171r\u00e9s</li> <li>Health monitoring, napl\u00f3z\u00e1s (\u00e1ltal\u00e1nos hiba, vagy esem\u00e9ny log)</li> <li>T\u00f6bbnyelv\u0171 felhaszn\u00e1l\u00f3i fel\u00fclet (dinamikusan, nem a k\u00f3d t\u00f6bbsz\u00f6r\u00f6z\u00e9s\u00e9vel, elegend\u0151 3 oldalra elk\u00e9sz\u00edteni)</li> <li> <p>Blazor WASM haszn\u00e1lata</p> <ul> <li>Kliens oldali API gener\u00e1l\u00e1sa (pl: nswag)</li> <li>Komponens library haszn\u00e1lata (pl: Radzen)</li> </ul> </li> </ul> <p>Az itt le\u00edrtakon fel\u00fcl term\u00e9szetesen m\u00e1s is figyelembe vehet\u0151, ha az val\u00f3ba extra funkcionalit\u00e1st ad az alkalmaz\u00e1shoz.</p>"},{"location":"information/terms%20of%20use/","title":"Felhaszn\u00e1l\u00e1si felt\u00e9telek","text":""},{"location":"information/terms%20of%20use/#felhasznalasi-feltetelek","title":"Felhaszn\u00e1l\u00e1si felt\u00e9telek","text":"<p>Jegyzetek, gyakorlati anyagok \u00e9s h\u00e1zi feladatok a Webport\u00e1lok fejleszt\u00e9se c. t\u00e1rgyhoz.</p> <p>Felhaszn\u00e1l\u00e1si felt\u00e9telek</p> <p>Az itt tal\u00e1lhat\u00f3 oktat\u00e1si seg\u00e9danyagok a BMEVIAUJV83 t\u00e1rgy hallgat\u00f3inak k\u00e9sz\u00fcltek. Az anyagok oly m\u00f3d\u00fa felhaszn\u00e1l\u00e1sa, amely a t\u00e1rgy oktat\u00e1s\u00e1hoz nem szorosan kapcsol\u00f3dik, csak a szerz\u0151(k) \u00e9s a forr\u00e1s megjel\u00f6l\u00e9s\u00e9vel t\u00f6rt\u00e9nhet.</p> <p>Az anyagok a t\u00e1rgy keret\u00e9ben oktatott kontextusban \u00e9rtelmezhet\u0151ek. Az anyagok\u00e9rt egy\u00e9b felhaszn\u00e1l\u00e1s eset\u00e9n a szerz\u0151(k) felel\u0151ss\u00e9get nem v\u00e1llalnak.</p>"},{"location":"seminar/0%20-%20Adatbazis%20alapok/","title":"0. MS-SQL adatb\u00e1zis \u00e9s EF (opcion\u00e1lis)","text":""},{"location":"seminar/0%20-%20Adatbazis%20alapok/#0-ms-sql-adatbazis-es-ef-opcionalis","title":"0. MS-SQL adatb\u00e1zis \u00e9s EF (opcion\u00e1lis)","text":""},{"location":"seminar/0%20-%20Adatbazis%20alapok/#bevezetes","title":"Bevezet\u00e9s","text":"<p>A labor c\u00e9lja, az MS SQL Server ismeretek \u00e1tism\u00e9tl\u00e9se, illetve azon hallgat\u00f3knak akik m\u00e9g nem foglalkoztak adatb\u00e1zisokkal a gyakorlatban megmutassuk, hogyan lehet t\u00e1bl\u00e1kat l\u00e9trehozni, lek\u00e9rdez\u00e9seket \u00e9s t\u00e1rolt elj\u00e1r\u00e1sokat k\u00e9sz\u00edteni. A labor sor\u00e1n a hallgat\u00f3k egy-egy p\u00e9ld\u00e1n kereszt\u00fcl ismerkednek meg a T\u00e1blal\u00e9trehoz\u00e1st, adatb\u00e1zis lek\u00e9rdez\u00e9sek \u00e9s m\u00f3dos\u00edt\u00e1sok k\u00e9sz\u00edt\u00e9s\u00e9t, valamint a t\u00e1rolt elj\u00e1r\u00e1sok \u00edr\u00e1s\u00e1t.</p> <p>Mivel ez egy opcion\u00e1lis anyag, csak azok sz\u00e1m\u00e1ra akiknek \u00faj az Entity Framework \u00e9s adatb\u00e1zis kezel\u00e9s, ez\u00e9rt kor\u00e1bbi .NET verzi\u00f3kkal k\u00e9sz\u00fclt, de a l\u00e9nyegi r\u00e9sze m\u00e9g mindig ugyan\u00fagy m\u0171k\u00f6dik!</p> <ul> <li>0. Adatbazis alapok (opcionalis).pdf</li> <li>0. labor - TesztData.zip</li> </ul>"},{"location":"seminar/1%20-%20Tervezes/","title":"1. Tervez\u00e9s","text":""},{"location":"seminar/1%20-%20Tervezes/#1-tervezes","title":"1. Tervez\u00e9s","text":""},{"location":"seminar/1%20-%20Tervezes/#specifikacio","title":"Specifik\u00e1ci\u00f3","text":"<p>Az al\u00e1bbiakban az alkalmaz\u00e1s lefontosabb funkci\u00f3it szedj\u00fck \u00f6ssze, hogy a k\u00e9s\u0151bbiekben ez alapj\u00e1n tudjuk a felhaszn\u00e1l\u00f3i fel\u00fcletet megtervezni. A f\u00e9l\u00e9v sor\u00e1n ezen funkci\u00f3k egy r\u00e9sz\u00e9t fogjuk megval\u00f3s\u00edtani.</p> <ul> <li> <p>K\u00f6nyvek b\u00f6ng\u00e9sz\u00e9se A k\u00f6nyveket kateg\u00f3ri\u00e1kba kell tudni szervezni (t\u00f6bb szint\u0171). Egy kateg\u00f3ri\u00e1t kiv\u00e1lasztva megjelennek a kateg\u00f3ri\u00e1ban l\u00e9v\u0151 k\u00f6nyvek a legfontosabb inform\u00e1ci\u00f3kkal (c\u00edm, szerz\u0151, \u00e1r, bor\u00edt\u00f3k\u00e9p) egy lapozhat\u00f3 list\u00e1ban. Az alkalmaz\u00e1s kezd\u0151 oldala is egy ilyen list\u00e1t tartalmaz, azonban az a kateg\u00f3ri\u00e1kban kiemelt / \u00fajdons\u00e1gokat mutatja. Ha itt egy k\u00f6nyvre kattintunk, akkor bej\u00f6n a k\u00f6nyv r\u00e9szletes oldala, amiben minden adat megtal\u00e1lhat\u00f3 a k\u00f6nyvr\u0151l, illetve a hozz\u00e1 tartoz\u00f3 aj\u00e1nl\u00f3k \u00e9s kommentek is.</p> </li> <li> <p>K\u00f6nyvek keres\u00e9se A felhaszn\u00e1l\u00f3k t\u00f6bb esetben konkr\u00e9t k\u00f6nyvet keresnek, aminek ismerik a c\u00edm\u00e9t vagy annak egy r\u00e9sz\u00e9t. Ehhez sz\u00fcks\u00e9ges egy keres\u0151 megval\u00f3s\u00edt\u00e1sa, ami felaj\u00e1nlja g\u00e9pel\u00e9s k\u00f6zben a tal\u00e1latokat, \u00e9s ha egy konkr\u00e9t k\u00f6nyvre kattintunk, elvisz annak a r\u00e9szletes oldal\u00e1ra. Ha pedig t\u00f6bb tal\u00e1lat lenne, akkor egy r\u00e9szletes keres\u00e9st ind\u00edt, ahol a list\u00e1zzuk a tal\u00e1latokat egy k\u00fcl\u00f6n oldalon.</p> </li> <li> <p>Kos\u00e1r \u00e9s megrendel\u00e9s A felhaszn\u00e1l\u00f3k a megvenni k\u00edv\u00e1nt k\u00f6nyveket egy kos\u00e1rba gy\u0171jthetnek, majd a k\u00e9s\u0151bbiekben ezt feladhatj\u00e1k, mint egy rendel\u00e9st. A kor\u00e1bbi rendel\u00e9sek list\u00e1j\u00e1t k\u00e9s\u0151bb visszan\u00e9zhetik \u00e9s nyomon k\u00f6vethetik azok \u00e1llapot\u00e1t.</p> </li> <li> <p>Felhaszn\u00e1l\u00f3 kezel\u00e9s Sz\u00fcks\u00e9ges, hogy a felhaszn\u00e1l\u00f3k tudjanak regisztr\u00e1lni \u00e9s bel\u00e9pni. A bel\u00e9p\u00e9st ak\u00e1r k\u00fcls\u0151 autentik\u00e1ci\u00f3s szolg\u00e1ltat\u00e1ssal is lehessen megval\u00f3s\u00edtani (pl: Google, Facebook accounttal) Ezen fel\u00fcl sz\u00fcks\u00e9ges megk\u00fcl\u00f6nb\u00f6ztetni az admin felhaszn\u00e1l\u00f3kat, akik szerkeszthetik a k\u00f6nyvek \u00e9s a kateg\u00f3ri\u00e1k adatait, illetve moder\u00e1lhatj\u00e1k a k\u00f6z\u00f6ss\u00e9g \u00e1ltal k\u00e9sz\u00edtett tartalmakat.</p> </li> <li> <p>Profil adatok kezel\u00e9se Lehet\u0151s\u00e9get kell adni a jelsz\u00f3v\u00e1ltoztat\u00e1sra, illetve a felhaszn\u00e1l\u00f3nak a sz\u00e1ll\u00edt\u00e1si \u00e9s sz\u00e1ml\u00e1z\u00e1si adatait el kell t\u00e1rolni.</p> </li> <li> <p>Aj\u00e1nl\u00f3k l\u00e9trehoz\u00e1sa adott k\u00f6nyvh\u00f6z A felhaszn\u00e1l\u00f3k egy-egy k\u00f6nyvh\u00f6z aj\u00e1nl\u00f3kat hozhatnak l\u00e9tre, melyek a k\u00f6nyv r\u00e9szletes oldal\u00e1n megjelennek egy list\u00e1ban. Az aj\u00e1nl\u00f3k rendelkeznek r\u00e9szletes oldallal is, \u00e9s egy k\u00fcl\u00f6n oldalon el\u00e9rhet\u0151k a leg\u00fajabb id\u00e9zetek is.</p> </li> <li> <p>Kommentek f\u0171z\u00e9se a k\u00f6nyvekhez A felhaszn\u00e1l\u00f3k egy-egy k\u00f6nyvh\u00f6z egyszer\u0171 kommentet is lehet f\u0171zni, ami megjelenik a k\u00f6nyv r\u00e9szletes oldalon.</p> </li> </ul>"},{"location":"seminar/1%20-%20Tervezes/#ui-terv-keszitese","title":"UI terv k\u00e9sz\u00edt\u00e9se","text":"<p>A UI tervek, vagy Wireframe-ek tervez\u00e9s\u00e9nek a l\u00e9nyege, hogy a specifik\u00e1ci\u00f3 alapj\u00e1n a lehet\u0151 legkor\u00e1bban tudjunk k\u00e9sz\u00edteni egy, a megrendel\u0151 sz\u00e1m\u00e1ra megmutathat\u00f3 grafikus tervet. A l\u00e9nyeg nem a design-on van, hanem a megjelen\u0151 adatokon \u00e9s azok elrendez\u00e9s\u00e9n. Teh\u00e1t a tervezett fel\u00fcleteken pontosan meg kell jelen\u00edteni minden adatot, nem el\u00e9g az, hogy ide j\u00f6nnek a k\u00f6nyv adatai, hanem t\u00e9telesen meg kell tervezni, hogy mi jelenik meg (C\u00edm, szerz\u0151, r\u00f6vid le\u00edr\u00e1s, \u00e1r, kedvezm\u00e9nyes \u00e1r...)</p> <p>A tervez\u00e9s legfontosabb r\u00e9sze, hogy azt tervezz\u00fck meg, amit a megrendel\u0151 szeretne. Ehhez \u00e9rdemes a fejleszt\u00e9s legelej\u00e9n  megtervezni a legfontosabb wireframe-eket, \u00e9s azt egyeztetni a megrendel\u0151vel, mert amikor m\u00e1r l\u00e1tja a megrendel\u0151, hogyan fog kin\u00e9zni az alkalmaz\u00e1s azonnal esz\u00e9be jut m\u00e9g sz\u00e1mos nem specifik\u00e1lt, vagy alul specifik\u00e1lt funkci\u00f3.</p> <p>Ezen fel\u00fcl fejleszt\u0151i oldalr\u00f3l n\u00e9zve is fontos a UI terv, hiszen azon minden adat megjelenik, teh\u00e1t ez alapj\u00e1n el lehet kezdeni megtervezni az adatb\u00e1zist. Beazonos\u00edtani az entit\u00e1sokat \u00e9s azok tulajdons\u00e1gait.</p> <p>A korai UI tervez\u00e9ssel sz\u00e1mos iter\u00e1ci\u00f3t meg tudunk sp\u00f3rolni a fejleszt\u00e9s sor\u00e1n, hiszen m\u00e1r van egy egyeztetett terv, hogyan fog kin\u00e9zni az alkalmaz\u00e1s \u00e9s milyen adatokat jelen\u00edt meg. \u00cdgy kevesebb \u00faj mez\u0151k kell felvenni az adatb\u00e1zisba a megval\u00f3s\u00edt\u00e1s sor\u00e1n, amit egy\u00e9bk\u00e9nt v\u00e9gig is kell vezetni a DTO-n, \u00fczleti logik\u00e1n \u00e9s a fel\u00fcleten is.</p> <p>Balsamiq-ban k\u00e9sz\u00edtett BookShop UI terv</p> <p>Balsamiq UI terv let\u00f6lt\u00e9se</p>"},{"location":"seminar/1%20-%20Tervezes/#balsamiq","title":"Balsamiq","text":"<p>Egy kiv\u00e1l\u00f3 eszk\u00f6z UI tervek k\u00e9sz\u00edt\u00e9s\u00e9re a Balsamiq, melynek webes verzi\u00f3ja regisztr\u00e1ci\u00f3 ut\u00e1n 14 napig ingyenesen haszn\u00e1lhat\u00f3.</p> <p></p> <p>Balsamiq felhaszn\u00e1l\u00f3i fel\u00fclete</p> <p>A haszn\u00e1lata egyszer\u0171 \u00e9s gyors, a v\u00e9geredm\u00e9ny pedig PDF-be export\u00e1lhat\u00f3.</p>"},{"location":"seminar/1%20-%20Tervezes/#figma","title":"Figma","text":"<p>Egy m\u00e1sik kiv\u00e1l\u00f3 eszk\u00f6z  a UI tervek k\u00e9sz\u00edt\u00e9s\u00e9re a Figma. L\u00e9tezik ingyenes verzi\u00f3 a szem\u00e9lyes projektekhez, r\u00e1ad\u00e1sul itt nincs id\u0151korl\u00e1toz\u00e1s az ingyenes verzi\u00f3hoz, de ez is regisztr\u00e1ci\u00f3hoz k\u00f6t\u00f6tt. Az \u00e1raz\u00e1s r\u00e9szletei itt \u00e9rhet\u0151 el. Ezen fel\u00fcl van kifejezetten hallgat\u00f3k sz\u00e1m\u00e1ra is egy ingyenes verzi\u00f3, a Figma for education</p>"},{"location":"seminar/1%20-%20Tervezes/#site-template-hasznalata","title":"Site template haszn\u00e1lata","text":"<ol> <li> <p>Hozzunk l\u00e9tre egy \u00faj WebSite alap\u00fa template-t. Ehhez a kezd\u0151 oldal tetej\u00e9n l\u00e9v\u0151 men\u00fcb\u0151l v\u00e1lasszuk ki a Site opci\u00f3t, vagy ha m\u00e1r van megnyitva projekt\u00fcnk akkor a + jelre kattintva a felugr\u00f3 ablakban v\u00e1lasszuk a Site opci\u00f3t.</p> Seg\u00edts\u00e9g - Hol keressem a Site gombot <p></p> <p>Figma men\u00fck</p> <p></p> <p>\u00daj Site t\u00edpus\u00fa Figma terv l\u00e9trehoz\u00e1sa</p> </li> <li> <p>M\u00e1r ekkor is v\u00e1laszthatunk egy template-et, de ezt most hagyjuk ki csak z\u00e1rjuk be a felugr\u00f3 ablakot.</p> <p></p> <p>Site sablon v\u00e1laszt\u00e1sa</p> </li> <li> <p>Ezt k\u00f6vet\u0151en egy \u00fcres oldal fogad minket. Bal oldalon v\u00e1lasszuk a CMS opci\u00f3t, majd a Job Listings p\u00e9ld\u00e1t.</p> <p></p> <p>Job listings template</p> </li> <li> <p>A megjelen\u0151 oldalon l\u00e1thatjuk a teszt adatokat, amivel kit\u00f6lti a template-et.</p> </li> <li> <p>V\u00e1lasszuk ki bal oldalon a File men\u00fcpontot, hogy l\u00e1ssuk az elk\u00e9sz\u00edtett oldalakat.</p> <p></p> <p>L\u00e9trehozott template</p> </li> <li> <p>A fenti sablon j\u00f3 minta lehet, hogy hogyan k\u00e9sz\u00edthet\u00fcnk egy j\u00f3 wireframe-et. Term\u00e9szetesen nem elv\u00e1r\u00e1s, hogy t\u00f6k\u00e9letesen mint apr\u00f3 r\u00e9szletre kiterjed\u0151 wireframe-ek k\u00e9sz\u00fcljenek, de a f\u0151 oldalakat \u00e9rdemes megrajzolni.</p> </li> </ol>"},{"location":"seminar/1%20-%20Tervezes/#egyszeru-design","title":"Egyszer\u0171 design","text":"<p>Ha csak egyszer\u0171bb rajzokat szeretn\u00e9nk k\u00e9sz\u00edteni, ami sok esetben elegend\u0151, akkor a Design opci\u00f3t v\u00e1lasztva gyorsabban el lehet k\u00e9sz\u00edteni a wireframe-eket. Az al\u00e1bbi k\u00e9perny\u0151k\u00e9pen a TDK port\u00e1lhoz k\u00e9sz\u00edtett design l\u00e1that\u00f3.</p> <p></p> <p>TDK port\u00e1l Figma design-ja</p> <p>Fontos, hogy ha \"csak\" design-t k\u00e9sz\u00edt\u00fcnk a komponenseket akkor is haszn\u00e1ljuk, \u00edgy az egyes oldalakat sokkal egyszer\u0171bb nagyobb \u00e9p\u00edt\u0151elemekb\u0151l \u00f6sszerakni.</p>"},{"location":"seminar/1%20-%20Tervezes/#adatbazis-tervezes","title":"Adatb\u00e1zis tervez\u00e9s","text":"<p>Ha elk\u00e9sz\u00fcltek a UI tervek, minden adattal \u00e9s egyeztett\u00fck a megrendel\u0151vel m\u00e1r adatb\u00e1zist is lehet tervezni.</p> <p>Az adatb\u00e1zis tervez\u00e9st el\u0151sz\u00f6r \u00e9rdemes diagrammal ak\u00e1r pap\u00edron elkezdeni (ceruz\u00e1val, hogy k\u00f6nny\u0171 legyen jav\u00edtani), \u00e9s amikor m\u00e1r kezd k\u00f6rvonalaz\u00f3dni a terv, akkor nekil\u00e1tni EF Code First megk\u00f6zel\u00edt\u00e9ssel \u00e9s adat modell diagrammal megval\u00f3s\u00edtani a t\u00e9nyleges adatb\u00e1zist.</p>"},{"location":"seminar/1%20-%20Tervezes/#bookshop-db-tervezese","title":"BookShop DB tervez\u00e9se","text":"<p>Az azonos\u00edtott entit\u00e1sok a k\u00f6vetkez\u0151k: Book, Category, Author, Publisher, Comment, Rating, Address, Order, OrderItem \u00e9s a User.</p>"},{"location":"seminar/1%20-%20Tervezes/#a-tervezes-fontosabb-szempontjai","title":"A tervez\u00e9s fontosabb szempontjai","text":"<ul> <li>A User t\u00e1bla ett\u0151l t\u00f6bb adatot fog tartalmazni, de mivel az ASP.NET Identity-t szeretn\u00e9nk haszn\u00e1lni a felhaszn\u00e1l\u00f3 kezel\u00e9shez \u00edgy most azt nem r\u00e9szletezz\u00fck, illetve a jogosults\u00e1g kezel\u00e9shez sz\u00fcks\u00e9ges t\u00e1bl\u00e1kat sem vessz\u00fck fel, mert azt majd az ASP.NET Identity fogja gener\u00e1lni.</li> <li>Egy k\u00f6nyv csak egy kateg\u00f3ri\u00e1ban lehet benne (egy-t\u00f6bbes kapcsolat, \u00edgy nem sz\u00fcks\u00e9ges kapcsol\u00f3 t\u00e1bla), \u00e9s a kateg\u00f3ri\u00e1k hierarchikusan \u00e9p\u00fclnek fel.</li> <li>Az egyes k\u00f6nyveknek t\u00f6bb szerz\u0151je is lehet, ez\u00e9rt az Autor \u00e9s Book t\u00e1bla k\u00f6z\u00f6tt megjelenik a BookAuthor kapcsol\u00f3 t\u00e1bla.</li> <li>A megrendel\u00e9seket az Order t\u00e1bl\u00e1ban t\u00e1roljuk, ami \u00f6sszefogja az OrderItem-eket. Fontos, hogy egy-egy t\u00e9teln\u00e9l el kell t\u00e1rolni a mennyis\u00e9gen fel\u00fcl az \u00e1rat is, hiszen a kor\u00e1bbi megrendel\u00e9seket is meg kell tudni jelen\u00edteni \u00e9s ott fontos, hogy az az \u00e1r jelenjen meg, ami a v\u00e1s\u00e1rl\u00e1skor \u00e9rv\u00e9nyes volt, akkor is ha akkor \u00e9ppen kedvezm\u00e9nyes volt.</li> <li>A felhaszn\u00e1l\u00f3hoz t\u00f6bb c\u00edmet kell tudni elt\u00e1rolni (sz\u00e1ml\u00e1z\u00e1si \u00e9s sz\u00e1ll\u00edt\u00e1si) \u00e9s mindegyik t\u00edpusb\u00f3l lehet ak\u00e1r t\u00f6bb is, teh\u00e1t jel\u00f6lni kell tudni, hogy mi az alap\u00e9rtelmezett.</li> <li>A k\u00f6nyvekhez tartozik \u00e9rt\u00e9kel\u00e9s is. A Rating t\u00e1bl\u00e1ban t\u00e1roljuk el, hogy egy-egy felhaszn\u00e1l\u00f3 az adott k\u00f6nyvet hogyan \u00e9rt\u00e9kelte. Ezt az\u00e9rt kell elt\u00e1rolni, hogy egy felhaszn\u00e1l\u00f3 ne tudjon t\u00f6bbsz\u00f6r \u00e9rt\u00e9kelni. Viszont ahhoz, hogy a megjelen\u00edt\u00e9sn\u00e9l ne kelljen mindig kisz\u00e1molni az aktu\u00e1lis \u00e9rt\u00e9kel\u00e9st egy SumRating \u00e9s RatingCount mez\u0151t felvesz\u00fcnk a Book t\u00e1bl\u00e1ba is. Az\u00e9rt nem az \u00e1tlagot, mert \u00edgy egyszer\u0171en tudjuk m\u00f3dos\u00edtani is egy \u00faj \u00e9rt\u00e9kel\u00e9s eset\u00e9n.</li> <li>A kommenteket \u00e9s aj\u00e1nl\u00f3kat a Comment t\u00e1bl\u00e1ban t\u00e1roljuk el, \u00e9s a Type mez\u0151 hat\u00e1rozza meg, hogy ez egy aj\u00e1nl\u00f3 vagy komment.</li> </ul> <p>Elk\u00e9sz\u00fclt kiindul\u00f3 adatb\u00e1zis terv</p> <p></p> <p>Kiindul\u00f3 adatb\u00e1zis terv</p> <p>Fontos hangs\u00falyozni, hogy ez nem a v\u00e9gleges adatb\u00e1zis terv, ez m\u00e9g m\u00f3dosulhat, de els\u0151 k\u00f6r\u00f6s kiindul\u00e1snak j\u00f3.</p>"},{"location":"seminar/1%20-%20Tervezes/#onallo-feladat","title":"\u00d6n\u00e1ll\u00f3 feladat","text":"<p>\u00d6n\u00e1ll\u00f3 feladat: H\u00e1zi feladat specifik\u00e1l\u00e1sa</p> <ul> <li>K\u00e9sz\u00edtse el a h\u00e1zi feladat specifik\u00e1ci\u00f3j\u00e1t (maximum 2 oldal)</li> <li>Tervezze meg a legfontosabb oldalakat Balsamiq vagy Figma seg\u00edts\u00e9g\u00e9vel. (maximum 3 k\u00e9perny\u0151)</li> <li>Az elk\u00e9sz\u00edtett tervet a t\u00e1rgy Moodle oldal\u00e1n kell a \"H\u00e1zi feladat specifik\u00e1ci\u00f3\" r\u00e9szhez felt\u00f6lteni PDF form\u00e1tumban a n\u00e9v \u00e9s neptun k\u00f3d felt\u00fcntet\u00e9s\u00e9vel.</li> <li>A hat\u00e1rid\u0151 a Moodle-ben tal\u00e1lhat\u00f3, de a hat\u00e1rid\u0151 el\u0151tt is fel lehet t\u00f6lteni!</li> </ul>"},{"location":"seminar/2%20-%20Projekt%20struktura/","title":"2. Project strukt\u00fara \u00e9s adatmodell","text":""},{"location":"seminar/2%20-%20Projekt%20struktura/#2-project-struktura-es-adatmodell","title":"2. Project strukt\u00fara \u00e9s adatmodell","text":""},{"location":"seminar/2%20-%20Projekt%20struktura/#webes-projekt-tipusok-attekintese","title":"Webes projekt t\u00edpusok \u00e1ttekint\u00e9se","text":"<p>Miel\u0151tt l\u00e9trehozzuk a Razor Page projekt\u00fcnket tekints\u00fck \u00e1t, hogy milyen webes projekteket hozhatunk l\u00e9tre.</p> <p>Igen sokf\u00e9le kiindul\u00f3 webes projekt k\u00f6z\u00fcl v\u00e1laszthatunk. T\u00f6bbek k\u00f6z\u00f6tt szerver vagy kliens oldalon renderelt alkalmaz\u00e1st, \u00fcres template-et, vagy csak egy API projektet.</p> <ul> <li>ASP.NET Core Web App (Razor Pages): Szerver oldalon renderelt alkalmaz\u00e1s, ahol a View \u00e9s Controller nem k\u00fcl\u00f6n\u00fcl el, hanem egy Razor f\u00e1jlban szerepel a View \u00e9s el\u0151re meghat\u00e1rozott esem\u00e9nyekre feliratkozva tudunk az interakci\u00f3kra reag\u00e1lni.</li> <li>ASP.NET Core Web App (Model-View-Controller): Szerver oldalon renderelt klasszikus Model-View-Controller architekt\u00fara alap\u00fa kiindul\u00f3 projektet hoz l\u00e9tre.</li> <li>ASP.NET Core Web API: Kiindul\u00f3 projekt RESTful API k\u00e9sz\u00edt\u00e9shez. Itt nincs megjelen\u00edt\u00e9si r\u00e9teg csak a Controller-ek, amit egy k\u00fcl\u00f6n\u00e1ll\u00f3 UI r\u00e9teg amit egy SPA (pl: Blazor, Angular, React kliens) tud h\u00edvni.</li> <li>ASP.NET Core Empty: Teljesen \u00fcres project.</li> <li>Blazor Web App: Kliens oldalon renderelt alkalmaz\u00e1s, ahol a kliens a szerver \u00e1ltal kipublik\u00e1lt REST API (Web API) v\u00e9gpontokat h\u00edvja. Ez az opci\u00f3 l\u00e9tre hozza a kliens oldali WASM \u00e9s a szerver oldali API alkalmaz\u00e1st is.</li> <li>Blazor WebAssembly Standalone App: Ez is egy Blazor web assembly alkalmaz\u00e1st hoz l\u00e9tre, mint a Blazor Web App, viszont ez a szerver oldali projektet nem hozza l\u00e9tre.</li> <li>Blazor Server app: Szerver oldalon renderelt Blazor alkalmaz\u00e1s, ahol a kliens \u00e9s a szerver SignalR-en kereszt\u00fcl kommunik\u00e1l. Az esem\u00e9nyeket a szerver kezeli, a szerver HTML-t renderel \u00e9s a renderelt HTML-t SignalR-en kereszt\u00fcl k\u00fcldi el a kliensnek, hogy az meg tudja jelen\u00edteni.</li> </ul>"},{"location":"seminar/2%20-%20Projekt%20struktura/#architektura","title":"Architekt\u00fara","text":"<p>Az alkalmaz\u00e1sunkban a felel\u0151ss\u00e9gek sz\u00e9tv\u00e1laszt\u00e1sa (separation of concerns) \u00e9rdek\u00e9ben jellemz\u0151en r\u00e9tegezett architekt\u00far\u00e1t haszn\u00e1lunk. Ez azt jelenti, hogy a k\u00f3dot nem egyetlen projektbe szervezz\u00fck, hanem a logikailag k\u00fcl\u00f6n\u00e1ll\u00f3 r\u00e9szeknek \u00f6n\u00e1ll\u00f3 projektet sz\u00e1nunk. A legegyszer\u0171bb megk\u00f6zel\u00edt\u00e9s, ami kis m\u00e9ret\u0171 projektn\u00e9l m\u00e9g m\u0171k\u00f6dik, hogy k\u00e9t r\u00e9teget haszn\u00e1lunk, melyben az adatkezel\u00e9si r\u00e9teg \u00e9s az \u00fczleti logika olyan k\u00f6zel \u00e1llnak egym\u00e1shoz, \u00edgy nem szepar\u00e1ljuk \u0151ket k\u00fcl\u00f6n r\u00e9tegbe. K\u00f6zepes m\u00e9ret\u0171 projektekn\u00e9l, ha klasszikus CRUD m\u0171veleteket v\u00e9gz\u0151 alkalmaz\u00e1sr\u00f3l van sz\u00f3, \u00e9rdemes a BLL (\u00fczleti logika) \u00e9s DAL (adatel\u00e9r\u00e9s) kett\u00e9v\u00e1laszt\u00e1sa, emellett m\u00e9g l\u00e9trehozhatunk k\u00fcl\u00f6nb\u00f6z\u0151 integr\u00e1ci\u00f3kat megval\u00f3s\u00edt\u00f3 r\u00e9tegeket, vagy \u00f6sszef\u00fcgg\u0151 funkci\u00f3halmazok (feature-\u00f6k) alapj\u00e1n f\u00fcgg\u0151leges v\u00e1g\u00e1ssal tov\u00e1bb sz\u00e9p\u00edthetj\u00fck az architekt\u00far\u00e1t. Tov\u00e1bbi projektjeink lehetnek cross-cutting concern-eket megval\u00f3s\u00edt\u00f3, nem r\u00e9teges elrendez\u00e9s\u0171 projektek, mint p\u00e9ld\u00e1ul a napl\u00f3z\u00e1s vagy audit\u00e1l\u00e1s megval\u00f3s\u00edt\u00e1sai, vagy \u00fan. absztrakci\u00f3s projektek, amikben alkalmaz\u00e1sunk publikus interf\u00e9szeit, absztrakt oszt\u00e1lyait, megosztott oszt\u00e1lyait, teh\u00e1t csak az API-j\u00e1t defini\u00e1ljuk. Ha az \u00fczleti logikai r\u00e9teget is lev\u00e1lasztjuk, plusz (legal\u00e1bb) egy transzform\u00e1ci\u00f3s logik\u00e1t illik implement\u00e1lni, ami az entit\u00e1sokat a web sz\u00e1m\u00e1ra em\u00e9szthet\u0151 form\u00e1ba transzform\u00e1lja.</p> <p>Az alkalmaz\u00e1st klasszikus t\u00f6bbr\u00e9teg\u0171 architekt\u00far\u00e1ban val\u00f3s\u00edtjuk meg.</p> <ul> <li>UI: A felhaszn\u00e1l\u00f3i fel\u00fcltet mag\u00e1ba foglal\u00f3 r\u00e9teg. Att\u00f3l f\u00fcgg, hogy milyen technol\u00f3gi\u00e1t v\u00e1lasztunk.  <ul> <li>ASP.NET MVC \u00e9s Razor page eset\u00e9n (szerver oldali renderel\u00e9s) a konkr\u00e9t HTML oldalt jelenti.</li> <li>Blazor eset\u00e9n (kliens oldali renderel\u00e9s) a kliens oldali k\u00f3dot jelenti, de ilyen esetben megjelenik egy Web API r\u00e9teg is, amit HTTP-n kereszt\u00fcl a kliens tud h\u00edvni.</li> </ul> </li> <li>Business Logic (BLL): Az alkalmaz\u00e1s \u00fczleti logikai r\u00e9tegbe. Ez a r\u00e9teg k\u00e9rdezi le EF seg\u00edts\u00e9g\u00e9vel az adatokat az  adatb\u00e1zisb\u00f3l \u00e9s adja vissza a h\u00edv\u00f3 r\u00e9tegnek az adatokat miut\u00e1n DTO-kra konvert\u00e1lta.</li> <li>Data Access (DAL): Az adatb\u00e1zis Entity Framework r\u00e9teg\u00e9t tartalmazza. Itt tal\u00e1lhat\u00f3k az adatb\u00e1zis entit\u00e1sok, a DbContext \u00e9s migr\u00e1ci\u00f3k.</li> <li>Transfer (DTO): DTO-kat tartalmaz\u00f3 projekt, nem k\u00fcl\u00f6n r\u00e9teg.</li> <li>Server.Abstraction: Interf\u00e9szek, amiket k\u00e9s\u0151bb meg kell val\u00f3s\u00edtani, \u00e9s DI-al bet\u00f6lteni. Az egyes projektek az interf\u00e9sz alapj\u00e1n \u00edgy tudj\u00e1k haszn\u00e1lni a konkr\u00e9t implement\u00e1ci\u00f3 ismerete n\u00e9lk\u00fcl is.</li> </ul>"},{"location":"seminar/2%20-%20Projekt%20struktura/#server-oldali-rendereles","title":"Server oldali renderel\u00e9s","text":"<p>ASP.NET MVC vagy Razor Page eset\u00e9n a szerver \u00e1ll\u00edtja el\u0151 a HTML tartalmat, amit a b\u00f6ng\u00e9sz\u0151nek csak meg kell jelen\u00edteni. Ilyen esetben kliens oldalon minim\u00e1lis JavaScript k\u00f3d tal\u00e1lhat\u00f3.</p> <p></p> <p>Szerver oldali renderel\u00e9s architekt\u00far\u00e1ja</p> <p>Mint a fenti \u00e1br\u00e1n is l\u00e1that\u00f3, nincs \u00e9rdemi Frontend k\u00f3d, hiszen a kliens oldalra HTML k\u00f3d ker\u00fcl lek\u00fcld\u00e9sre, amit csak meg kell jelen\u00edteni. A kliens oldali interaci\u00f3khoz nincs speci\u00e1lis t\u00e1mogat\u00e1s, azt csak JavaScript seg\u00edts\u00e9g\u00e9vel tudjuk megval\u00f3s\u00edtani. Esetleg jQuery \u00e9s jQuery UI-t tudunk m\u00e9g erre haszn\u00e1lni.</p>"},{"location":"seminar/2%20-%20Projekt%20struktura/#kliens-oldali-rendereles","title":"Kliens oldali renderel\u00e9s","text":"<p>Blazor Web Assembly eset\u00e9n, a k\u00f3d egy r\u00e9sze (UI r\u00e9teg) a kliensen fut \u00edgy backend oldalon sz\u00fcks\u00e9g van egy Web API r\u00e9tegre, amit a kliens meg tud h\u00edvni az adatok let\u00f6lt\u00e9s\u00e9hez.</p> <ul> <li>Els\u0151 oldal bet\u00f6lt\u00e9skor let\u00f6lt\u0151dik az alkalmaz\u00e1s k\u00f3dja a kliensre</li> <li>Ezt k\u00f6vet\u0151en a kliens aszinkron k\u00e9r\u00e9sekkel t\u00f6lti le a sz\u00fcks\u00e9ges adatokat, amit azt\u00e1n megjelen\u00edt a fel\u00fcleten.</li> </ul> <p></p> <p>Kliens oldali renderel\u00e9s architekt\u00far\u00e1ja</p> <p>Figyelj\u00fck meg, hogy a kliens \u00e9s szerver k\u00f6z\u00f6tt JSON-ban utaznak a DTO (Data Transfer Object) oszt\u00e1lyok. Blazor eset\u00e9n a kliens \u00e9s szerver oldali k\u00f3d is C#-ban k\u00e9sz\u00fcl \u00edgy a DTO-kat mag\u00e1ba foglal\u00f3 Transfer projektre a kliens \u00e9s a szerver is tartalmaz referenci\u00e1t, teh\u00e1t nincs sz\u00fcks\u00e9g a szerver oldali DTO-k gener\u00e1l\u00e1s\u00e1ra kliens oldalon. (React \u00e9s Angular eset\u00e9n ez sz\u00fcks\u00e9ges lenne, hiszen ott a kliens oldali programoz\u00e1si nyelv a JS / TS, \u00edgy a DTO-kat is azon a nyelven kell megval\u00f3s\u00edtani.)</p>"},{"location":"seminar/2%20-%20Projekt%20struktura/#kozos-backend-resz-kialakitasa","title":"K\u00f6z\u00f6s backend r\u00e9sz kialak\u00edt\u00e1sa","text":"<p>Ahogy a fenti architekt\u00fara \u00e1br\u00e1kon is l\u00e1tszik mindk\u00e9t megk\u00f6zel\u00edt\u00e9s eset\u00e9n a Business Logic \u00e9s a Data Access r\u00e9teg lehet k\u00f6z\u00f6s, s\u0151t a DTO-kat tartalmaz\u00f3 Transfer projekt is, de a p\u00e9ld\u00e1ban k\u00fcl\u00f6n projektekben val\u00f3s\u00edtjuk meg ezeket a r\u00e9tegeket.</p> <p>Ha az alkalmaz\u00e1sunk t\u00f6bb projektb\u0151l \u00e1ll, akkor a projekteket egy \u00fan. solution fogja \u00f6ssze, amely egy logikai egys\u00e9get ad a projektek k\u00f6r\u00e9. Alapvet\u0151en a projekt egy egys\u00e9gnyi, egy\u00e9rtelm\u0171 kimenettel rendelkez\u0151 k\u00f3dhalmaz, p\u00e9ld\u00e1ul egy szerelv\u00e9ny (.exe, .dll saj\u00e1t f\u00fcgg\u0151s\u00e9geivel) vagy website (.dll-ek, statikusan kiszolg\u00e1land\u00f3 f\u00e1jlok stb). Az egy solution-ben lev\u0151 projektek teh\u00e1t egy nagyobb probl\u00e9ma megold\u00e1s\u00e1\u00e9rt felel\u0151s nagyobb \u00e9p\u00edt\u0151kock\u00e1k.</p> <ol> <li> <p>Hozzunk l\u00e9tre a <code>BookShop.Dal</code> projektet. Ehhez v\u00e1lasszuk a <code>File \u2192 New \u2192 Projekt / Solution</code> opci\u00f3t, majd a felugr\u00f3 ablakban adjuk meg a sz\u00fcks\u00e9ges adatokat.</p> <ul> <li>Project t\u00edpusa: Class Library</li> <li>Project neve: BookShop.Dal</li> <li>Solution neve: BookShop</li> <li>Framework: .NET 10</li> </ul> Seg\u00edts\u00e9g - K\u00e9perny\u0151k\u00e9pek a projekt l\u00e9trehoz\u00e1sr\u00f3l <p></p> <p>\u00daj projekt l\u00e9trehoz\u00e1sa 1.</p> <p></p> <p>\u00daj projekt l\u00e9trehoz\u00e1sa 2.</p> <p></p> <p>\u00daj projekt l\u00e9trehoz\u00e1sa 3.</p> </li> <li> <p>Ezt k\u00f6vet\u0151en l\u00e9trej\u00f6n a solution \u00e9s benne a projekt is, ahogy azt a Solution Explorer ablakban l\u00e1thatjuk.</p> A l\u00e9trej\u00f6tt solution \u00e9s project <p></p> <p>A l\u00e9trej\u00f6tt solution \u00e9s projekt</p> </li> <li> <p>Adjuk hozz\u00e1 a solution-h\u00f6z a <code>BoohShop.Bll</code> projektet is. Ehhez jobb gombbal kattintsunk a Solution-re, majd v\u00e1lasszuk az <code>Add \u2192 New Project</code> opci\u00f3t, \u00e9s adjuk meg a projekt adatait.</p> Seg\u00edts\u00e9g - K\u00e9perny\u0151k\u00e9pek az \u00faj projekt hozz\u00e1ad\u00e1s\u00e1r\u00f3l <p></p> <p>\u00daj projekt hozz\u00e1ad\u00e1sa</p> <p></p> <p>\u00daj projekt hozz\u00e1ad\u00e1sa 2.</p> </li> <li> <p>A fentihez hasonl\u00f3 m\u00f3don vegy\u00fck fel a <code>BookShop.Transfer</code> projektet is.</p> </li> <li> <p>Adjuk referenci\u00e1t a <code>BookShop.Bll</code> projektb\u0151l a <code>BookShop.Dal</code> \u00e9s <code>BookShop.Transfer</code> projektekre.</p> Seg\u00edts\u00e9g - K\u00e9perny\u0151k\u00e9pek a projekt referencia hozzad\u00e1s\u00e1r\u00f3l <p></p> <p>Projekt refererencia hozz\u00e1ad\u00e1sa</p> <p></p> <p>Projektek kiv\u00e1laszt\u00e1sa \u00e9s hozz\u00e1ad\u00e1s</p> </li> </ol>"},{"location":"seminar/2%20-%20Projekt%20struktura/#data-access-layer","title":"Data Access Layer","text":"<p>A projekt strukt\u00fara elk\u00e9sz\u00edt\u00e9se ut\u00e1n nekifoghatunk a legals\u00f3 r\u00e9teg megval\u00f3s\u00edt\u00e1s\u00e1hoz.</p> <ol> <li>A projekten vagy a projekt alatti Dependencies elemen jobb klikkelve a <code>Manage NuGet Packages...</code> telep\u00edthet\u00fcnk NuGet csomagokat.</li> <li> <p>A Browse tab-on adjuk meg a csomag nev\u00e9t <code>Microsoft.EntityFrameworkCore.SqlServer</code>, v\u00e1lasszuk ki a list\u00e1b\u00f3l, ellen\u0151rizz\u00fck a verzi\u00f3sz\u00e1mot, majd install\u00e1ljuk a projekthez!</p> Seg\u00edts\u00e9g - K\u00e9perny\u0151k\u00e9pek a NuGet package hozzad\u00e1s\u00e1r\u00f3l <p></p> <p>NuGet package hozz\u00e1ad\u00e1sa egy projekthez</p> </li> <li> <p>A telep\u00edt\u00e9s megkezd\u00e9se el\u0151tt meg kell er\u0151s\u00edten\u00fcnk, hogy a sz\u00fcks\u00e9ges m\u00f3dos\u00edt\u00e1sokat v\u00e9grehajthatja \u00e9s el kell fogadni a felhaszn\u00e1l\u00e1si felt\u00e9teleket.</p> </li> <li>T\u00f6r\u00f6lhetj\u00fck a kiindul\u00e1skor l\u00e9trej\u00f6tt <code>Class1.cs</code> f\u00e1jlt.</li> <li> <p>Hozzunk l\u00e9tre egy <code>Entities</code> mapp\u00e1t, benne a <code>Book.cs</code> oszt\u00e1llyal! Ennek tartalma az al\u00e1bbi:</p> Book.cs<pre><code>namespace BookShop.Dal.Entities;\n\npublic class Book\n{\n    public int Id { get; set; }\n    public string Title { get; set; } = null!;\n    public string Author { get; set; } = null!;\n    public string? Subtitle { get; set; }\n    public string? ShortDescription { get; set; }\n    public decimal Price { get; set; }\n    public decimal? DiscountedPrice { get; set; }\n    public int PublishYear { get; set; }\n    public int PageNumber { get; set; }\n}\n</code></pre> </li> <li> <p>Figyelj\u00fck meg a fenti k\u00f3dban az al\u00e1bbiakat</p> <ul> <li>Nincs az oszt\u00e1lyban k\u00fcl\u00f6n using r\u00e9sz, mert csak olyan n\u00e9vtereket haszn\u00e1lunk amik glob\u00e1lisan using-olva vannak.</li> <li>A namespace ut\u00e1n nincs kapcsosz\u00e1r\u00f3jel, hanem <code>;</code> szerepel, \u00edgy cs\u00f6kkentve a k\u00f3dbeh\u00faz\u00e1st.</li> <li>A <code>Title</code> \u00e9s <code>Author</code> mez\u0151k nem lehetnek \u00fcresek, \u00edgy a property v\u00e9g\u00e9n szerepel az <code>= null!</code>    Ha nem szerepelne ott a <code>= null!</code> warning-ot kapn\u00e1nk r\u00e1, mert a projekten alap\u00e9rtelmez\u00e9s szerint enged\u00e9lyezve van a referencia szerinti null-ok kezel\u00e9se.    A projekt f\u00e1jlban a <code>&lt;Nullable&gt;enable&lt;/Nullable&gt;</code> sor enged\u00e9lyezi.    A null-forgiving operator (!) seg\u00edts\u00e9g\u00e9vel be\u00e1ll\u00edtjuk null-ra \u00fagy, hogy ne sz\u00f3ljon \u00e9rte a ford\u00edt\u00f3. Navigation property-k eset\u00e9n ez a javasolt megold\u00e1s.</li> <li>Vagy k\u00e9sz\u00edts\u00fcnk hozz\u00e1 egy konstruktort, ami v\u00e1rja a Title-t \u00e9s be\u00e1ll\u00edtja. Egyszer\u0171 property-k eset\u00e9n ez a javasolt megold\u00e1s. De bizonyos estekben ez neh\u00e9zs\u00e9get okoz, mert nem tudjuk a default konstruktort haszn\u00e1lni, \u00edgy \u00e1ltal\u00e1ban a <code>null!</code>-es megold\u00e1st szoktuk haszn\u00e1lni.</li> </ul> </li> <li> <p>A fentihez hasonl\u00f3an hozzuk l\u00e9tre a <code>Category.cs</code> entit\u00e1st is.</p> Category.cs<pre><code>namespace BookShop.Dal.Entities;\n\npublic class Category\n{\n    public int Id { get; set; }\n    public string Name { get; set; } = null!;\n    public string? Order { get; set; }\n    public int? ParentCategoryId { get; set; }\n\n    // Navigation properties\n    public virtual Category? ParentCategory { get; set; }\n    public virtual ICollection&lt;Book&gt; Books { get; set; } = [];\n    public virtual ICollection&lt;Category&gt; ChildCategories { get; set; } = [];\n}\n</code></pre> </li> <li> <p>Vegy\u00fcnk fel a projekt gy\u00f6ker\u00e9be egy <code>BookShopDbContext.cs</code> f\u00e1jlt a lentebbi tartalommal!</p> BookShopDbContext.cs<pre><code>using BookShop.Dal.Entities;\nusing Microsoft.EntityFrameworkCore;\n\nnamespace BookShop.Dal;\n\npublic class BookShopDbContext : DbContext \n{ \n    public BookShopDbContext(DbContextOptions options) : base(options) \n    { } \n\n    public DbSet&lt;Book&gt; Books { get; set; } \n    public DbSet&lt;Category&gt; Categories { get; set; }\n}\n</code></pre> </li> <li> <p>Ha k\u00e9zzel hozzuk l\u00e9tre az oszt\u00e1lyt, a <code>using</code>-okat k\u00e9s\u0151bb szoktuk a k\u00f3dba helyezni, amikor hivatkoz\u00e1s t\u00f6rt\u00e9nik r\u00e1juk, ehhez a Ctrl+. billenty\u0171ket vagy a bal oldali s\u00e1rga villanyk\u00f6rt\u00e9t tudjuk haszn\u00e1lni.</p> </li> <li> <p>A fenti k\u00f3dot tudjuk m\u00e9g t\u00f6m\u00f6rebben \u00edrni a <code>primary constructor</code> haszn\u00e1lat\u00e1val. Ehhez kattintsunk a sor elej\u00e9n tal\u00e1lhat\u00f3 l\u00e1mpa ikonra, vagy a konstruktor neve alatt l\u00e9v\u0151 ... r\u00e9szre.</p> Quick actions - Primary constructor <p>A primary constructort \u00e9rdemes haszn\u00e1lni egyszer\u0171bb oszt\u00e1lyokn\u00e1l, a t\u00f6m\u00f6rebb k\u00f3d \u00e9rdek\u00e9ben. R\u00e9szletesen: primary constructor </p> <p>Quick actions</p> </li> <li> <p>\u00cdgy a fenti k\u00f3dunk m\u00e9g t\u00f6m\u00f6rebb lett.</p> BookShopDbContext.cs<pre><code>public class BookShopDbContext(DbContextOptions options) : DbContext(options) \n{\n    public DbSet&lt;Book&gt; Books { get; set; } \n    public DbSet&lt;Category&gt; Categories { get; set; }\n}\n</code></pre> </li> <li> <p>Az oszt\u00e1ly konstruktor\u00e1ban egy <code>DbContextOptions</code> p\u00e9ld\u00e1nyt v\u00e1r, ami az adatb\u00e1zis-kapcsolat konfigur\u00e1ci\u00f3s be\u00e1ll\u00edt\u00e1sait (timeout, connection string) tartalmazza. Ezt k\u00e9s\u0151bb konfigur\u00e1ljuk fel. Ez az oszt\u00e1ly, \u00e9s a benne tal\u00e1lhat\u00f3 <code>DbSet&lt;T&gt;</code> p\u00e9ld\u00e1nyok megval\u00f3s\u00edtj\u00e1k az \u00fan. repository mint\u00e1t. A minta gyakorlatilag t\u00e1voli objektumok proxy-z\u00e1s\u00e1t, esetleges cache-el\u00e9s\u00e9t val\u00f3s\u00edtja meg a CRUD m\u0171veletek el\u00e9rhet\u0151v\u00e9 t\u00e9tel\u00e9vel. Az ut\u00f3bbi id\u0151szakban egyre trendibb lett (sajnos) plusz egy repository r\u00e9teg fel\u00e9p\u00edt\u00e9se az EF r\u00e9teg f\u00f6l\u00e9, ezt a megk\u00f6zel\u00edt\u00e9st er\u0151sen ellenjavalljuk (k\u00f3dkarbantarthat\u00f3s\u00e1gi, teljes\u00edtm\u00e9nybeli \u00e9s architekt\u00far\u00e1lis okokb\u00f3l). Egy <code>DbContext</code> p\u00e9ld\u00e1nyt haszn\u00e1lva mi magunk val\u00f3s\u00edtjuk meg a Unit of work mint\u00e1t, a p\u00e9ld\u00e1ny l\u00e9trej\u00f6tte \u00e9s az egyes <code>SaveChanges</code> h\u00edv\u00e1sok k\u00f6z\u00f6tt egy egys\u00e9gnyi munka t\u00f6rt\u00e9nik. A <code>DbContext</code> megval\u00f3s\u00edtja az <code>IDisposable</code> interf\u00e9szt, teh\u00e1t van saj\u00e1t <code>Dispose</code> met\u00f3dusa, mely az adatb\u00e1zis kapcsolat bont\u00e1s\u00e1\u00e9rt felel\u0151s. Ha nem <code>DI</code> seg\u00edts\u00e9g\u00e9vel adjuk \u00e1t a megfelel\u0151 p\u00e9ld\u00e1nyt hanem k\u00e9zzel hozzuk l\u00e9tre (ami nem javasolt), akkor mindig <code>using</code> vagy <code>try-(catch-)finally</code> blokkban haszn\u00e1ljuk a <code>DbContext</code> p\u00e9ld\u00e1nyokat, mert \u00edgy garant\u00e1lhat\u00f3 csak a dr\u00e1ga adatb\u00e1ziskapcsolatok megsz\u00fcntet\u00e9se, amikor m\u00e1r nincsen r\u00e1juk tov\u00e1bb sz\u00fcks\u00e9g!</p> </li> <li>A s\u00e9ma megad\u00e1s\u00e1hoz Code First megk\u00f6zel\u00edt\u00e9st haszn\u00e1lunk (teh\u00e1t a DB modellj\u00e9t .NET k\u00f3dban adjuk meg), az adatb\u00e1zis s\u00e9m\u00e1j\u00e1nak karbantart\u00e1s\u00e1hoz pedig a keretrendszer \u00e1ltal t\u00e1mogatott \u00fan. migr\u00e1ci\u00f3kat haszn\u00e1lunk.</li> <li>Ahhoz, hogy a migr\u00e1ci\u00f3kat l\u00e9tre tudjuk hozni indul\u00f3 projekt n\u00e9lk\u00fcl sz\u00fcks\u00e9ges egy <code>IDesignTimeDbContextFactory</code> implement\u00e1l\u00e1sa.</li> <li>K\u00e9sz\u00edts\u00fck el a <code>BookShop.Dal</code> projektben a saj\u00e1t <code>IDesignTimeDbContextFactory</code> implement\u00e1ci\u00f3nkat. Ez az ideiglenes megold\u00e1s arra j\u00f3, hogy ki tudjuk pr\u00f3b\u00e1lni a migr\u00e1ci\u00f3t, a n\u00e9lk\u00fcl hogy tov\u00e1bbi r\u00e9tegeket venn\u00e9nk fel.</li> <li> <p>Hozzuk l\u00e9tre a <code>BookShopDbContextFactory</code> oszt\u00e1lyt az al\u00e1bbi implement\u00e1ci\u00f3val.</p> BookShopDbContextFactory.cs<pre><code>using Microsoft.EntityFrameworkCore;\nusing Microsoft.EntityFrameworkCore.Design;\n\nnamespace BookShop.Dal;\n\ninternal class BookShopDbContextFactory : IDesignTimeDbContextFactory&lt;BookShopDbContext&gt;\n{\n    public BookShopDbContext CreateDbContext(string[] args)\n    {\n        var optionsBuilder = new DbContextOptionsBuilder&lt;BookShopDbContext&gt;();\n        optionsBuilder.UseSqlServer(\"Data Source=.;Initial Catalog=BookShopDb;Integrated Security=True;TrustServerCertificate=True\");\n\n        return new BookShopDbContext(optionsBuilder.Options);\n    }\n}\n</code></pre> </li> <li> <p>Figyelj\u00fck meg, hogy az oszt\u00e1ly <code>internal</code> hiszen nem szeretn\u00e9nk m\u00e1shonnan el\u00e9rni. Ezen fel\u00fcl ennek a megold\u00e1snak a h\u00e1tr\u00e1ny\u00e1t is vegy\u00fck \u00e9szre, hiszen itt az adatb\u00e1zis kapcsol\u00f3d\u00e1si sztringet bele kellett \u00edrni a k\u00f3dba, nem konfigur\u00e1ci\u00f3b\u00f3l olvassuk fel! Ezen fel\u00fcl az SQL kapcsol\u00f3d\u00e1si sztringben szerepel egy <code>TrustServerCertificate=True</code> ami azt jelzi, hogy a szerver SSL tan\u00fas\u00edtv\u00e1ny\u00e1t fogadja el akkor is, ha az nem \u00e9rv\u00e9nyes.</p> </li> <li> <p>A migr\u00e1ci\u00f3 automatiz\u00e1lt l\u00e9trehoz\u00e1s\u00e1ra k\u00e9t lehet\u0151s\u00e9g\u00fcnk van: <code>PowerShell</code> vagy a platform f\u00fcggetlen <code>.NET Core CLI</code> (Command Line Interface), ami a <code>dotnet ef</code> parancs (ezt \u00e9rdemes global package-k\u00e9nt telep\u00edteni, ha ezt szeretn\u00e9nk haszn\u00e1lni). Sz\u00e1munkra egyszer\u0171bb most az els\u0151 megold\u00e1s, ez\u00e9rt nyissuk meg a <code>Package Manager Console</code>-t (View \u2192 Other Windows \u2192 Package Manager Console), \u00e9s adjuk ki az al\u00e1bbi parancsot (k\u00f6zben \u00fcgyelj\u00fcnk, hogy a Default projekt a <code>BookShop.Dal</code> legyen!):</p> Hol tal\u00e1lom a Package Manager Console ablakot? <p></p> <p>Package Manager Console megnyit\u00e1sa</p> <p>Ahhoz, hogy ki tudjuk adni az Add-Migration parancsot, fel kell telep\u00edteni a <code>Microsoft.EntityFrameworkCore.Tools</code> nuget packaget a DAL projekthez</p> </li> <li> <p>A <code>Package Manager Console</code>-b\u00f3l adjuk ki a parancsot, ami legener\u00e1lja a kezdeti migr\u00e1ci\u00f3t. Figyelj\u00fcnk arra, hogy a Default project a <code>BookShop.Dal</code> legyen. Az \u00e1tadott <code>Initial</code> param\u00e9ter egy szabadsz\u00f6veges sting, mely a migr\u00e1ci\u00f3nk nev\u00e9t adja. Ez teh\u00e1t a kiindul\u00f3 (initial) migr\u00e1ci\u00f3nk.</p> <pre><code>Add-Migration Initial\n</code></pre> Seg\u00edts\u00e9g - Hol tal\u00e1lom a Package Manager Console ablakot? <p></p> <p>Package Manager Console - kezdeti migr\u00e1ci\u00f3 l\u00e9trehoz\u00e1sa</p> </li> <li> <p>N\u00e9zz\u00fck meg a solution explorer ablakban, hogy l\u00e9trej\u00f6ttek a migr\u00e1ci\u00f3k.</p> L\u00e9trej\u00f6ttek a migr\u00e1ci\u00f3s f\u00e1jlok <p></p> <p>A l\u00e9trej\u00f6tt migr\u00e1ci\u00f3s f\u00e1jlok</p> <p>A migr\u00e1ci\u00f3s f\u00e1jlokban (pl.: <code>Datum_Initial.cs</code>) j\u00f3l \u00e9rtelmezhet\u0151, gener\u00e1lt k\u00f3dot tal\u00e1lunk, amelyekben sz\u00fcks\u00e9g eset\u00e9n ak\u00e1r m\u00f3dos\u00edt\u00e1sokat is v\u00e9gezhet\u00fcnk, \u00e9s b\u00e1r ez \u00e1ltal\u00e1noss\u00e1gban nem jellemz\u0151, mindenk\u00e9pp tudni illik, mert el\u0151fordul, hogy k\u00e9zi m\u00f3dos\u00edt\u00e1st kell v\u00e9gezn\u00fcnk ezekben a f\u00e1jlokban. Ez \u00e9p\u00edti fel a migr\u00e1ci\u00f3hoz sz\u00fcks\u00e9ges SQL parancsokat az alkalmaz\u00e1shoz, teh\u00e1t defini\u00e1lja a s\u00e9m\u00e1t: t\u00e1bl\u00e1kat, kulcsokat, megk\u00f6t\u00e9seket stb.</p> <p></p> <p>A kezdeti migr\u00e1ci\u00f3 tartalma</p> </li> <li> <p>Futtassuk le a migr\u00e1ci\u00f3t, hogy l\u00e9trej\u00f6jj\u00f6n az adatb\u00e1zis is.</p> <pre><code>Update-Database\n</code></pre> Seg\u00edts\u00e9g - K\u00e9perny\u0151k\u00e9p az update-database futtat\u00e1s\u00e1r\u00f3l <p></p> <p>Adatb\u00e1zis migr\u00e1ci\u00f3 futtat\u00e1sa</p> </li> <li> <p>Ezut\u00e1n megvizsg\u00e1lhatjuk SQL Server Object Explorerben a l\u00e9trej\u00f6tt s\u00e9m\u00e1t is.</p> L\u00e9trej\u00f6tt az adatb\u00e1zis <p></p> <p>A l\u00e9trej\u00f6tt adatb\u00e1zis MS SQL Management studi\u00f3ban.</p> <p>\u00c9rdemes \u00e9szrevenn\u00fcnk, hogy az <code>Id</code> oszlophoz automatikusan DB-gener\u00e1lt kulcs j\u00f6n l\u00e9tre, pedig ezt nem fogalmaztuk meg sehol. Az EF konvenci\u00f3kat haszn\u00e1l nagyon sok s\u00e9m\u00e1val kapcsolatos m\u0171velethez, ilyen p\u00e9ld\u00e1ul az els\u0151dleges kulcs k\u00e9nyszer is, amivel, ha egy entit\u00e1sban egy <code>int</code> vagy <code>Guid</code> t\u00edpus\u00fa, <code>ID</code>, <code>Id</code> vagy <code>&lt;T\u00edpus&gt;Id</code> nev\u0171 mez\u0151t hozunk l\u00e9tre, az automatikus kulcsa lesz az adott t\u00e1bl\u00e1nak. 23. A migr\u00e1ci\u00f3ban l\u00e1thatjuk, hogy egy <code>Up()</code> \u00e9s egy <code>Down()</code> met\u00f3dus ker\u00fcl defini\u00e1l\u00e1sra. Az <code>Up()</code> met\u00f3dusok lefuttat\u00e1s\u00e1val a keretrendszer olyan SQL k\u00f3dot gener\u00e1l, amelyet egy kor\u00e1bbi (teh\u00e1t \u00fcres) adatb\u00e1zison lefuttatva a migr\u00e1ci\u00f3 \u00e1llapot\u00e1nak megfelel\u0151 s\u00e9m\u00e1t hoz l\u00e9tre. A <code>Down()</code> futtat\u00e1s\u00e1val a kor\u00e1bbi \u00e1llapotra tudunk vissza\u00e1llni. Figyelj\u00fck meg, hogy az adatb\u00e1zisban is be\u00e1ll\u00edtja a <code>Book.cs</code>-ben megadott property-k t\u00edpusa alapj\u00e1n, hogy az adott mez\u0151 lehet-e null.</p> <ul> <li>A PublishYear t\u00edpusa int \u00edgy az k\u00f6telez\u0151 mez\u0151, nem lehet null az \u00e9rt\u00e9ke</li> <li>A DiscountedPrice t\u00edpusa decimal? ami viszont lehet null, ez\u00e9rt az adatb\u00e1zis t\u00e1bl\u00e1ban is nullable-k\u00e9nt j\u00f6n l\u00e9tre.</li> <li>A Title string t\u00edpus\u00fa \u00e9s az adatb\u00e1zisban not null-k\u00e9nt j\u00f6n l\u00e9tre. De mi\u00e9rt? A string lehet null. Vagy m\u00e9gsem? Att\u00f3l f\u00fcgg, hogy a Nullable reference type-okat haszn\u00e1ljuk vagy sem. A gener\u00e1lt projekt alap\u00e9rtelmez\u00e9s szerint haszn\u00e1lja, teh\u00e1t a string nem lehet null. Ha meg szeretn\u00e9nk engedni, hogy a sztring lehessen null, akkor string? -et kell haszn\u00e1lni, ahogy haszn\u00e1ltuk is a <code>Book.cs</code>-ben</li> </ul> </li> </ol>"},{"location":"seminar/2%20-%20Projekt%20struktura/#wireupcs-bevezetese","title":"Wireup.cs bevezet\u00e9se","text":"<ol> <li>Szebb\u00e9 tehetj\u00fck a k\u00f3dunkat, ha a DbContext regisztr\u00e1l\u00e1s\u00e1t a DAL r\u00e9tegben val\u00f3s\u00edtjuk meg egy extension met\u00f3dusban, amit majd a k\u00e9s\u0151bbiekben tudunk h\u00edvni a BLL-b\u0151l.</li> <li> <p>Ehhez el\u0151sz\u00f6r a <code>BookShop.Dal</code> projekt gy\u00f6ker\u00e9ben hozzunk l\u00e9tre egy <code>Wireup.cs</code>, amiben egy <code>AddBookShopDbContext</code> extension met\u00f3dust defini\u00e1lunk az al\u00e1bbiak szerint.</p> Wireup.cs<pre><code>using Microsoft.EntityFrameworkCore;\nusing Microsoft.Extensions.Configuration;\nusing Microsoft.Extensions.DependencyInjection;\n\nnamespace BookShop.Dal;\n\npublic static class Wireup\n{\n    public static IServiceCollection AddBookShopDbContext(this IServiceCollection services, IConfiguration configuration)\n    {\n        // DB Context regisztr\u00e1l\u00e1sa a DI containerbe.\n        services.AddDbContext&lt;BookShopDbContext&gt;(options =&gt;\n        {\n            options.UseSqlServer(configuration.GetConnectionString(\"DefaultConnection\"));\n        });\n\n        return services;\n    }\n}\n</code></pre> </li> <li> <p>Ezt a f\u00fcggv\u00e9nyt megh\u00edvva tudjuk majd a DbContext-et beregisztr\u00e1lni \u00fagy, hogy az adatb\u00e1zis kapcsol\u00f3d\u00e1si sztringet a startup project appsettings.json f\u00e1jl <code>DefaultConnection</code> \u00e9rt\u00e9k\u00e9b\u0151l olvassa ki.</p> </li> </ol>"},{"location":"seminar/2%20-%20Projekt%20struktura/#db-diagram-keszitese","title":"DB diagram k\u00e9sz\u00edt\u00e9se","text":"<ol> <li> <p>A k\u00e9s\u0151bbiekben a fejleszt\u00e9st nagy m\u00e9rt\u00e9kben seg\u00edti, ha az adatmodellr\u0151l van egy diagramunk. Ezt \u00fagy tudjuk l\u00e9trehozni, hogy a <code>BoohShop.Dal/Entites</code> k\u00f6nyvt\u00e1rhoz hozz\u00e1adunk egy \u00faj <code>Class Diagram</code> t\u00edpus\u00fa elemet.</p> Seg\u00edts\u00e9g - Class diagram hozz\u00e1ad\u00e1sa a projekthez <p></p> <p>Class diagram hozz\u00e1ad\u00e1sa a projekthez.</p> </li> <li> <p>Ezt k\u00f6vet\u0151en h\u00fazzuk r\u00e1 a diagramra a <code>Book</code> \u00e9s <code>Category</code> entit\u00e1sokat. Azonban ez m\u00e9g kev\u00e9s, mert szeretn\u00e9nk a \"t\u00e1bl\u00e1k\" (val\u00f3j\u00e1ban entit\u00e1sok) k\u00f6z\u00f6tti kapcsolatokat is l\u00e1tni. Ehhez kattintunk jobb gombbal a <code>Category</code> entit\u00e1s <code>ChildCategories</code> tulajdons\u00e1g\u00e1ra, majd v\u00e1lasszuk a <code>Show as Collection Association</code>-t, hiszen egy egy lista. Ha nem lista lenne akkor a <code>Show as Assiciation</code> a megfelel\u0151 v\u00e1laszt\u00e1s.</p> Seg\u00edts\u00e9g - Navig\u00e1ci\u00f3s tulajdons\u00e1gok mutat\u00e1sa kapcsolatk\u00e9nt <p></p> <p>Class diagram hozz\u00e1ad\u00e1sa a projekthez.</p> </li> <li> <p>\u00c1ll\u00edtsuk be a <code>ParentCategory</code>-ra \u00e9s a <code>Books</code>-ra is, hogy kapcsolatk\u00e9nt mutassa.</p> El\u00e9sz\u00fclt adat modell diagram <p></p> <p>Az elk\u00e9sz\u00edtett adat modell diagram.</p> </li> <li> <p>\u00cdgy m\u00e1r van egy folyamatosan friss\u00fcl\u0151 diagramunk a k\u00f3dban, ahol \u00e1ttekinthetj\u00fck a EF modell\u00fcnket.</p> </li> </ol>"},{"location":"seminar/2%20-%20Projekt%20struktura/#kezdeti-adatfeltoltes","title":"Kezdeti adatfelt\u00f6lt\u00e9s","text":"<ol> <li> <p>Az alkalmaz\u00e1s kezdeti, \u00fan. \u0151sadatokkal t\u00f6rt\u00e9n\u0151 felt\u00f6lt\u00e9s\u00e9t (seed) a keretrendszer seg\u00edts\u00e9g\u00e9vel oldjuk meg. \u0150s adatokat a <code>DbContext.OnModelCreating</code> met\u00f3dus\u00e1nak fel\u00fcldefini\u00e1l\u00e1s\u00e1val, \u00e9s a <code>ModelBuilder</code> fluent API haszn\u00e1lat\u00e1val tudunk az alkalmaz\u00e1shoz felvenni. Ehhez override-olnunk kell a megfelel\u0151 met\u00f3dust a <code>BookShopDbContext</code>-ben.</p> BookShopDbContext.cs<pre><code>public class BookShopDbContext(DbContextOptions options) : DbContext(options) \n{\n    public DbSet&lt;Book&gt; Books { get; set; }\n    public DbSet&lt;Category&gt; Categories { get; set; }\n\n    protected override void OnModelCreating(ModelBuilder modelBuilder) {\n        base.OnModelCreating(modelBuilder);\n\n        modelBuilder.Entity&lt;Book&gt;().HasData(new Book { Id = 1, Title = \"Teszt k\u00f6nyv\", ... });\n    }\n}\n</code></pre> <p>Base OnModelCreating megh\u00edv\u00e1sa</p> <p>Fontos, hogy az \u0151soszt\u00e1ly <code>OnModelCreating</code> met\u00f3dus\u00e1t is megh\u00edvjuk, mert ha lesz\u00e1rmazunk k\u00e9s\u0151bb az IdentityDbContext-b\u0151l akkor ne hasaljon el a migr\u00e1ci\u00f3 k\u00e9sz\u00edt\u00e9se.</p> </li> <li> <p>Fontos megeml\u00edteni, hogy a fenti p\u00e9ld\u00e1hoz hasonl\u00f3an a HasData API-n kereszt\u00fcl mindig k\u00f6telez\u0151 kit\u00f6lteni az entit\u00e1sok els\u0151dleges kulcsait! Ez az\u00e9rt lehet szokatlan, mert mesters\u00e9ges kulcsok eset\u00e9n (mint a <code>Book</code> eset\u00e9ben is) alapvet\u0151en az adatb\u00e1zis feladata megadni egy elem ID-j\u00e1t, ez\u00e9rt m\u00e1s helyen az <code>Id</code>-t az alap\u00e9rtelmezett <code>0</code> \u00e9rt\u00e9ken fogjuk hagyni az \u00fczleti logik\u00e1ban l\u00e9trehoz\u00e1skor, azt az adatb\u00e1zis fogja kit\u00f6lteni szekvencia alapj\u00e1n. Most az\u00e9rt kell megadnunk az ID-kat, mert ezek a k\u00f3dban defini\u00e1lt entit\u00e1sok val\u00f3j\u00e1ban \u00fagy kezelend\u0151k, mintha az adatb\u00e1zisban lenn\u00e9nek megtal\u00e1lhat\u00f3k, teh\u00e1t minden tulajdons\u00e1gukat el\u0151re sz\u00e1m\u00edtottuk \u00e9s fixnek, determinisztikusnak kell lenni\u00fck. Ha nem determinisztikusak ezek az \u00e9rt\u00e9kek, minden migr\u00e1ci\u00f3 gener\u00e1l\u00e1sakor \u00fajra \u00e9s \u00fajra be fognak sz\u00far\u00f3dni az adatb\u00e1zisba az entit\u00e1sok vagy hib\u00e1ra fogunk futni. R\u00f6viden teh\u00e1t itt be\u00e9getett ID-kat kell haszn\u00e1lnunk. A fenti API haszn\u00e1lat\u00e1val nem csak \u0151s adatokat, hanem egy\u00e9b metaadat-szint\u0171 konfigur\u00e1ci\u00f3t is megadhatunk, p\u00e9ld\u00e1ul adatt\u00e1bl\u00e1k nev\u00e9t, oszlopok egyedis\u00e9g\u00e9t, indexeket stb. Ezt az API-t a k\u00e9s\u0151bbiekben, a v\u00e9gleges adatmodell k\u00e9sz\u00edt\u00e9sekor fogjuk alaposabban megvizsg\u00e1lni.</p> </li> <li> <p>T\u00f6lts\u00fcnk fel egy p\u00e1r kezdeti k\u00f6nyvet az al\u00e1bbi k\u00f3ddal</p> BookShopDbContext.cs<pre><code>public class BookShopDbContext(DbContextOptions options) : DbContext(options) \n{\n   public DbSet&lt;Book&gt; Books { get; set; }\n\n   protected override void OnModelCreating(ModelBuilder modelBuilder) \n   {\n     modelBuilder.Entity&lt;Category&gt;().HasData(\n       new Category { Id = 1, Name = \"Ezoterika\", ParentCategoryId = null, Order = \"00\" },\n       new Category { Id = 2, Name = \"Feng shui\", ParentCategoryId = 1, Order = \"00.01\" },\n       new Category { Id = 3, Name = \"Horoszk\u00f3p, asztrol\u00f3gia\", ParentCategoryId = 1, Order = \"00.02\" },\n       new Category { Id = 4, Name = \"Parapszichol\u00f3gia\", ParentCategoryId = 1, Order = \"00.03\" },\n       new Category { Id = 5, Name = \"Irodalom\", ParentCategoryId = null, Order = \"01\" },\n       new Category { Id = 6, Name = \"\u00c9letrajz\", ParentCategoryId = 5, Order = \"01.01\" },\n       new Category { Id = 7, Name = \"Dr\u00e1ma, sz\u00ednm\u0171\", ParentCategoryId = 5, Order = \"01.02\" },\n       new Category { Id = 8, Name = \"Vers, eposz\", ParentCategoryId = 5, Order = \"01.03\" },\n       new Category { Id = 9, Name = \"Tank\u00f6nyvek\", ParentCategoryId = null, Order = \"02\" },\n       new Category { Id = 10, Name = \"Matematika\", ParentCategoryId = null, Order = \"02.01\" },\n       new Category { Id = 11, Name = \"K\u00e9mia\", ParentCategoryId = null, Order = \"02.02\" },\n       new Category { Id = 12, Name = \"K\u00f6zgazdas\u00e1gtudom\u00e1ny\", ParentCategoryId = null, Order = \"02.03\" },\n       new Category { Id = 13, Name = \"Biol\u00f3gia\", ParentCategoryId = null, Order = \"02.04\" },\n       new Category { Id = 14, Name = \"Reg\u00e9ny\", ParentCategoryId = null, Order = \"03\" },\n       new Category { Id = 15, Name = \"Csal\u00e1dreg\u00e9ny\", ParentCategoryId = 14, Order = \"03.01\" },\n       new Category { Id = 16, Name = \"Fantasy\", ParentCategoryId = 14, Order = \"03.02\" },\n       new Category { Id = 17, Name = \"Erotikus\", ParentCategoryId = 14, Order = \"03.03\" },\n       new Category { Id = 18, Name = \"Krimi\", ParentCategoryId = 14, Order = \"03.04\" },\n       new Category { Id = 19, Name = \"Sci - fi\", ParentCategoryId = 14, Order = \"03.05\" },\n       new Category { Id = 20, Name = \"Thriller\", ParentCategoryId = 14, Order = \"03.06\" },\n       new Category { Id = 21, Name = \"T\u00f6rt\u00e9nelmi\", ParentCategoryId = 14, Order = \"03.07\" }\n     );\n\n     modelBuilder.Entity&lt;Book&gt;().HasData(\n       new Book()\n       {\n         Id = 1,\n         Title = \"A szem\u00e9lyes feng shui tan\u00e1csad\u00f3\",\n         Author = \"Lam Kam Chuen Mester\",\n         Subtitle = \"Hogyan \u00e9lj\u00fcnk eg\u00e9szs\u00e9gesen \u00e9s harmonikusan\",\n         PageNumber = 168,\n         Price = 3200,\n         PublishYear = 2004,\n         ShortDescription = \"A Szem\u00e9lyes feng shui tan\u00e1csad\u00f3 elmagyar\u00e1zza a feng shui alapelveit...\",\n       },\n\n       new Book()\n       {\n         Id = 2,\n         Title = \"Az \u00e9n feng shui-kertem\",\n         Author = \"Susanne Schumacher\",\n         Subtitle = \"\u00d6tletek kertekhez, teraszokhoz, erk\u00e9lyekhez\",\n         PageNumber = 128,\n         Price = 4900,\n         PublishYear = 2008,\n         ShortDescription = \"K\u00e9pzelje azt, hogy kertje egy ruhadarab....\",\n       },\n\n       new Book()\n       {\n         Id = 3,\n         Title = \"Feng Shui\",\n         Author = \"Ernest J. Eitel\",\n         Subtitle = \"A term\u00e9szet \u00e9s az egyens\u00faly k\u00ednai tudom\u00e1ny\u00e1val kapcsolatos alapvet\u0151 tudnival\u00f3k\",\n         PageNumber = 80,\n         Price = 699,\n         PublishYear = 2012,\n         ShortDescription = \"Az ember, az ember \u00e1ltal l\u00e9trehozott k\u00f6rnyezet...\",\n       }\n     );\n   }\n}\n</code></pre> </li> <li> <p>Most, hogy elk\u00e9sz\u00fclt\u00fcnk az \u0151sadatokkal, \u00fajabb migr\u00e1ci\u00f3t kell k\u00e9sz\u00edten\u00fcnk, ami az adatok bet\u00f6lt\u00e9s\u00e9\u00e9rt lesz felel\u0151s. Szint\u00e9n a <code>Package Manager Console</code>-ban adjuk ki a <code>Add-Migration</code> parancsot, \u00fcgyelve arra, hogy a <code>Bookshop.Dal</code> projekt legyen kiv\u00e1lasztva:</p> <pre><code>Add-Migration InitialSeed\n</code></pre> Ha mindent j\u00f3l csin\u00e1ltunk \u00edgy fog kin\u00e9zni a migr\u00e1ci\u00f3nk. <p></p> <p>Migr\u00e1ci\u00f3s f\u00e1jl az \u0151sadat felt\u00f6lt\u00e9shez.</p> </li> <li> <p>Futtassuk is le a migr\u00e1ci\u00f3t</p> <pre><code>Update-Database\n</code></pre> \u0150sadatok beker\u00fcltek az <p></p> <p>Az adatok beker\u00fcltek az adatb\u00e1zisba is.</p> </li> <li> <p>Figyelj\u00fck meg, hogy b\u00e1r a <code>Book.cs</code>-ben nem vett\u00fck fel <code>CategoryId</code> tulajdons\u00e1got, m\u00e9gis az adatb\u00e1zisba l\u00e9trej\u00f6tt egy ilyen oszlop. Ez az\u00e9rt van, mert a <code>Category.cs</code>-ben felvett\u00fcnk egy navig\u00e1ci\u00f3s tulajdons\u00e1got a <code>Books</code> list\u00e1t, ami egy egy-t\u00f6bbes kapcsolat a kateg\u00f3ria \u00e9s a k\u00f6nyv k\u00f6z\u00f6tt \u00edgy az EF automatikusan l\u00e9trehozza az adatb\u00e1zisban a sz\u00fcks\u00e9ges mez\u0151t.</p> CategoryId az adatb\u00e1zisban??? <p></p> <p>Adatb\u00e1zisban ott van a CategoryId a Book t\u00e1bl\u00e1ban</p> </li> <li> <p>Az\u00e9rt, hogy az EF modellben is l\u00e1that\u00f3 legyen ez a kapcsolat \u00e9rdemes a modellt kib\u0151v\u00edteni ezzel a tulajdons\u00e1ggal \u00e9s a navig\u00e1ci\u00f3t tulajdons\u00e1got a m\u00e1sik ir\u00e1nyba is felvenni. Mivel most nem szeretn\u00e9nk mindenhol kit\u00f6lteni ezt az \u00e9rt\u00e9ket ez\u00e9rt nullable-nek vessz\u00fck fel.</p> Book.cs<pre><code>public class Book\n{\n    public int Id { get; set; }\n    public string Title { get; set; } = null!;\n    public string Author { get; set; } = null!;\n    public string? Subtitle { get; set; }\n    public string? ShortDescription { get; set; }\n    public decimal Price { get; set; }\n    public decimal? DiscountedPrice { get; set; }\n    public int PublishYear { get; set; }\n    public int PageNumber { get; set; }\n\n    public int? CategoryId { get; set; }\n    public Category? Category { get; set; }\n}\n</code></pre> </li> <li> <p>Illetve a DbDiagram-ot is \u00e9rdemes be\u00e1ll\u00edtani ezt a kapcsolatot. A tulajdons\u00e1g m\u00e1r ott lesz, hiszen a modellbe beker\u00fclt. \u00c1ltal\u00e1noss\u00e1gban elmondhat\u00f3, hogy a navig\u00e1ci\u00f3s tulajdons\u00e1gokn\u00e1l \u00e9rdemes mind a k\u00e9t ir\u00e1nyt felvenni.</p> CategoryId felv\u00e9ve az adat modell diagramra <p></p> <p>CategoryId felv\u00e9tele az adatmodell diagramra.</p> </li> </ol>"},{"location":"seminar/2%20-%20Projekt%20struktura/#dto-k-keszitese","title":"DTO-k k\u00e9sz\u00edt\u00e9se","text":"<ol> <li> <p>Az adatb\u00e1zis entit\u00e1sok m\u00e1r megvannak, viszont nem szeretn\u00e9nk, hogy a kliens oldalra, vagy a webes fel\u00fcletre entit\u00e1sok jussanak el, ez\u00e9rt a Transfer projektben hozzuk l\u00e9tre azokat a DTO oszt\u00e1lyokat, amit majd a Webes projekt / kliens haszn\u00e1lni fog. A DTO-k elnevez\u00e9s\u00e9n\u00e9l nem \u00e9rdemes a DTO postfixet haszn\u00e1lni. Haszn\u00e1ljuk helyette ink\u00e1bb az al\u00e1bbi konvenci\u00f3t:</p> <ul> <li>Header: Csak alap adatokat tartalmaz, nem hivatkozik m\u00e1s DTO-ra</li> <li>Data: A fontosabb adatokat tartalmazza, hivatkozhat m\u00e1s DTO-ra is.</li> <li>Details: Minden vagy a szerkeszt\u00e9shez sz\u00fcks\u00e9ges adatokat tartalmazza.</li> </ul> </li> <li> <p>Hozzunk l\u00e9tre egy <code>BookData.cs</code> oszt\u00e1lyt az al\u00e1bbi tartalommal.</p> BookData.cs<pre><code>namespace BookShop.Transfer;\n\npublic class BookData\n{\n    public int Id { get; set; }\n    public string Title { get; set; } = null!;\n    public string Author { get; set; } = null!;\n    public string? Subtitle { get; set; }\n    public string? ShortDescription { get; set; }\n    public decimal Price { get; set; }\n    public decimal? DiscountPrice { get; set; }\n    public int PublishYear { get; set; }\n    public int PageNumber { get; set; }\n    public int? CategoryId { get; set; }\n}\n</code></pre> </li> <li> <p>Hozzuk l\u00e9tre hasonl\u00f3an a <code>CategoryHeader</code> oszt\u00e1lyt is.</p> CategoryHeader.cs<pre><code>namespace BookShop.Transfer;\n\npublic class CategoryHeader\n{\n    public int Id { get; set; }\n    public string Name { get; set; } = null!;\n    public int Level { get; set; }\n}\n</code></pre> </li> <li> <p>Ez ut\u00e1n m\u00e1r csak annyi feladatunk van, hogy a BLL-ben elk\u00e9sz\u00edtj\u00fck az adatb\u00e1zis lek\u00e9rdez\u00e9seket, amik DTO-kat adnak vissza.</p> </li> </ol>"},{"location":"seminar/2%20-%20Projekt%20struktura/#bll-service-ek-megvalositasa","title":"BLL service-ek megval\u00f3s\u00edt\u00e1sa","text":"<p>A BLL-ben val\u00f3s\u00edtjuk meg azokat a szolg\u00e1ltat\u00e1sokat \u00e9s hozz\u00e1 tartoz\u00f3 interf\u00e9szeket, amivel adatokat tudunk lek\u00e9rdezni az adatb\u00e1zisb\u00f3l, illetve itt val\u00f3s\u00edtjuk meg az entit\u00e1s \u2192 DTO mappinget is.</p> <ol> <li>Hozzunk l\u00e9tre a <code>BookShop.Bll</code> projektben egy <code>ServicesInterfaces</code> \u00e9s egy <code>Services</code> mapp\u00e1t.</li> <li> <p>Vegy\u00fck fel az <code>ServicesInterfaces</code> mapp\u00e1ban az <code>IBookService.cs</code> f\u00e1jlt, amiben defini\u00e1lunk egy <code>GetBooksAsny()</code> met\u00f3dust, ami majd visszaadja az \u00f6sszes k\u00f6nyvet egy list\u00e1ban.</p> IBookService.cs<pre><code>using BookShop.Transfer;\n\nnamespace BookShop.Bll.ServicesInterfaces;\n\npublic interface IBookService\n{\n    Task&lt;List&lt;BookData&gt;&gt; GetBooksAsync();\n}\n</code></pre> </li> <li> <p>Vegy\u00fck fel az <code>ServicesInterfaces</code> mapp\u00e1ban az <code>ICatalogService.cs</code> f\u00e1jlt, amiben defini\u00e1lunk egy <code>GetCategoryTreeAsync()</code> met\u00f3dust, ami majd visszaadja az \u00f6sszes kateg\u00f3ri\u00e1t egy list\u00e1ban.</p> ICategoryService.cs<pre><code>using BookShop.Transfer;\n\nnamespace BookShop.Bll.ServicesInterfaces;\n\npublic interface ICategoryService\n{\n    Task&lt;IEnumerable&lt;CategoryHeader&gt;&gt; GetCategoryTreeAsync();\n}\n</code></pre> </li> <li> <p>K\u00e9sz\u00edts\u00fck is el az <code>IBookService</code> interf\u00e9sz implement\u00e1ci\u00f3j\u00e1t is, amit a <code>Services</code> mapp\u00e1ban tegy\u00fcnk <code>BookService</code> n\u00e9vvel. A met\u00f3dus c\u00edm szerint sorbarendezbe kell, hogy visszaadjon a <code>BookData</code> list\u00e1t. Az al\u00e1bbiakban l\u00e1that\u00f3 hozz\u00e1 az implement\u00e1ci\u00f3.</p> BookService.cs<pre><code>using BookShop.Bll.ServicesInterfaces;\nusing BookShop.Dal;\nusing BookShop.Transfer;\nusing Microsoft.EntityFrameworkCore;\n\nnamespace BookShop.Bll.Services;\n\npublic class BookService(BookShopDbContext dbContext) : IBookService\n{\n    private readonly BookShopDbContext dbContext = dbContext;\n\n    public async Task&lt;List&lt;BookData&gt;&gt; GetBooksAsync()\n    {\n        var books = await dbContext.Books\n            .OrderBy(x =&gt; x.Title)\n            .Select(b =&gt; new BookData()\n            {\n                Id = b.Id,\n                Title = b.Title,\n                Subtitle = b.Subtitle,\n                ShortDescription = b.ShortDescription,\n                Price = b.Price,\n                DiscountPrice = b.DiscountedPrice,\n                PublishYear = b.PublishYear,\n                PageNumber = b.PageNumber,\n                Author = b.Author,\n                CategoryId = b.CategoryId,\n            })\n            .ToListAsync();\n\n        return books;\n    }\n}\n</code></pre> </li> <li> <p>K\u00e9sz\u00edts\u00fck is el az <code>ICategoryService</code> interf\u00e9sz implement\u00e1ci\u00f3j\u00e1t is <code>CategoryService</code> n\u00e9vvel. Az \u00f6sszes kateg\u00f3ri\u00e1t vissza kell adni <code>Order</code> szerint rendezve. A <code>Level</code>-t \u00fagy tudjuk meghat\u00e1rozni, hogy az <code>Order</code>-ben h\u00e1ny darab pont szerepel. Az al\u00e1bbiakban l\u00e1that\u00f3 hozz\u00e1 az implement\u00e1ci\u00f3.</p> CategoryService.cs<pre><code>using BookShop.Bll.ServicesInterfaces;\nusing BookShop.Dal;\nusing BookShop.Transfer;\nusing Microsoft.EntityFrameworkCore;\n\nnamespace BookShop.Bll.Services;\n\npublic class CategoryService(BookShopDbContext dbContext) : ICategoryService\n{\n    private readonly BookShopDbContext _dbContext = dbContext;\n\n    public async Task&lt;IEnumerable&lt;CategoryHeader&gt;&gt; GetCategoryTreeAsync()\n    {\n        var allCategories = await _dbContext.Categories\n            .OrderBy(c =&gt; c.Order)\n            .Select(c =&gt; new CategoryHeader()\n            {\n                Id = c.Id,\n                Name = c.Name,\n                Level = c.Order != null\n                    ? c.Order.Split(\".\", StringSplitOptions.None).Length\n                    : 0,\n            })\n            .ToListAsync();\n\n        return allCategories;\n    }\n}\n</code></pre> </li> </ol>"},{"location":"seminar/2%20-%20Projekt%20struktura/#automapper","title":"AutoMapper","text":"<p>Ahogy a fenti k\u00f3dban l\u00e1that\u00f3 most egy egyes Service-ekben tal\u00e1lhat\u00f3 az entit\u00e1s -&gt; DTO mappel\u00e9s, ami m\u0171k\u00f6d\u0151 megold\u00e1s, viszont nem lehet \u00fajrahasznos\u00edtani a mappel\u00e9seket. A gyakorlatban az AutoMapper csomag seg\u00edts\u00e9g\u00e9vel lehet ezeket a mappel\u00e9seket kiszervezni egy k\u00f6z\u00f6s r\u00e9szbe. Regisztr\u00e1ci\u00f3 ut\u00e1n lehet ingyenes licensz kulcsot ig\u00e9nyelni, ami 1 \u00e9vig \u00e9rv\u00e9nyes. Lej\u00e1rat ut\u00e1n ingyenesen meghosszabb\u00edthat\u00f3. Csak nagyv\u00e1llalatoknak kell fizetni \u00e9rte r\u00e9szeletek az \u00e1raz\u00e1s oldalon. A licensz kulcs a Profil oldalr\u00f3l t\u00f6lthet\u0151 le.</p> <ol> <li>A <code>BookShop.Bll</code> projekthez vegy\u00fck fel az <code>AutoMapper</code> NuGet package-et.</li> <li>Vegy\u00fcnk fel egy <code>Mappings</code> k\u00f6nyvt\u00e1rat, ahova az AutoMapper profile-ok ker\u00fclnek majd.</li> <li> <p>K\u00e9sz\u00edts\u00fck el a <code>CategoryProfile</code> oszt\u00e1lyt, ami a <code>AutoMapper.Profile</code> oszt\u00e1lyb\u00f3l sz\u00e1rmazik \u00e9s a konstruktor\u00e1ban hozzunk l\u00e9tre egy mappinget. A mappinget az al\u00e1bbi k\u00e9t m\u00f3don hozhatjuk l\u00e9tre:</p> <ul> <li><code>CreateMap&lt;Entity, Dto&gt;</code>: Haszn\u00e1lhat\u00f3  <code>ProjectTo</code> met\u00f3dussal \u00e9s, a <code>Map</code>-pal is. A <code>Map</code> olyan mappel\u00e9st tesz lehet\u0151v\u00e9, ahol a k\u00f3d nem fordul SQL-re, teh\u00e1t egy tetsz\u0151leges list\u00e1t is \u00e1t tudunk a mem\u00f3ri\u00e1ban mappelni. Csak akkor \u00e9rdemes a <code>CreateMap&lt;Entity, Dto&gt;</code> haszn\u00e1lata, ha mem\u00f3ri\u00e1ban is szeretn\u00e9nk mappelni.</li> <li><code>CreateProjecton&lt;Entity, Dto&gt;</code>: Csak a <code>ProjectTo</code> met\u00f3dussal haszn\u00e1lhat\u00f3, a <code>Map</code>-pel nem, cser\u00e9be gyorsabb. \u00c1ltal\u00e1ban ezt szoktuk haszn\u00e1lni, hiszen a <code>ProjectTo</code> teszi lehet\u0151v\u00e9, hogy az adatb\u00e1zisb\u00f3l csak azt k\u00e9rdezz\u00fck le, amire sz\u00fcks\u00e9g\u00fcnk van. Ha komplex mappel\u00e9st k\u00e9sz\u00edt\u00fcnk, p\u00e9ld\u00e1ul az \u0151szoszt\u00e1ly mappel\u00e9s\u00e9t szeretn\u00e9nk belevennie a lesz\u00e1rmazott oszt\u00e1ly mappel\u00e9s\u00e9be, akkor k\u00e9nytelenek vagyunk a <code>CreateMap</code>-et haszn\u00e1lni.</li> </ul> CategoryProfile.cs<pre><code>using AutoMapper;\nusing BookShop.Dal.Entities;\nusing BookShop.Transfer;\n\nnamespace BookShop.Bll.Mappings;\n\npublic class CategoryProfile : Profile\n{\n    public CategoryProfile()\n    {\n        CreateProjection&lt;Category, CategoryHeader&gt;()\n            .ForMember(dest =&gt; dest.Id, opt =&gt; opt.MapFrom(src =&gt; src.Id))\n            .ForMember(dest =&gt; dest.Name, opt =&gt; opt.MapFrom(src =&gt; src.Name))\n            .ForMember(dest =&gt; dest.Level, opt =&gt; opt.MapFrom(src =&gt; src.Order != null ? src.Order.Split   (\".\", StringSplitOptions.None).Length : 0));\n    }\n}   \n</code></pre> </li> <li> <p>Ahogy a fenti k\u00f3dban is l\u00e1tsz\u00f3dik minden tulajdons\u00e1got mappel\u00fcnk. Ezt nem k\u00f6telez\u0151, mert az AutoMapper az azonos nev\u0171 tulajdons\u00e1gokat automatikusan mappeli. Azonban ha a k\u00f3dot refaktor\u00e1ljuk, akkor a mappel\u00e9s elt\u00f6rhet. Gondoljuk v\u00e9gig, hogy a DTO-ban \u00e1tnevez\u00fcnk egy tulajdons\u00e1got \u00e9s mindenhol ahol el\u0151fordul ott is \u00e1tnevez\u00e9sre ker\u00fcl automatikusan. Viszont mivel a mappingben nem szerepel az adott tulajdons\u00e1g, mert konvenci\u00f3 alapj\u00e1n mappeli az AutoMapper \u00e9s az \u00e1tnevez\u00e9s ut\u00e1n m\u00e1r nem is egyezik meg a DTO-ban \u00e9s az entit\u00e1son a tulajdons\u00e1g el fog t\u00f6rni a k\u00f3d.</p> </li> <li> <p>A fentihez hasonl\u00f3 m\u00f3don k\u00e9sz\u00edts\u00fck el a <code>BookProfile</code> oszt\u00e1lyt is.</p> BookProfile.cs<pre><code>using AutoMapper;\nusing BookShop.Dal.Entities;\nusing BookShop.Transfer;\n\nnamespace BookShop.Bll.Mappings;\n\npublic class BookProfile : Profile\n{\n    public BookProfile()\n    {\n        CreateProjection&lt;Book, BookData&gt;()\n            .ForMember(dest =&gt; dest.Id, opt =&gt; opt.MapFrom(src =&gt; src.Id))\n            .ForMember(dest =&gt; dest.Title, opt =&gt; opt.MapFrom(src =&gt; src.Title))\n            .ForMember(dest =&gt; dest.Subtitle, opt =&gt; opt.MapFrom(src =&gt; src.Subtitle))\n            .ForMember(dest =&gt; dest.ShortDescription, opt =&gt; opt.MapFrom(src =&gt; src.ShortDescription))\n            .ForMember(dest =&gt; dest.Price, opt =&gt; opt.MapFrom(src =&gt; src.Price))\n            .ForMember(dest =&gt; dest.DiscountPrice, opt =&gt; opt.MapFrom(src =&gt; src.DiscountedPrice))\n            .ForMember(dest =&gt; dest.PublishYear, opt =&gt; opt.MapFrom(src =&gt; src.PublishYear))\n            .ForMember(dest =&gt; dest.PageNumber, opt =&gt; opt.MapFrom(src =&gt; src.PageNumber))\n            .ForMember(dest =&gt; dest.Author, opt =&gt; opt.MapFrom(src =&gt; src.Author))\n            .ForMember(dest =&gt; dest.CategoryId, opt =&gt; opt.MapFrom(src =&gt; src.CategoryId));\n    }\n}\n</code></pre> </li> <li> <p>A fenti k\u00f3d elk\u00e9sz\u00edt\u00e9s\u00e9ben a Code Completions a Visual Studio-ban sokat tud seg\u00edteni, ak\u00e1r a teljes k\u00f3dot helyesen fel tudja aj\u00e1nlani. Ez az opci\u00f3 akkor \u00e9rhet\u0151 el ha van GitHub Copilot el\u0151fizet\u00e9s.</p> AI k\u00f3d kieg\u00e9sz\u00edt\u00e9s <p></p> <p>AI k\u00f3d kieg\u00e9sz\u00edt\u00e9s be\u00e1ll\u00edt\u00e1sa</p> </li> <li> <p>Ha megvannak a mapper profilok, akkor m\u00e1r csak annyi dolgunk van, hogy a service-ekben lecser\u00e9lj\u00fck a <code>Select</code>-et egy <code>ProjectTo</code>-ra. Mivel a <code>ProjectTo&lt;DTO&gt;()</code> v\u00e1r egy <code>IConfigurationProvider</code> param\u00e9tert is, a szolg\u00e1ltat\u00e1s konstruktor\u00e1nak \u00e1t kell adni egy <code>IMapper</code>-t, amit majd a DI kont\u00e9nerbe be kell regisztr\u00e1lni. Ez a regisztr\u00e1ci\u00f3t majd a Console Application-ben fogjuk megtenni.</p> </li> <li> <p>M\u00f3dos\u00edtjuk a <code>CategoryService</code>-t, hogy a <code>ProjectTo</code>-t haszn\u00e1lja.</p> CategoryService.cs<pre><code>public class CategoryService(BookShopDbContext dbContext, IMapper mapper) : ICategoryService\n{\n    private readonly BookShopDbContext _dbContext = dbContext;\n\n    public async Task&lt;IEnumerable&lt;CategoryHeader&gt;&gt; GetCategoryTreeAsync()\n    {\n        var allCategories = await _dbContext.Categories\n            .OrderBy(c =&gt; c.Order)\n            .ProjectTo&lt;CategoryHeader&gt;(mapper.ConfigurationProvider)\n            .ToListAsync();\n\n        return allCategories;\n    }\n}\n</code></pre> </li> <li> <p>M\u00f3dos\u00edtjuk a <code>BookService</code>-t is, hogy a <code>ProjectTo</code>-t haszn\u00e1lja.</p> BookService.cs<pre><code>public class BookService(BookShopDbContext dbContext, IMapper mapper) : IBookService\n{\n    private readonly BookShopDbContext dbContext = dbContext;\n\n    public async Task&lt;List&lt;BookData&gt;&gt; GetBooksAsync()\n    {\n        var books = await dbContext.Books\n            .OrderBy(x =&gt; x.Title)\n            .ProjectTo&lt;BookData&gt;(mapper.ConfigurationProvider)\n            .ToListAsync();\n\n        return books;\n    }\n}\n</code></pre> </li> <li> <p>Ezt most nem tudjuk m\u00e9g kipr\u00f3b\u00e1lni, mert nincs futtathat\u00f3 projekt\u00fcnk. Ez\u00e9rt a k\u00f6vetkez\u0151 l\u00e9p\u00e9sben egy egyszer\u0171 Console App-ot adunk a solution-h\u00f6z, hogy el is tudjuk ind\u00edtani az alkalmaz\u00e1st.</p> </li> </ol>"},{"location":"seminar/2%20-%20Projekt%20struktura/#wireupcs","title":"Wireup.cs","text":"<ol> <li>Adjuk a <code>BookShop.Bll</code> projekthez a <code>Microsoft.Extensions.Configuration.Binder</code> nuGet package-et.</li> <li> <p>K\u00e9sz\u00edts\u00fcnk egy <code>Wireup.cs</code>-t a <code>BookShop.Bll</code> projekt gy\u00f6ker\u00e9be is. Itt az AutoMapper-t \u00e9s a BLL szolg\u00e1ltat\u00e1sokat kell regisztr\u00e1lni \u00e9s a DAL-ban l\u00e9trehozott <code>AddBookShopDbContext</code>-t megh\u00edvni.</p> Wireup.cs<pre><code>using BookShop.Bll.Mappings;\nusing BookShop.Bll.Services;\nusing BookShop.Bll.ServicesInterfaces;\nusing BookShop.Dal;\nusing Microsoft.Extensions.Configuration;\nusing Microsoft.Extensions.DependencyInjection;\n\nnamespace BookShop.Bll;\n\npublic static class Wireup\n{\n    public static IServiceCollection AddBllServices(this IServiceCollection services, IConfiguration configuration)\n    {\n        // DB Context regisztr\u00e1l\u00e1sa a DI containerbe.\n        services.AddBookShopDbContext(configuration);\n\n        // AutoMapper regisztr\u00e1l\u00e1sa a DI containerbe.\n        services.AddAutoMapper(\n                cfg =&gt;\n                {\n                    cfg.LicenseKey = configuration.GetRequiredSection(\"AutoMapper\").GetValue&lt;string&gt;(\"LicenseKey\");\n                }, typeof(BookProfile));\n\n        // Register Bll Servies\n        services.AddScoped&lt;IBookService, BookService&gt;();\n        services.AddScoped&lt;ICategoryService, CategoryService&gt;();\n\n        return services;\n    }\n}\n</code></pre> </li> </ol>"},{"location":"seminar/2%20-%20Projekt%20struktura/#console-app-letrehozasa","title":"Console App l\u00e9trehoz\u00e1sa","text":"<ol> <li>Adjunk a solution-hoz egy Console App-ot <code>BookShop.ConsoleApp</code> n\u00e9vvel.</li> <li>Adjunk referenci\u00e1t a <code>BookShop.Bll</code> projektre.</li> <li>Ahhoz, hogy be tudjuk regisztr\u00e1lni az AutoMappert \u00e9s az adatb\u00e1zis contextust a <code>Program.cs</code> f\u00e1jlt ki kell eg\u00e9sz\u00edteni, mert alap\u00e9rtelmez\u00e9s szerint nincs benne olyan k\u00f3dr\u00e9szlet ami appsettings.json-t fel tudn\u00e1 olvasni, illetve DI kont\u00e9nere sincs.</li> <li>Adjuk hozz\u00e1 a <code>BookShop.ConsoleApp</code> projekthez a <code>Microsoft.Extensions.Hosting</code> NuGet package-et. Ezzel tudunk majd l\u00e9trehozni egy <code>HostApplicationBuilder</code>-t, amibe be tudjuk regisztr\u00e1lni a szolg\u00e1ltat\u00e1sainkat \u00e9s kezelni tudja az <code>appsetting.json</code> f\u00e1jlt.</li> <li> <p>Adjunk a projekthez egy \u00faj JSON t\u00edpus\u00fa f\u00e1jlt <code>appsettings.json</code> n\u00e9vvel, majd \u00e1ll\u00edtsuk be a f\u00e1jl tulajdons\u00e1gai k\u00f6z\u00f6tt (appsettings.json jobb klikk \u2192 Properties), hogy ha m\u00f3dosul m\u00e1solja \u00e1t az output k\u00f6nyvt\u00e1rba</p> <ul> <li>Copy To Output Directory: Copy if newer.</li> </ul> Seg\u00edts\u00e9g - appsettings.json hozz\u00e1ad\u00e1sa <p></p> <p>appsettings.json f\u00e1jl hozz\u00e1ad\u00e1sa</p> <p></p> <p>appsettings.json ker\u00fclj\u00f6n be az outputba.</p> </li> <li> <p>Adjuk hozz\u00e1 az al\u00e1bbi tartalmat az <code>appsettings.json</code> f\u00e1jlhoz. A LicenseKey-hez azt az AutoMapper-t\u0151l kapott licensz kulcsot kell bem\u00e1solni.</p> appsettings.json<pre><code>{\n    \"ConnectionStrings\": {\n    \"DefaultConnection\": \"Data Source=.;Initial Catalog=BookShopDb;Integrated Security=True;TrustServerCertificate=True\"\n    },\n\n    \"AutoMapper\": {\n    \"LicenseKey\": \"Nem tessz\u00fck ide a licensz kulcsot, mert az titok\"\n    }\n}\n</code></pre> </li> <li> <p>A licensz kulcs egy v\u00e9dend\u0151 titok, \u00edgy azt nem szerencs\u00e9s beletenni az appsettings.json f\u00e1jlba, mert akkor felker\u00fcl a verzi\u00f3kezel\u0151 rendszerbe \u00e9s m\u00e1s is el\u00e9rheti. Ilyen esetben a megold\u00e1s, hogy a lok\u00e1lis user secret-be tessz\u00fck ezt az \u00e9rt\u00e9kel, \u00e9s az alkalmaz\u00e1s majd onnan olvassa ki.</p> </li> <li> <p>Adjuk hozz\u00e1 a user secret-et a <code>BookShop.ConsoleApp</code> projekthez. Projekten jobb klikk -&gt; Manage User Secrets.</p> Seg\u00edts\u00e9g - User secrets kezel\u00e9se <p></p> <p>Felhaszn\u00e1l\u00f3i titkok kezel\u00e9se</p> </li> <li> <p>Amikor az alkalmaz\u00e1s beolvassa az <code>appsettings.json</code> f\u00e1jlt azt k\u00f6vet\u0151en beolvassa a secret-ben t\u00e1rolt adatokat is (csak Development m\u00f3dban), \u00e9s azzal fel\u00fcl\u00edrja az <code>appsettings.json</code>. Teh\u00e1t egyszer\u0171en \u00e1t kell m\u00e1solni az <code>AutoMapper</code> szekci\u00f3t a secret-be.</p> secrets.json<pre><code>{\n    \"AutoMapper\": {\n        \"LicenseKey\": \"Ide j\u00f6n a licenszkulcs\"\n    }\n}    \n</code></pre> </li> <li> <p>Ha meg szeretn\u00e9nk tal\u00e1lni a <code>usersecrets.json</code> akkor az <code>%APPDATA%\\Microsoft\\UserSecrets\\&lt;user_secrets_id&gt;</code> k\u00f6nyvt\u00e1rban kell keresni, nem a projekt vagy solution alatt. Fontos, hogy ez a f\u00e1jl nincs titkos\u00edtva, viszont nem a k\u00f3db\u00e1zis r\u00e9sze, \u00edgy nem ker\u00fcl fel a verzi\u00f3kezel\u0151be se. A user secret egyedi azonos\u00edt\u00f3j\u00e1t, ami egy GUID a projekt f\u00e1jlban tal\u00e1ljuk meg a <code>UserSecretId</code> tagben.</p> Hol van a usersecrets.json f\u00e1jl? <p></p> <p>User secret f\u00e1jl</p> </li> <li> <p>M\u00e1r csak annyi dolgunk van, hogy be\u00e1ll\u00edtsuk, hogy Development m\u00f3dban induljon el az alkalmaz\u00e1s. Ehhez a <code>DOTNET_ENVIRONMENT</code> k\u00f6rnyezeti v\u00e1ltoz\u00f3t kell <code>Development</code>-re \u00e1ll\u00edtani. Ennek a legegyszer\u0171bb m\u00f3dja, hogy l\u00e9trehozunk egy <code>launchSettings.json</code> f\u00e1jlt \u00e9s ott megadjuk. A projekt tulajdons\u00e1gi k\u00f6z\u00f6tt keress\u00fck meg a Debug r\u00e9szt \u00e9s onnan nyissuk meg a debug launch profile UI-t \u00e9s ott az Environment variables al\u00e1 be is tudjuk m\u00e1solni a Name-nek a <code>DOTNET_ENVIRONMENT</code> a Value-nak pedig a <code>Development</code> \u00e9rt\u00e9ket.</p> Launch settings profile <p></p> <p>Launch settings profile megnyit\u00e1sa \u00e9s k\u00f6rnyezeti v\u00e1ltoz\u00f3 be\u00e1ll\u00ed\u00e1sa</p> </li> <li> <p>Ha mindent j\u00f3l csin\u00e1ltunk a solution explorer ablakban a projekt Properties mapp\u00e1j\u00e1ban meg is jelenik a <code>lauchSettings.json</code> f\u00e1jl, \u00edgy a k\u00e9s\u0151bbiekben egyszer\u0171en itt tudjuk szerkeszteni.</p> A l\u00e9trej\u00f6tt ind\u00edt\u00e1si profil <p></p> <p>A l\u00e9trej\u00f6tt launchSettings.json f\u00e1jl.</p> </li> <li> <p>K\u00e9sz\u00edts\u00fck el a <code>Program.cs</code> k\u00f3dj\u00e1t is, amiben hozzuk l\u00e9tre a HostApplicationBuilder p\u00e9ld\u00e1nyunkat a <code>Host.CreateApplicationBuilder</code> seg\u00edts\u00e9g\u00e9vel. Ez fel fogja olvasni az <code>appsettings.json</code> f\u00e1jlunkban \u00e9s a userSecrets.json-ban l\u00e9v\u0151 adatokat. Illetve h\u00edvjuk meg a kor\u00e1bban elk\u00e9sz\u00edtett <code>AddBllServices</code> met\u00f3dusunkat is.</p> Program.cs<pre><code>using BookShop.Bll;\nusing Microsoft.EntityFrameworkCore;\nusing Microsoft.Extensions.DependencyInjection;\nusing Microsoft.Extensions.Hosting;\n\nConsole.WriteLine(\"Application starting...\");\n\nvar builder = Host.CreateApplicationBuilder(args);\n\nConsole.WriteLine(builder.Environment.EnvironmentName);\n\n// TODO: Register BLL services, DbContext and Automapper.\nbuilder.Services.AddBllServices(builder.Configuration);\n\n// Host ford\u00edt\u00e1sa\nvar app = builder.Build();\n\n// L\u00e9trehozunk egy \u00faj scope-ot \u00e9s abb\u00f3l k\u00e9rj\u00fck le a sz\u00fcks\u00e9ges oszt\u00e1ly p\u00e9ld\u00e1nyokat\nusing (var scope = app.Services.CreateScope())\n{\n    scope.ServiceProvider.GetRequiredService&lt;BookShop.Dal.BookShopDbContext&gt;().Database.Migrate();\n\n    // TODO Call code from test service\n}\n\nawait app.RunAsync();\n</code></pre> </li> <li> <p>Majd ind\u00edtsuk is el az alkalmaz\u00e1st, hogy addig fusson am\u00edg nem nyomjuk le a Ctrl+C -t.</p> </li> <li> <p>Figyelj\u00fck meg a fenti k\u00f3dban, hogy a v\u00e9g\u00e9n megh\u00edvjuk az adatb\u00e1zis migr\u00e1ci\u00f3t. Ha ez a sor benne marad a k\u00f3dban, akkor nem kell sohasem futtatni az <code>Update-Database</code> parancsot, mert ez a k\u00f3dsor le fogja futtatni azokat a migr\u00e1ci\u00f3kat, amik m\u00e9g nem futottak. \u00c9rdemes azonban megjegyezni, hogy Production k\u00f6rnyezetben nem szeretj\u00fck ezt az automatikus megold\u00e1st, mert \u00e1ltal\u00e1ban a migr\u00e1ci\u00f3k lefuttat\u00e1s\u00e1hoz magasabb jogosults\u00e1g sz\u00fcks\u00e9ges mint az alkalmaz\u00e1s norm\u00e1l futtat\u00e1s\u00e1hoz.</p> </li> <li>Ahhoz, hogy a migr\u00e1ci\u00f3 le tudjon futni, l\u00e9tre kell hozni egy k\u00fcl\u00f6n szk\u00f3pot a szolg\u00e1ltat\u00e1sokhoz (AddScoped-k\u00e9nt adtuk hozz\u00e1), \u00e9s abban a szk\u00f3pban fogjuk megtal\u00e1lni a <code>GetRequiredService</code> seg\u00edts\u00e9g\u00e9vel.</li> <li>Ha elind\u00edtjuk az alkalmaz\u00e1st azt fogjuk l\u00e1tni, hogy val\u00f3ban ellen\u0151rizni, hogy minden EF migr\u00e1ci\u00f3 lefutott-e, ezt a konzolra napl\u00f3zott SQL logokb\u00f3l l\u00e1thatjuk.</li> </ol>"},{"location":"seminar/2%20-%20Projekt%20struktura/#irequestservice-keszitese","title":"IRequestService k\u00e9sz\u00edt\u00e9se","text":"<p>Sz\u00e1mos esetben van arra sz\u00fcks\u00e9g\u00fcnk a BLL-ben, vagy ak\u00e1r a DAL r\u00e9tegben is, hogy el\u00e9rj\u00fck az aktu\u00e1lis felhaszn\u00e1l\u00f3 ID-j\u00e1t, vagy ak\u00e1r a nev\u00e9t. Ezt \u00fagy \u00e9rdemes megval\u00f3s\u00edtani, hogy k\u00e9sz\u00edt\u00fcnk egy IRequestContext interf\u00e9szt, aminek a megval\u00f3s\u00edt\u00e1s\u00e1t a Web-es r\u00e9tegre b\u00edzzuk, viszont az interf\u00e9szen kereszt\u00fcl mindent el tudunk k\u00e9sz\u00edteni.</p> <ol> <li> <p>A RequestContext-et t\u00f6bb helyen szeretn\u00e9nk haszn\u00e1lni \u00e9s a k\u00f6rk\u00f6r\u00f6s referenci\u00e1kat elker\u00fclend\u0151 hozzunk l\u00e9tre egy <code>BookShop.Server.Abstraction</code> projektet (class library) \u00e9s abban egy <code>Context</code> mapp\u00e1t, ami az al\u00e1bbi k\u00f3ddal hozzuk l\u00e9tre az <code>IRequestContext</code> interf\u00e9szt.</p> IRequestService.cs<pre><code>using System.Security.Claims;\n\nnamespace BookShop.Server.Abstraction.Context;\n\n/// &lt;summary&gt;\n/// Gets the request's sender's request's identifier and user information.\n/// &lt;/summary&gt;\npublic interface IRequestContext\n{\n    string? RequestId { get; }\n\n    ClaimsIdentity? CurrentUser { get; }\n\n    public int? UserId { get; }\n}\n</code></pre> </li> <li> <p>A k\u00e9s\u0151bbiekben a <code>CommentService</code> \u00e9s <code>RatingService</code>-ben szeretn\u00e9nk ezt haszn\u00e1lni, hogy a hozz\u00e1sz\u00f3l\u00e1st \u00e9s \u00e9rt\u00e9kel\u00e9s mindig az aktu\u00e1lis felhaszn\u00e1l\u00f3 nev\u00e9ben t\u00f6rt\u00e9njen. Ehhez csak annyi lesz a dolgunk, hogy \u00e1tadjuk a konstruktornak param\u00e9terben \u00e9s a userId-t a requestContext-b\u0151l olvassuk ki. Illetve a startup projektbe beregisztr\u00e1ljuk hozz\u00e1 a megfelel\u0151 implement\u00e1ci\u00f3t.</p> </li> <li>A fenti megold\u00e1st \u00e9rdemes m\u00e1r a projekt elej\u00e9n haszn\u00e1lni \u00edgy mock-olva a bel\u00e9pett felhaszn\u00e1l\u00f3t.</li> </ol>"},{"location":"seminar/2%20-%20Projekt%20struktura/#testmycode-szolgaltatas","title":"TestMyCode szolg\u00e1ltat\u00e1s","text":"<ol> <li> <p>Ahhoz, hogy a mi k\u00f3dunkat is le tudjuk tesztelni egyszer\u0171en, hozzunk l\u00e9tre egy <code>TestMyCode</code> oszt\u00e1lyt, melynek konstruktora megkapja az <code>IBookService</code> \u00e9s <code>ICategoryService</code> interf\u00e9szeket \u00e9s implement\u00e1l k\u00e9t met\u00f3dust <code>ListBooksAsync</code> \u00e9s <code>ListCategoriesAsync</code> melyek megh\u00edvj\u00e1k az egyes szolg\u00e1ltat\u00e1sok megfelel\u0151 met\u00f3dus\u00e1t \u00e9s a konzolra ki\u00edrj\u00e1k a visszakapott list\u00e1k elemet.</p> TestMyCode.cs<pre><code>using BookShop.Bll.ServicesInterfaces;\n\nnamespace BookShop.ConsoleApp;\n\npublic class TestMyCode(IBookService bookService, ICategoryService categoryService)\n{\n    public async Task ListBooksAsync()\n    {\n        var books = await bookService.GetBooksAsync();\n\n        foreach (var book in books)\n        {\n            Console.WriteLine($\"{book.Id}: {book.Title} - {book.Author} ({book.PublishYear})\");\n        }\n    }\n\n    public async Task ListCategoriesAsync()\n    {\n        var categories = await categoryService.GetCategoryTreeAsync();\n\n        foreach (var category in categories)\n        {\n            Console.WriteLine($\"{new string(' ', (category.Level - 1) * 2)}- {category.Name}  (Level:   {category.Level})\");\n        }\n    }\n}\n</code></pre> </li> <li> <p>M\u00e1r csak annyi dolgunk van, hogy a <code>Program.cs</code>-b\u0151l megh\u00edvjuk a k\u00e9t met\u00f3dust, viszont mivel manu\u00e1lisan nem tudjuk ezt az oszt\u00e1ly p\u00e9ld\u00e1nyos\u00edtani, \u00edgy ezt is hozz\u00e1 kell adni a Services-hez \u00e9s onnan kell a p\u00e9ld\u00e1nyt elk\u00e9rni.</p> Program.cs<pre><code>// Register BLL services, DbContext and Automapper.\nbuilder.Services.AddBllServices(builder.Configuration);\nbuilder.Services.AddScoped&lt;TestMyCode&gt;();\n\n// Host ford\u00edt\u00e1sa\nvar app = builder.Build();\n\n// L\u00e9trehozunk egy \u00faj scope-ot \u00e9s abb\u00f3l k\u00e9rj\u00fck le a sz\u00fcks\u00e9ges oszt\u00e1ly p\u00e9ld\u00e1nyokat\nusing (var scope = app.Services.CreateScope())\n{\n    scope.ServiceProvider.GetRequiredService&lt;BookShop.Dal.BookShopDbContext&gt;().Database.Migrate();\n\n    var testMyCodeService = scope.ServiceProvider.GetRequiredService&lt;TestMyCode&gt;();\n\n    await testMyCodeService.ListBooksAsync();\n    await testMyCodeService.ListCategoriesAsync();\n}\n\n\nawait app.RunAsync();\n</code></pre> </li> <li> <p>Ha \u00edgy elind\u00edtjuk az alkalmaz\u00e1st, akkor l\u00e1that\u00f3 lesz, hogy t\u00e9nyleg megkapjuk az adatokat az adatb\u00e1zisb\u00f3l, s\u0151t a futtatott SQL k\u00f3dot is l\u00e1tjuk.</p> </li> </ol>"},{"location":"seminar/2%20-%20Projekt%20struktura/#aspnet-identity-tablak-letrehozasa","title":"ASP.NET Identity t\u00e1bl\u00e1k l\u00e9trehoz\u00e1sa","text":"<p>Minden alkalmaz\u00e1sban sz\u00fcks\u00e9g van felhaszn\u00e1l\u00f3kezel\u00e9sre. Ehhez kiv\u00e1l\u00f3 t\u00e1mogat\u00e1st az ASP.NET Identity, ami t\u00f6bb szinten ny\u00fajt seg\u00edts\u00e9get. Adatb\u00e1zis szinten l\u00e9tre tudja hozni a t\u00e1bl\u00e1kat \u00e9s a User entit\u00e1st a n\u00e9lk\u00fcl, hogy a magasabb szint\u0171 szolg\u00e1ltat\u00e1sait ig\u00e9nybe venn\u00e9nk.</p> <ol> <li>Adjuk hozz\u00e1 a <code>BookShop.Dal</code> projekthez a <code>Microsoft.AspNetCore.Identity.EntityFrameworkCore</code> NuGet package-et. Ez sz\u00fcks\u00e9ges ahhoz, hogy a User entit\u00e1sokat le tudjuk sz\u00e1rmaztatni az IdentityUser oszt\u00e1lyb\u00f3l, illetve a DbContext-et az IdentityDbContext-b\u0151l.</li> <li> <p>Az <code>Entities</code> mapp\u00e1ba hozzuk l\u00e9tre az <code>ApplicationUser</code> entit\u00e1st. Az oszt\u00e1ly sz\u00e1rmazzon az <code>IdentityUser&lt;int&gt;</code>-b\u0151l. Ezzel megadjuk, hogy a felhaszn\u00e1l\u00f3 egyedi azonos\u00edt\u00f3ja <code>int</code> legyen \u00e9s a sz\u00e1rmaz\u00e1s miatt beleker\u00fclnek a legfontosabb tulajdons\u00e1gok az oszt\u00e1lyba.</p> ApplicationUser.cs<pre><code>using Microsoft.AspNetCore.Identity;\n\nnamespace BookShop.Dal.Entities;\n\npublic class ApplicationUser : IdentityUser&lt;int&gt;\n{\n    public string DisplayName { get; set; } = null!;\n}\n</code></pre> </li> <li> <p>Ezt k\u00f6vet\u0151en m\u00f3dos\u00edtsuk a <code>BookShopDbContext</code>-\u00fcnket, hogy az <code>IdentityDbContext&lt;&gt;</code>-b\u0151l sz\u00e1rmazzon.</p> BookShopDbContext.cs<pre><code>using BookShop.Dal.Entities;\nusing Microsoft.AspNetCore.Identity;\nusing Microsoft.AspNetCore.Identity.EntityFrameworkCore;\nusing Microsoft.EntityFrameworkCore;\n\nnamespace BookShop.Dal;\n\npublic class BookShopDbContext(DbContextOptions options) : IdentityDbContext&lt;ApplicationUser, IdentityRole&lt;int&gt;, int&gt;(options)\n{\n    public DbSet&lt;Book&gt; Books { get; set; }\n    public DbSet&lt;Category&gt; Categories { get; set; }\n\n    ...\n}\n</code></pre> </li> <li> <p>Adjuk hozz\u00e1 a DB modellhez is, az ApplicationUser-t \u00e9s jelen\u00edts\u00fck meg az \u0151soszt\u00e1ly\u00e1t is, \u00e9s \u00edgy m\u00e1r l\u00e1that\u00f3 is, hogy az \u00f6sszes fontos tulajdons\u00e1got meg\u00f6r\u00f6kli.</p> <p></p> <p>DB diagram ApplicationUser-rel</p> </li> <li> <p>Majd hozzuk l\u00e9tre az \u00faj migr\u00e1ci\u00f3t, de ehhez a Startup projektet \u00e1ll\u00edtsuk \u00e1t a <code>BookShop.Dal</code>-ra \u00e9s futtassuk is le.</p> <pre><code>Add-Migration AddIndentity\n\nUpdate-Database\n</code></pre> </li> <li> <p>Ez ut\u00e1n m\u00e1r l\u00e1that\u00f3ak az Identity-s t\u00e1bl\u00e1k is az adatb\u00e1zisban. Figyelj\u00fck meg, hogy az <code>AspNetUsers</code> t\u00e1bl\u00e1ba beker\u00fclt az <code>ApplicationUser</code> entit\u00e1sban l\u00e9v\u0151 <code>DisplayName</code> mez\u0151 is.</p> <p></p> <p>L\u00e9trehozott ASP.NET Identity t\u00e1bl\u00e1k.</p> </li> </ol>"},{"location":"seminar/2%20-%20Projekt%20struktura/#teljes-dal-reteg","title":"Teljes DAL r\u00e9teg","text":"<p>Ezek alapj\u00e1n m\u00e1r el tudn\u00e1nk k\u00e9sz\u00edteni a teljes adatel\u00e9r\u00e9si r\u00e9teget, de mivel az sok id\u0151t vesz ig\u00e9nybe ez\u00e9rt az a k\u00f6vetkez\u0151 labor kiindul\u00f3 anyag\u00e1ba m\u00e1r benne lesz.</p>"},{"location":"seminar/3%20-%20Backend%20services/","title":"3. Kiindul\u00f3 Backend","text":""},{"location":"seminar/3%20-%20Backend%20services/#3-kiindulo-backend","title":"3. Kiindul\u00f3 Backend","text":""},{"location":"seminar/3%20-%20Backend%20services/#kiindulo-alkalmazas-letoltese","title":"Kiindul\u00f3 alkalmaz\u00e1s let\u00f6lt\u00e9se","text":"<p>Az el\u0151z\u0151 laboron \u00e1ttekintett\u00fck, hogyan lehet a Backend oldalon a adatel\u00e9r\u00e9si r\u00e9teget, \u00fczleti logikai r\u00e9teget \u00e9s a DTO-kat l\u00e9trehozni. A f\u00f6l\u00f6sleges munka cs\u00f6kkent\u00e9se \u00e9rdek\u00e9ben a teljes Backend k\u00f3dot tartalmazza a kiindul\u00f3 projekt.</p> <ol> <li>A kiindul\u00f3 BLL \u00e9s DAL r\u00e9teget tartalmaz\u00f3 kiindul\u00f3 k\u00f3dot a Moodle-b\u0151l ASP.NET Razor Page invite link vagy k\u00f6zvetlen\u00fcl a Github classroom-b\u00f3l is le lehet t\u00f6lteni.</li> <li>R\u00e9szletes \u00fatmutat\u00f3 a kiindul\u00f3 k\u00f3d let\u00f6lt\u00e9s\u00e9r\u0151l \u00e9s a bead\u00e1sr\u00f3l a Feladatok bead\u00e1sa (GitHub) oldalon tal\u00e1lsz inform\u00e1ci\u00f3t.</li> <li>A repo let\u00f6lt\u00e9se ut\u00e1n k\u00e9sz\u00edtsd egy \u00faj \u00e1gat <code>megoldas</code> n\u00e9vvel \u00e9s abba dolgozz!</li> </ol>"},{"location":"seminar/3%20-%20Backend%20services/#kiindulo-projekt-attekintese","title":"Kiindul\u00f3 projekt \u00e1ttekint\u00e9se","text":"<p>A projekt t\u00f6bb r\u00e9teg\u0171 architekt\u00far\u00e1t haszn\u00e1l \u00edgy a projekt fel\u00e9p\u00edt\u00e9se az al\u00e1bbi</p> <ul> <li>BookShop.Web: Ez a r\u00e9teg m\u00e9g nincs meg, ezt fogjuk a k\u00e9s\u0151bbiekben l\u00e9trehozni (ASP.NET Razor Page, ASP.NET MVC, Blazor Web App)</li> <li>BookShop.ConsoleApp: Egy ideiglenes FrontEnd alkalmaz\u00e1s, hogy ki tudjuk pr\u00f3b\u00e1lni az alkalmaz\u00e1st.</li> <li>BookShop.Bll: \u00dczleti szolg\u00e1ltat\u00e1sok, azok interf\u00e9szei \u00e9s az AutoMapper profilok ker\u00fcltek ebbe a projektbe. Az egyes szolg\u00e1ltat\u00e1sokban k\u00e9rdezz\u00fck le az adatb\u00e1zisb\u00f3l a sz\u00fcks\u00e9ges adatokat \u00e9s AutoMapperrel alak\u00edtjuk \u00e1t DTO-ra, amit a h\u00edv\u00f3 r\u00e9tegnek visszaadnak az egyes szolg\u00e1ltat\u00e1sok.</li> <li>BookShop.Dal: Az adatb\u00e1zis entit\u00e1sok, entit\u00e1s konfigur\u00e1ci\u00f3k, adatb\u00e1zis kontextus \u00e9s a migr\u00e1ci\u00f3k ker\u00fcltek ebbe a projektbe.</li> <li>BookShop.Transfer: A DTO-kat itt hozzuk l\u00e9tre, \u00e9s a k\u00e9s\u0151bbiekben a valid\u00e1ci\u00f3s szab\u00e1lyok is ide ker\u00fclnek. Az\u00e9rt kapott k\u00fcl\u00f6n projektet, hogy a Blazor alkalmaz\u00e1s k\u00e9sz\u00edt\u00e9sekor a kliensre ne kelljen legener\u00e1lni a DTO-kat, hanem adhassunk erre a projektre referenci\u00e1t.</li> <li>BookShop.Server.Abstraction: A request context kezel\u00e9se miatt egy k\u00fcl\u00f6n projekt. Jelenleg csak az <code>IRequestContext</code> interf\u00e9szt tartalmazza. Az implement\u00e1ci\u00f3t majd a Webes projektben val\u00f3s\u00edtjuk meg, \u00e9s DI seg\u00edts\u00e9g\u00e9vel rendelj\u00fck hozz\u00e1 az interf\u00e9szhez. Az interf\u00e9szen kereszt\u00fcl a BLL \u00e9s DAL r\u00e9teg tudja haszn\u00e1lni, \u00e9s \u00edgy el tudjuk ker\u00fclni a k\u00f6rk\u00f6r\u00f6s referenci\u00e1kat.</li> </ul>"},{"location":"seminar/3%20-%20Backend%20services/#bookshopdal","title":"BookShop.Dal","text":"<p>A kiindul\u00f3 alkalmaz\u00e1s m\u00e1r tartalmazza a teljes Entity Framework modell-t bele\u00e9rte a felhaszn\u00e1l\u00f3 kezel\u00e9shez sz\u00fcks\u00e9ges t\u00e1bl\u00e1kat is.</p>"},{"location":"seminar/3%20-%20Backend%20services/#bookshopdbcontext","title":"BookShopDbContext","text":"<p>Az adatb\u00e1zis kontextus, melyben defini\u00e1ljuk a t\u00e1bl\u00e1kat, \u00e9s lefuttatjuk az entit\u00e1sok konfigur\u00e1ci\u00f3j\u00e1t \u00e9s az \u0151s adatok felt\u00f6lt\u00e9s\u00e9t. Mivel felhaszn\u00e1l\u00f3 kezel\u00e9st is szeretn\u00e9nk tenni az alkalmaz\u00e1sban (ASP.NET Identity) ez\u00e9rt m\u00e1r a kiindul\u00f3 k\u00f3dban az adatb\u00e1zis szint be\u00e1ll\u00edt\u00e1sok elk\u00e9sz\u00fcltek.</p> <ul> <li><code>ApplicationUser</code>  oszt\u00e1ly a felhaszn\u00e1l\u00f3hoz, amit az <code>IdentityUser&lt;int&gt;</code>-b\u0151l sz\u00e1rmazik. A kulcs <code>int</code> lesz.</li> <li>A <code>BookShopDbContext</code> az <code>IdentityDbContext&lt;ApplicationUser, IdentityRole&lt;int&gt;, int&gt;</code>-b\u0151l sz\u00e1rmazik.</li> <li>Az <code>OnModelCreating</code> el\u0151sz\u00f6r a base oszt\u00e1ly <code>OnModelCreating</code>-j\u00e9t h\u00edvja, hogy az Identity t\u00e1bl\u00e1k l\u00e9trej\u00f6jjenek.</li> <li>Megh\u00edvjuk az \u00f6sszes entit\u00e1s konfigur\u00e1ci\u00f3j\u00e1t, ami az assembly-n bel\u00fcl tal\u00e1lhat\u00f3.</li> <li>Felt\u00f6ltj\u00fck az \u0151s adatokat.</li> </ul> BookShopDbContext.cs<pre><code>namespace BookShop.Dal;\n\npublic class BookShopDbContext(DbContextOptions options) : IdentityDbContext&lt;ApplicationUser, IdentityRole&lt;int&gt;, int&gt;(options)\n{\n    // Define DbSet properties for each entity in the model.\n    public DbSet&lt;Address&gt; Addresses { get; set; }\n    // ...\n\n    protected override void OnModelCreating(ModelBuilder modelBuilder)\n    {\n        // Create Identity configurations for Identity tables\n        base.OnModelCreating(modelBuilder);\n\n        // Apply configurations from assembly\n        modelBuilder.ApplyConfigurationsFromAssembly(typeof(BookShopDbContext).Assembly);\n\n        // Seed initial data\n        SeedData(modelBuilder);\n    }\n\n    private static void SeedData(ModelBuilder modelBuilder)\n    {\n        // ...\n    }\n}\n</code></pre> <p>Az entit\u00e1sok csak a t\u00e1bl\u00e1kban l\u00e9v\u0151 mez\u0151ket \u00e9s t\u00edpusait tartalmazz\u00e1k. Nem attribut\u00e1ltuk fel, hanem a konfigur\u00e1ci\u00f3kat k\u00fcl\u00f6n <code>IEntityTypeConfiguration</code>-ben adtuk meg. Itt defini\u00e1ljuk a t\u00e1bla kulcsokat, maxim\u00e1lis mez\u0151 hosszt, \u00e9s a idegen kulcsokat. Itt hoztuk l\u00e9tre a <code>SeedData</code> met\u00f3dust is, ami az \u0151s adatokat fel tudja t\u00f6lteni.</p> CategoryEntityConfiguration.cs<pre><code>internal class CategoryEntityConfiguration : IEntityTypeConfiguration&lt;Category&gt;\n{\n    public void Configure(EntityTypeBuilder&lt;Category&gt; builder)\n    {\n        builder.HasKey(e =&gt; e.Id);\n\n        builder.Property(e =&gt; e.Name).HasMaxLength(50);\n\n        builder.HasOne(e =&gt; e.ParentCategory)\n               .WithMany(e =&gt; e.ChildCategories)\n               .HasForeignKey(e =&gt; e.ParentCategoryId)\n               .OnDelete(DeleteBehavior.NoAction);\n    }\n\n    public static void SeedData(EntityTypeBuilder&lt;Category&gt; builder)\n    { \n    }\n}\n</code></pre> <p>Fontos, hogy az \u0151s adat felt\u00f6lt\u00e9sn\u00e9l fix ID-kat haszn\u00e1ljunk \u00e9s csak determinisztikus adat legyen benne. A megold\u00e1s l\u00e9nyegi r\u00e9sze a <code>HasData</code> ami besz\u00farja az adatb\u00e1zisba az adatokat, ha m\u00e9g nem l\u00e9tezik. \u00c9rdemes a <code>ApplicationUserEntityConfiguration</code> k\u00f3dj\u00e1t megn\u00e9zni, mert itt felhaszn\u00e1l\u00f3kat \u00e9s szerepk\u00f6r\u00f6ket seed-el\u00fcnk, hogy lehessen l\u00e9trehozni p\u00e9ld\u00e1ul kommentet is, ahol a l\u00e9trehoz\u00f3 felhaszn\u00e1l\u00f3 ID-ja sz\u00fcks\u00e9ges. Az\u00e9rt, hogy az adatok determinisztikusak legyenek p\u00e9ld\u00e1ul a felhaszn\u00e1l\u00f3 jelszav\u00e1nak hash k\u00f3dja fixen be\u00e9getett (egy\u00e9bk\u00e9nt random-ot tartalmazna ha gener\u00e1ln\u00e1nk) illetve a security / concurrency stamp-ek is fixek.</p>"},{"location":"seminar/3%20-%20Backend%20services/#dbcontextfactory","title":"DbContextFactory","text":"<p>Az\u00e9rt hoztuk l\u00e9tre, hogy \u00fagy is lehessen migr\u00e1ci\u00f3t k\u00e9sz\u00edteni \u00e9s futtatni, hogy nincs klasszikus startup projekt\u00fcnk, amibe regisztr\u00e1ltuk a DbContext-et. Teh\u00e1t csak a DAL projekt elegend\u0151 a migr\u00e1ci\u00f3k futtat\u00e1s\u00e1hoz. Azonban ez a megold\u00e1s csak addig fontos, am\u00edg nem hozunk l\u00e9tre startup projektet, \u00edgy az adatb\u00e1zis kapcsol\u00f3d\u00e1si sztringet beledr\u00f3toztuk a k\u00f3dba.</p> BookShopDbContextFactory.cs<pre><code>using Microsoft.EntityFrameworkCore;\nusing Microsoft.EntityFrameworkCore.Design;\n\nnamespace BookShop.Dal;\ninternal class BookShopDbContextFactory : IDesignTimeDbContextFactory&lt;BookShopDbContext&gt;\n{\n    public BookShopDbContext CreateDbContext(string[] args)\n    {\n        var optionsBuilder = new DbContextOptionsBuilder&lt;BookShopDbContext&gt;();\n        optionsBuilder.UseSqlServer(\"Data Source=.;Initial Catalog=BookShopDb2;Integrated Security=True;TrustServerCertificate=True\");\n\n        return new BookShopDbContext(optionsBuilder.Options);\n    }\n}\n</code></pre>"},{"location":"seminar/3%20-%20Backend%20services/#aspnet-identity-beallitasok","title":"ASP.NET Identity be\u00e1ll\u00edt\u00e1sok","text":"<p>A <code>BookShop.Dal</code> projekt m\u00e1r tartalmazza a <code>Microsoft.AspNetCore.Identity.EntityFrameworkCore</code> NuGet csomagot.</p> Megfelel\u0151 verzi\u00f3 haszn\u00e1lata a teljes solutionben <p>Fontos, hogy a megfelel\u0151 verzi\u00f3t haszn\u00e1ljuk a solution minden projektj\u00e9ben. A verzi\u00f3k leg\u00f6rd\u00fcl\u0151j\u00e9ben azt a verzi\u00f3t haszn\u00e1ljuk, ami a Web projekt (startup) f\u00fcgg\u0151s\u00e9gei k\u00f6z\u00f6tt megtal\u00e1lhat\u00f3val megegyezik, vagy friss\u00edts\u00fck a solution-ben tal\u00e1lhat\u00f3 \u00f6sszes Entity Framework csomagot. A friss\u00edt\u00e9st legegyszer\u0171bben \u00fagy tehetj\u00fck meg, hogy a Solution-\u00f6n jobb click Manage NuGet packages for solution \u00e9s ott az Updates f\u00fclet v\u00e1lasztva jel\u00f6lj\u00fck ki a friss\u00edtend\u0151 csomagokat, majd kattintsunk az Update gombra. Ha r\u00e1kattintunk egy csomagra a jobb oldalon l\u00e1that\u00f3, hogy melyik projekt melyik verzi\u00f3t haszn\u00e1lja \u00e9ppen. Ha ezek k\u00f6z\u00f6tt elt\u00e9r\u00e9s van akkor azt a Consolidate f\u00fcl\u00f6n is l\u00e1tn\u00e1nk k\u00fcl\u00f6n kiemelve.</p> <ul> <li> <p>Az adatel\u00e9r\u00e9si r\u00e9tegben m\u00e1r be van \u00e1ll\u00edtva minden, ami sz\u00fcks\u00e9ges a felhaszn\u00e1l\u00f3kezel\u00e9shez</p> </li> <li> <p>Van saj\u00e1t <code>ApplicationUser</code> oszt\u00e1lyunk, amit az <code>IdentityUser&lt;int&gt;</code>-b\u0151l sz\u00e1rmazik. Az t\u00edpusparam\u00e9ter azt jelzi, hogy a felhaszn\u00e1l\u00f3 ID-ja <code>int</code> lesz, nem az alap\u00e9rtelmezett <code>string</code>.</p> </li> <li>Mivel a <code>DisplayName</code> tulajdons\u00e1g egy saj\u00e1t kieg\u00e9sz\u00edt\u00e9s \u00edgy r\u00e1ker\u00fclt a <code>[PersonalData]</code> attrib\u00fatumot. Ezzel lehet jelezni az ASP.NET Identity-nek, hogy ez a tulajdons\u00e1g szem\u00e9lyes adatnak min\u0151s\u00fcl (GDPR). A szem\u00e9lyes adatok kezel\u00e9s\u00e9n\u00e9l az ASP.NET t\u00f6bb t\u00e1mogat\u00e1st is ny\u00fajt. Pl: szem\u00e9lyes adatok t\u00f6rl\u00e9se (DeletePersonalData.cshtml), vagy a szem\u00e9lyes adatok let\u00f6lt\u00e9se (DownloadPersonalData.cshtml), mely megold\u00e1sok a <code>PersonalData</code> attrib\u00fatumon alapulnak.</li> <li> <p>Ezen fel\u00fcl a navigation property-ket is felvett\u00fck az <code>ApplicationUser</code>be.</p> ApplicationUser.cs<pre><code>using Microsoft.AspNetCore.Identity;\n\nnamespace BookShop.Dal.Entities;\n\npublic class ApplicationUser : IdentityUser&lt;int&gt;\n{\n    [PersonalData]\n    public string DisplayName { get; set; } = null!;\n\n    public virtual ICollection&lt;Comment&gt; Comments { get; set; } = [];\n    public virtual ICollection&lt;Rating&gt; Ratings { get; set; } = [];\n    public virtual ICollection&lt;UserAddress&gt; UserAddresses { get; set; } = [];\n    public virtual ICollection&lt;Order&gt; Orders { get; set; } = [];\n}\n</code></pre> </li> <li> <p>A <code>BookShopDbContext</code> a megfelel\u0151 <code>IdentityDbContext&lt;ApplicationUser, IdentityRole&lt;int&gt;, int&gt;</code>-b\u0151l sz\u00e1rmazik. Itt az els\u0151 t\u00edpusparam\u00e9ter a saj\u00e1t user oszt\u00e1lyunk, a m\u00e1sodik a szerepk\u00f6r oszt\u00e1lya, amib\u0151l nincs saj\u00e1t \u00edgy a be\u00e9p\u00edtettet haszn\u00e1ljuk int t\u00edpus\u00fa kulccsal. Az utols\u00f3 t\u00edpus param\u00e9ter pedig ism\u00e9t a (user \u00e9s role) kulcs t\u00edpusa. Hogy mi\u00e9rt kell k\u00fcl\u00f6n is megadni az j\u00f3 k\u00e9rd\u00e9s.</p> BookShopDbContext.cs<pre><code>public class BookShopDbContext(DbContextOptions options) \n    : IdentityDbContext&lt;ApplicationUser, IdentityRole&lt;int&gt;, int&gt;(options)\n{\n}\n</code></pre> </li> <li> <p>Fontos m\u00e9g kiemelni, hogy a <code>BookShopDbContext</code>-ben az <code>OnModelCreating</code> f\u00fcggv\u00e9nyben m\u00e1r meg kell h\u00edvni az \u0151soszt\u00e1ly <code>IdentityDbContext&lt;&gt;</code> <code>OnModelCreating</code>-j\u00e9t r\u00e1ad\u00e1sul legel\u0151sz\u00f6r, ugyanis ez hozza l\u00e9tre \u00e9s konfigur\u00e1lja az ASP.NET Identity t\u00e1bl\u00e1kat az adatb\u00e1zisban, amit ezut\u00e1n tudunk fel\u00fcldefini\u00e1lni (a konzekvens defin\u00edci\u00f3k pl. a Users t\u00e1bla megfeleltet\u00e9s kapcs\u00e1n egym\u00e1s ut\u00e1n megadva defini\u00e1lhat\u00f3k fel\u00fcl, az utols\u00f3 defin\u00edci\u00f3 jut \u00e9rv\u00e9nyre). Ez\u00e9rt h\u00edvjuk el\u0151sz\u00f6r a base <code>OnModelCreating</code>-j\u00e9t.</p> BookShopDbContext.cs<pre><code>protected override void OnModelCreating(ModelBuilder modelBuilder)\n{\n    base.OnModelCreating(modelBuilder);\n\n    // Apply configurations from assembly\n    modelBuilder.ApplyConfigurationsFromAssembly(typeof(BookShopDbContext).Assembly);\n\n    // Seed in the proper order.\n    SeedData(modelBuilder);\n}\n</code></pre> </li> <li> <p>Azt is megfigyelhetj\u00fck, hogy nem vett\u00fck fel k\u00fcl\u00f6n a Users, Roles, UserRoles, ... t\u00e1bl\u00e1kat a DbContext-be m\u00e9gis el\u00e9rj\u00fck \u0151ket, hiszen az \u0151soszt\u00e1ly <code>IdentityDbContext</code> defini\u00e1lja ezeket.</p> </li> </ul> Success <p></p> <p>Gener\u00e1lt Identity t\u00e1bl\u00e1k az adatb\u00e1zisban</p> <p>Az al\u00e1bbiakat \u00e9rdemes \u00e9szrevenn\u00fcnk:</p> <ul> <li>A felhaszn\u00e1l\u00f3 kiz\u00e1rhat\u00f3, ha t\u00f6bbsz\u00f6r helytelen jelsz\u00f3val pr\u00f3b\u00e1lkozik.</li> <li>A PasswordHash egyetlen mez\u0151ben t\u00e1rol\u00f3dik. Ez val\u00f3j\u00e1ban a mez\u0151 fel\u00e9ben a t\u00e9nylegesen salt-tal \u00e9s hash-sel titkos\u00edtott jelsz\u00f3t t\u00e1rolja, a mez\u0151 m\u00e1sodik fel\u00e9ben pedig a v\u00e9letlengener\u00e1lt salt \u00e9rt\u00e9ket.</li> <li>K\u00e9t faktoros authentik\u00e1ci\u00f3t t\u00e1mogat a rendszer telefonnal \u00e9s e-mail c\u00edmmel (a m\u00e1sodik faktor a tud\u00e1s mellett itt a birtokl\u00e1s, a harmadik a l\u00e9tez\u00e9s, jellemz\u0151en biometrikus azonos\u00edt\u00e1s).</li> <li>Konkurenciakezel\u00e9s miatt ConcurrencyStamp mez\u0151t l\u00e1thatunk a Role \u00e9s User entit\u00e1sokban, amik az optimista konkurenciakezel\u00e9st tesznek lehet\u0151v\u00e9.</li> <li>Harmadik f\u00e9l \u00e1ltali authentik\u00e1ci\u00f3hoz egy felhaszn\u00e1l\u00f3nak t\u00f6bb bel\u00e9p\u00e9si lehet\u0151s\u00e9ge lehet \u00e9s az \u00edgy \u00e9rkeztetett tokenek t\u00e1rol\u00f3dhatnak az adatb\u00e1zisban.</li> <li>A szerepk\u00f6r\u00f6kh\u00f6z \u00e9s felhaszn\u00e1l\u00f3khoz tartoznak Claim-ek, amik \u00e1ll\u00edt\u00e1sok lehetnek a szerepk\u00f6rr\u0151l/felhaszn\u00e1l\u00f3r\u00f3l. Ez gyakorlatilag egy metaadatt\u00e1bla, teh\u00e1t kulcs-\u00e9rt\u00e9kek form\u00e1j\u00e1ban stringeket t\u00e1rolhatunk, pl. funkci\u00f3jogosults\u00e1gokat.</li> </ul>"},{"location":"seminar/3%20-%20Backend%20services/#teljes-ef-modell","title":"Teljes EF modell","text":"<p>// TODO: Cser\u00e9lni kell a v\u00e9gs\u0151re. </p> <p>Teljes EF model diagram</p>"},{"location":"seminar/3%20-%20Backend%20services/#bookshopbll","title":"BookShop.Bll","text":"<p>Ide ker\u00fcl minden logiga Service-ekbe szervezve. Egy-egy service feladata, hogy az adott funkci\u00f3csoporthoz tartoz\u00f3 adatb\u00e1zis m\u0171veletekhez sz\u00fcks\u00e9ges LINQ k\u00f3dot el\u0151\u00e1ll\u00edtsa \u00e9s lefuttassa. Az BLL-ben az adatb\u00e1zis lek\u00e9rdez\u0151 f\u00fcggv\u00e9nyek az entity -&gt; DTO mappinget is elv\u00e9gzik (Automapper seg\u00edts\u00e9g\u00e9vel), a m\u00f3dos\u00edt\u00e1s / besz\u00far\u00e1s eset\u00e9n pedig a DTO -&gt; Entit\u00e1s mappinget manu\u00e1lisan elv\u00e9gzi. \u00edgy a BLL a Webes r\u00e9teggel csak DTO-kal kommunik\u00e1lni, nem aj\u00e1nlj ki DB Entit\u00e1sokat.</p>"},{"location":"seminar/3%20-%20Backend%20services/#bookservice","title":"BookService","text":"<p>A k\u00f6nyvek kezel\u00e9s\u00e9vel kapcsolatos adatb\u00e1zis CRUD m\u0171veletek tal\u00e1lhat\u00f3ak benne, illetve k\u00fcl\u00f6nb\u00f6z\u0151 lek\u00e9rdez\u00e9sek.</p> <ul> <li>Ahogy az implement\u00e1ci\u00f3ban is l\u00e1that\u00f3 az akci\u00f3s / leg\u00fajabb k\u00f6nyvek lek\u00e9rdez\u00e9se k\u00fcl\u00f6n met\u00f3dust kapott. Haszn\u00e1lhattunk volna egy kicsivel bonyolultabb lek\u00e9rdez\u00e9st \u00e9s akkor egy met\u00f3dus \u00e9s egy t\u00edpus \u00e1tad\u00e1s el\u00e9g lett volna, de mivel csak k\u00e9t k\u00fcl\u00f6n list\u00e1nk van \u00edgy a legegyszer\u0171bb megold\u00e1st v\u00e1lasztottuk.</li> <li>Van egy lek\u00e9rdez\u00e9s a k\u00f6nyv r\u00e9szletes / fejl\u00e9c adataira.</li> <li>K\u00fcl\u00f6n lek\u00e9rdez\u00e9s tartozik a szerkeszt\u00e9shez, hiszen ez saj\u00e1t DTO-t haszn\u00e1l, hogy csak azokat az adatokat k\u00e9rdezz\u00fck le \u00e9s k\u00fcldj\u00fck vissza, amit t\u00e9nyleg lehet szerkeszteni vagy sz\u00fcks\u00e9ges az \u00faj k\u00f6nyv l\u00e9trehoz\u00e1s\u00e1n\u00e1l.</li> <li>A kateg\u00f3ria k\u00f6nyveit lek\u00e9rdezhetj\u00fck egyszer\u0171 list\u00e1ban, vagy lapozott list\u00e1ban is.</li> </ul> <p></p> <p>IBookService \u00e1ltal kiaj\u00e1nlott met\u00f3dusok \u00e9s megval\u00f3s\u00edt\u00e1suk.</p>"},{"location":"seminar/3%20-%20Backend%20services/#categoryservice","title":"CategoryService","text":"<p>A szolg\u00e1ltat\u00e1sban a klasszikus CRUD m\u0171veletek tal\u00e1lhat\u00f3k. Le tudjuk k\u00e9rdezni a teljes kateg\u00f3ria f\u00e1t, vagy egy kateg\u00f3ri\u00e1t a szerkeszt\u00e9shez.</p> <p></p> <p>ICategoryService \u00e1ltal kiaj\u00e1nlott met\u00f3dusok \u00e9s megval\u00f3s\u00edt\u00e1suk.</p>"},{"location":"seminar/3%20-%20Backend%20services/#commentservice","title":"CommentService","text":"<p>A szolg\u00e1ltat\u00e1s lehet\u0151s\u00e9get ad egy hozz\u00e1sz\u00f3l\u00e1s / aj\u00e1nl\u00f3 l\u00e9trehoz\u00e1s\u00e1hoz, illetve adott k\u00f6nyvh\u00f6z tartoz\u00f3 hozz\u00e1sz\u00f3l\u00e1sok / aj\u00e1nl\u00f3k lek\u00e9rdez\u00e9s\u00e9hez.</p> <p></p> <p>ICommentService \u00e1ltal kiaj\u00e1nlott met\u00f3dusok \u00e9s megval\u00f3s\u00edt\u00e1suk.</p>"},{"location":"seminar/3%20-%20Backend%20services/#publisherservice","title":"PublisherService","text":"<p>A szolg\u00e1ltat\u00e1sban a kiad\u00f3hoz tartoz\u00f3 CRUD m\u0171veletek ker\u00fcltek megval\u00f3s\u00edt\u00e1sra.</p> <p></p> <p>IPublisherService \u00e1ltal kiaj\u00e1nlott met\u00f3dusok \u00e9s megval\u00f3s\u00edt\u00e1suk.</p>"},{"location":"seminar/3%20-%20Backend%20services/#ratingservice","title":"RatingService","text":"<p>Itt tal\u00e1lhat\u00f3 a met\u00f3dus, amivel egy felhaszn\u00e1l\u00f3 egy \u00faj \u00e9rt\u00e9kel\u00e9st adhat egy k\u00f6nyvre. \u00c9rdekess\u00e9ge a szolg\u00e1ltat\u00e1snak, hogy lek\u00e9rdez\u00e9s nem tartozik hozz\u00e1. Ennek az az oka, hogy az \u00e9rt\u00e9kel\u00e9seket pontsz\u00e1m\u00e1t a k\u00f6nyvvel egy\u00fctt k\u00e9rdezz\u00fck le.</p> <p></p> <p>IRatingService \u00e1ltal kiaj\u00e1nlott met\u00f3dusok \u00e9s megval\u00f3s\u00edt\u00e1suk.</p>"},{"location":"seminar/3%20-%20Backend%20services/#bookshoptransfer","title":"BookShop.Transfer","text":"<p>Ebbe a projektbe szervez\u00fcnk minden olyan oszt\u00e1lyt, amit szerver \u00e9s kliens oldalon (Blazor WASM eset\u00e9n) is el kell \u00e9rni. Azzal, hogy ez egy k\u00fcl\u00f6n projekt tudunk referenci\u00e1t adni r\u00e1 majd a kliens projektb\u0151l is.</p> <ul> <li>DTO-k: A BLL \u00e1ltal visszaadott adat oszt\u00e1lyok. AutoMapper-rel v\u00e9gezz\u00fck a lek\u00e9rdez\u00e9sekn\u00e9l az entit\u00e1s -&gt; DTO \u00e1talak\u00edt\u00e1st. A m\u00e1sik ir\u00e1nyt, m\u00f3dos\u00edt\u00e1skor vagy besz\u00far\u00e1skor manu\u00e1lisan v\u00e9gezz\u00fck DTO -&gt; entit\u00e1s \u00e1talak\u00edt\u00e1st. Az \u00e1tl\u00e1that\u00f3s\u00e1g \u00e9rdek\u00e9ben k\u00fcl\u00f6n DTO-t a lek\u00e9rdez\u00e9sre \u00e9s a m\u00f3dos\u00edt\u00e1s-ra. Teh\u00e1t a megjelen\u00edt\u00e9sn\u00e9l <code>CategoryData</code>-t haszn\u00e1lunk, \u00edgy a l\u00e9trehoz\u00e1sn\u00e1l / szerkeszt\u00e9sn\u00e9l a <code>CreateOrEditCategory</code>-t, \u00edgy egy\u00e9rtelm\u0171en elk\u00fcl\u00f6n\u00fclnek az adatok, \u00e9s az is l\u00e1that\u00f3, hogy kell valid\u00e1ci\u00f3s szab\u00e1lyokat defini\u00e1lni.</li> <li>Valid\u00e1ci\u00f3s szab\u00e1lyok: Ha azt szeretn\u00e9nk, hogy a kliens oldalon ugyanazok a valid\u00e1ci\u00f3s szab\u00e1lyok fussanak, mint szerver oldalon k\u00e9nytelenek vagyunk itt defini\u00e1lni, mert ezt a projektet \u00e9ri el a kliens \u00e9s a szerver is.</li> <li>DB Enum-ok: Az adatb\u00e1zisban n\u00e9h\u00e1ny mez\u0151t <code>Enum</code>-k\u00e9nt hoztunk l\u00e9tre (pl.: <code>AddressType</code> vagy <code>CommentType</code>). Ez a k\u00f3d olvashat\u00f3s\u00e1ga szempontj\u00e1b\u00f3l nagyon fontos, mert az <code>enum</code> t\u00f6bbet mond mint egy <code>int</code>. Ahhoz, hogy kliens oldalon is fel tudjuk haszn\u00e1lni ezeket az <code>enum</code>-okat itt kell \u0151ket defini\u00e1lni.</li> </ul> <p>Gondoljuk v\u00e9gig mi lenne ha a BLL-ben lenne ez a k\u00f3d</p> <p>Ha nem hozn\u00e1nk neki l\u00e9tre k\u00fcl\u00f6n projektet hanem a BLL r\u00e9tegben defini\u00e1ln\u00e1nk ezeket a t\u00edpusokat, akkor a Blazor kliens oldali k\u00f3dnak referenci\u00e1t kellene adni a BLL projektre. Viszont ezzel a teljes BLL el\u00e9rhet\u0151 lenne, \u00e9s meg tudn\u00e1nk tenni, hogy kliens oldalr\u00f3l olyan szolg\u00e1ltat\u00e1st h\u00edvunk, amit kliens oldalr\u00f3l nem is \u00e9r\u00fcnk el, csak Web API-n kereszt\u00fcl.</p> <p></p> <p>DTO-k Transfer projektben</p> <p></p> <p>L\u00e9trehoz\u00e1shoz / szerkeszt\u00e9shez haszn\u00e1lt DTO-k</p>"},{"location":"seminar/3%20-%20Backend%20services/#bookshopserverabstraction","title":"BookShop.Server.Abstraction","text":"<p>Csak az\u00e9rt sz\u00fcks\u00e9ges ez a projekt, hogy olyan interf\u00e9szeket defini\u00e1ljunk benne, amit a BLL vagy DAL r\u00e9teg haszn\u00e1l, viszont a konkr\u00e9t implement\u00e1ci\u00f3j\u00e1t csak olyan projektben tudjuk megtenni, amire nem tartalmazhat referenci\u00e1t a BLL vagy DAL projekt.</p> <p>T\u00f6k\u00e9letes p\u00e9lda az <code>IRequestContext</code> interf\u00e9sz, amit jelenleg tartalmaz. Az interf\u00e9szen defini\u00e1ljuk, hogy van egy <code>UserId</code> ami az aktu\u00e1lisan bel\u00e9pett felhaszn\u00e1l\u00f3 ID-j\u00e1t tartalmazza. \u00cdgy amikor egy hozz\u00e1sz\u00f3l\u00e1st el kell menteni az adatb\u00e1zisba, akkor nem a kliensr\u0151l v\u00e1rjuk a l\u00e9trehoz\u00f3 felhaszn\u00e1l\u00f3 azonos\u00edt\u00f3j\u00e1t, illetve nem a Webes r\u00e9tegben k\u00e9rdezz\u00fck azt le \u00e9s adjuk \u00e1t k\u00fcl\u00f6n param\u00e9terben, hanem elk\u00e9sz\u00edtj\u00fck a Webes projektben az interf\u00e9sz implement\u00e1ci\u00f3j\u00e1t ami be\u00e1ll\u00edtja a <code>UserId</code> \u00e9rt\u00e9k\u00e9t.</p> <p>Ezen fel\u00fcl tal\u00e1lhat\u00f3 itt egy <code>CurrentUser</code> objektum is, amiben a felhaszn\u00e1l\u00f3 \u00f6sszes claim-j\u00e9t el\u00e9rj\u00fck. A <code>RequestId</code> pedig a napl\u00f3z\u00e1sn\u00e1l tud seg\u00edteni, hogy az egyes HTTP k\u00e9r\u00e9seket \u00f6ssze tudjuk k\u00f6tni. Teh\u00e1t minden k\u00e9r\u00e9shez egy \u00faj <code>RequestId</code>-t \u00e1ll\u00edtunk be, de a k\u00e9r\u00e9sen bel\u00fcl ez \u00e1lland\u00f3.</p> <pre><code>using System.Security.Claims;\n\nnamespace BookShop.Server.Abstraction.Context;\n\n/// &lt;summary&gt;\n/// Gets the request's sender's request's identifier and user information.\n/// &lt;/summary&gt;\npublic interface IRequestContext\n{\n    string? RequestId { get; }\n\n    ClaimsIdentity? CurrentUser { get; }\n\n    public int? UserId { get; }\n}\n</code></pre>"},{"location":"seminar/3%20-%20Backend%20services/#editorconfig","title":"editor.config","text":"<p>Ha a solution-\u00f6n bel\u00fcl testre szeretn\u00e9nk szabni az egyedi be\u00e1ll\u00edt\u00e1sokat p\u00e9ld\u00e1ul elnevez\u00e9si konvenci\u00f3k, white space-ek, z\u00e1r\u00f3jelek kezel\u00e9se, akkor azt \u00fagy tehetj\u00fck meg, hogy l\u00e9trehozunk egy <code>.editorconfig</code> f\u00e1jlt, amiben elv\u00e9gezhetj\u00fck ezeket a be\u00e1ll\u00edt\u00e1sokat. S\u0151t k\u00e9s\u0151bb azt tov\u00e1bbi projektekben is felhaszn\u00e1lhatjuk.</p> <ol> <li>Adjunk is hozz\u00e1 a solution-h\u00f6z egy editor config-ot <code>Solution</code> \u2192 <code>jobb klikk</code> \u2192 <code>Add</code> \u2192 <code>New Editorconfig</code></li> <li> <p>Be\u00e1ll\u00edt\u00e1st\u00f3l f\u00fcgg\u0151en a grafikus szerkeszt\u0151 fel\u00fclet, vagy sim\u00e1n sz\u00f6vegesen meg is nyitja a Visual Studio.</p> <p></p> <p>Editor config hozz\u00e1ad\u00e1sa \u00e9s szerkeszt\u00e9se (grafikus / sz\u00f6veges)</p> Editor kiv\u00e1laszt\u00e1sa <p></p> <p>Editor config grafikus megnyit\u00e1sa</p> <p></p> <p>Editor config sz\u00f6veges megnyit\u00e1sa</p> </li> <li> <p>Az editor config-ban egyszer\u0171en \u00e1tkattinthatjuk, hogy a k\u00f3dot hogyan form\u00e1zza, milyen aj\u00e1nl\u00e1sokat adjon a Studio. Most nem \u00e1ll\u00edtunk \u00e1t semmit, de \u00e9rdemes \u00e1ttanulm\u00e1nyozni, hogy mennyire r\u00e9szletesen testre lehet szabni ezeket a be\u00e1ll\u00edt\u00e1sokat.</p> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.1%20Basics/","title":"4.1. Projekt fel\u00e9p\u00edt\u00e9se, alapok","text":""},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.1%20Basics/#41-projekt-felepitese-alapok","title":"4.1. Projekt fel\u00e9p\u00edt\u00e9se, alapok","text":"<p>Ezen a laboron egy ASP.NET Core Razor Pages projektet hozunk l\u00e9tre, melyben megn\u00e9zz\u00fck, hogyan lehet szerver oldalon a Razor Page-eket felhaszn\u00e1lva webes alkalmaz\u00e1st fejleszteni.</p> <p>Eddig a UI r\u00e9teg helyett csak egy egyszer\u0171 Console App-ot haszn\u00e1ltunk arra, hogy kipr\u00f3b\u00e1ljuk a backend alkalmaz\u00e1sunkat. Most ezt cser\u00e9lj\u00fck le, az ASP.NET Core Razor Page projektre \u00e9s tekints\u00fck \u00e1t a projekt fel\u00e9p\u00edt\u00e9s\u00e9t</p>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.1%20Basics/#kiindulo-alkalmazas-letoltese","title":"Kiindul\u00f3 alkalmaz\u00e1s let\u00f6lt\u00e9se","text":"<p>Az el\u0151z\u0151 laboron elkezdett k\u00f3dot folytatjuk tov\u00e1bb \u00e9s az \u00f6sszes ASP.NET Razor Pages-es labort ide fogjuk elk\u00e9sz\u00edteni.</p>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.1%20Basics/#projekt-letrehozasa","title":"Projekt l\u00e9trehoz\u00e1sa","text":"<p>Hozzuk l\u00e9tre az ASP.NET Core Web App (Razor Page) projekt\u00fcnket <code>BookShop.Web.RazorPage</code> n\u00e9vvel.</p> <ul> <li>ASP.NET Core Web App (Razor Page) t\u00edpust v\u00e1lasszuk.</li> <li> <p>A harmadik oldalon, ahol az ASP.NET Core projekt tulajdons\u00e1gain\u00e1l az Authentication Type-n\u00e1l v\u00e1lasszuk a None-t. Az al\u00e1bbi list\u00e1ban l\u00e1thatjuk, hogy ezen fel\u00fcl m\u00e9g milyen opci\u00f3kat v\u00e1laszthatn\u00e1nk. (Tov\u00e1bbi r\u00e9szletek).</p> <ul> <li>None: Nincs felhaszn\u00e1l\u00f3kezel\u00e9s az alkalmaz\u00e1sban.</li> <li>Individual Accounts: ASP.NET Identity seg\u00edts\u00e9g\u00e9vel adatb\u00e1zisban t\u00e1rolt felhaszn\u00e1l\u00f3kezel\u00e9st tesz lehet\u0151v\u00e9.</li> <li>Microsoft identity platform: Azure AD bel\u00e9p\u00e9st teszt lehet\u0151v\u00e9.</li> <li>Windows: A sz\u00e1m\u00edt\u00f3g\u00e9pen l\u00e9v\u0151 windows felhaszn\u00e1l\u00f3kkal lehet bel\u00e9pni az alkalmaz\u00e1sba, \u00edgy az alkalmaz\u00e1son bel\u00fcl nincs sz\u00fcks\u00e9g felhaszn\u00e1l\u00f3 kezel\u00e9sre, hiszen azt az oper\u00e1ci\u00f3s rendszer v\u00e9gzi.</li> </ul> </li> <li> <p>Ezen fel\u00fcl a HTTPS maradhat bekapcsolva, b\u00e1r \u00e9rdemes tudni, hogy ahhoz, hogy a HTTPS m\u0171k\u00f6dj\u00f6n a g\u00e9pen adminisztr\u00e1tornak kell lenn\u00fcnk, hogy fel tudja telep\u00edteni a sz\u00fcks\u00e9ges fejleszt\u0151i tan\u00fas\u00edtv\u00e1ny.</p> </li> <li>Dockert pedig nem szeretn\u00e9nk haszn\u00e1lni.</li> </ul> Seg\u00edts\u00e9g - ASP.NET Core Web App (Razor Page) l\u00e9trehoz\u00e1sa <p></p> <p>ASP.NET Core Web App (Razor Page) l\u00e9trehoz\u00e1sa 1.</p> <p></p> <p>ASP.NET Core Web App (Razor Page) l\u00e9trehoz\u00e1sa 2.</p> <p></p> <p>ASP.NET Core Web App (Razor Page) l\u00e9trehoz\u00e1sa 3.</p>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.1%20Basics/#projekt-felepitese","title":"Projekt fel\u00e9p\u00edt\u00e9se","text":"<p>Az al\u00e1bbi \u00e1br\u00e1n l\u00e1that\u00f3 a l\u00e9trehozott projekt strukt\u00far\u00e1ja.</p> <p></p> <p>ASP.NET Core Web App (Razor Page) projekt strukt\u00fara</p> <ul> <li> <p>A <code>Properties</code> k\u00f6nyvt\u00e1rban tal\u00e1lhat\u00f3 a <code>launchSettings.json</code>, ami az alkalmaz\u00e1s ind\u00edt\u00e1s\u00e1val kapcsolatos be\u00e1ll\u00edt\u00e1sokat fogja \u00f6ssze. Itt tal\u00e1lhat\u00f3, hogy</p> <ul> <li>milyen porton induljon az alkalmaz\u00e1s,</li> <li>milyen k\u00f6rnyezeti v\u00e1ltoz\u00f3k legyenek be\u00e1ll\u00edtva. Pl.: ASPNETCORE_ENVIRONMENT legyen Development</li> <li>vagy p\u00e9ld\u00e1ul a Windows authentication be legyen-e kapcsolva IIS alatt.</li> </ul> </li> <li> <p>A <code>wwwroot</code> alatt tal\u00e1lhat\u00f3k a statikusan kiszolg\u00e1land\u00f3 f\u00e1jlok. (CSS, JS, k\u00e9pek\u2026)</p> </li> <li>A <code>Pages</code> mapp\u00e1ban az Razor Pages lapkomponensek tal\u00e1lhat\u00f3k. Ezek MVVM mint\u00e1t k\u00f6vet\u0151 oldalak, melyeknek szerveroldali logikai k\u00f3dr\u00e9szletei a hozz\u00e1juk tartoz\u00f3 m\u00f6g\u00f6ttes k\u00f3d (code behind) f\u00e1jlokban tal\u00e1lhat\u00f3k, a kirajzoland\u00f3 HTML-t pedig Razor szintaxissal \u00e1ll\u00edtjuk \u00f6ssze, szerveroldali megjelen\u00edt\u00e9si logik\u00e1val \u00f6tv\u00f6zve. A konvenci\u00f3 szerint _ (alulvon\u00e1s) karakterrel kezd\u0151d\u0151 n\u00e9zetek vagy elrendez\u00e9s (layout, master) n\u00e9zetek, melyek keretet adnak egyes oldalaknak, vagy r\u00e9szleges (partial) n\u00e9zetek, melyeket egyszer\u0171 k\u00f3d-\u00fajrafelhaszn\u00e1l\u00e1s szempontj\u00e1b\u00f3l szervezhet\u00fcnk ki, hogy elker\u00fclj\u00fck az ism\u00e9tl\u0151d\u0151 r\u00e9szek k\u00f3dm\u00e1sol\u00e1s\u00e1t. Ut\u00f3bbi Razor Pages haszn\u00e1lata eset\u00e9n ker\u00fclend\u0151, ugyanis erre a c\u00e9lra a ViewComponent megold\u00e1sok haszn\u00e1latosak.</li> <li><code>appsettings.json</code>: Egy JSON f\u00e1jl amiben az alkalmaz\u00e1s be\u00e1ll\u00edt\u00e1sai tal\u00e1lhat\u00f3k. Az\u00e9rt \u00e9rdemes haszn\u00e1lni, mert az itt l\u00e9v\u0151 adatokat egyszer\u0171en az alkalmaz\u00e1s \u00fajratelep\u00edt\u00e9se n\u00e9lk\u00fcl is meg tudjuk v\u00e1ltoztatni \u00e9s k\u00f3db\u00f3l is egyszer\u0171en el\u00e9rhet\u0151ek. Ezen fel\u00fcl az Azure-be telep\u00edtj\u00fck az alkalmaz\u00e1st, akkor a CI / CD pipeline-ban is le tudjuk ezeket cser\u00e9lni automatikusan att\u00f3l f\u00fcgg\u0151en, hogy \u00e9ppen milyen k\u00f6rnyezetbe telep\u00edt\u00fcnk.</li> </ul>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.1%20Basics/#programcs-fajl","title":"Program.cs f\u00e1jl","text":"<p>Az alkalmaz\u00e1s bel\u00e9p\u00e9si pontja a <code>Program.cs</code> f\u00e1jl. A kor\u00e1bbi .NET verzi\u00f3kkal ellent\u00e9tben a gener\u00e1lt f\u00e1jlban m\u00e1r nem tal\u00e1lunk <code>Main</code> met\u00f3dust, hanem top level statement-ek form\u00e1j\u00e1ban van megadva minden. A kor\u00e1bbi <code>Main</code> met\u00f3dusos forma is haszn\u00e1lhat\u00f3, nem k\u00f6telez\u0151 az \"egybe\u00f6mlesztett\" k\u00f3d\u00edr\u00e1si form\u00e1t v\u00e1lasztani.</p> <p>Mivel a .NET Core 3.1-es megold\u00e1st (Top Level Statement n\u00e9lk\u00fcl) jobban meg lehet \u00e9rteni ez\u00e9rt el\u0151sz\u00f6r azt n\u00e9zz\u00fck meg.</p>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.1%20Basics/#top-level-statement-nelkul","title":"Top level statement n\u00e9lk\u00fcl","text":"<ul> <li> <p>.NET Core 3.1-ben az al\u00e1bbiak szerint n\u00e9z ki a <code>Program.cs</code> f\u00e1jl. Az alkalmaz\u00e1s bel\u00e9p\u00e9si pontja az itt tal\u00e1lhat\u00f3 <code>Main</code> met\u00f3dus.</p> Program.cs<pre><code>public class Program \n{ \n    public static void Main(string[] args) \n    { \n        CreateHostBuilder(args).Build().Run(); \n    } \n\n    public static IHostBuilder CreateHostBuilder(string[] args) \n        =&gt; Host.CreateDefaultBuilder(args)\n            .ConfigureWebHostDefaults(webBuilder =&gt; { webBuilder.UseStartup&lt;Startup&gt;(); }); \n}\n</code></pre> </li> <li> <p>A bel\u00e9p\u00e9si pont a <code>CreateHostBuilder</code> f\u00fcggv\u00e9nyt h\u00edvja meg a parancssorr\u00f3l (esetleg) \u00e9rkez\u0151 param\u00e9terekkel, amit \u00e1tad a <code>Host</code> statikus oszt\u00e1ly <code>CreateDefaultBuilder</code> met\u00f3dus\u00e1nak.</p> </li> </ul> <p>Builder minta</p> <p>A builder minta megval\u00f3s\u00edt\u00e1s\u00e1t t\u00f6bb helyen is l\u00e1tni fogjuk az alkalmaz\u00e1sban, l\u00e9nyege, hogy egy bels\u0151 konfigur\u00e1ci\u00f3s objektumot .NET b\u0151v\u00edt\u0151 met\u00f3dusokon kereszt\u00fcl konfigur\u00e1lunk fel. A minta azt a probl\u00e9m\u00e1t oldja meg, hogy tudjuk kompon\u00e1lni a bonyolult param\u00e9terez\u00e9seket (pl. komplex objektum p\u00e9ld\u00e1nyos\u00edt\u00e1s vagy f\u00fcggv\u00e9nyh\u00edv\u00e1s).</p> <ul> <li>A builder mint\u00e1t haszn\u00e1lja a <code>UseStartup&lt;T&gt;()</code> met\u00f3dus is, ami a <code>Startup</code> oszt\u00e1lyt regisztr\u00e1lja be, mint a webalkalmaz\u00e1s ind\u00edt\u00e1s\u00e1\u00e9rt felel\u0151s oszt\u00e1ly (t\u00edpus). Miut\u00e1n ez megt\u00f6rt\u00e9nt, tov\u00e1bbi konfigur\u00e1ci\u00f3kat v\u00e9gezhet\u00fcnk az objektumon, vagy a <code>Main</code>-be visszat\u00e9rve \"meg\u00e9p\u00edtj\u00fck\" a szerver p\u00e9ld\u00e1nyt, amit a <code>Run()</code> megh\u00edv\u00e1s\u00e1val el is ind\u00edtunk.</li> </ul> <p>Vizsg\u00e1ljuk meg a <code>CreateDefaultBuilder</code> eredeti implement\u00e1ci\u00f3j\u00e1t</p> <p>A <code>CreateDefaultBuilder</code> eredeti implement\u00e1ci\u00f3ja, ami n\u00e9h\u00e1ny gyakori m\u0171veletet el\u0151re elv\u00e9gez helyett\u00fcnk, p\u00e9ld\u00e1ul a Kestrel \u00e9s IIS integr\u00e1ci\u00f3, vagy az <code>appsettings.json</code> konfigur\u00e1ci\u00f3s f\u00e1jl beregisztr\u00e1l\u00e1s\u00e1t \u00e9s a napl\u00f3z\u00f3 komponens el\u00e9rhet\u0151v\u00e9 t\u00e9tel\u00e9t.</p> <ul> <li> <p>N\u00e9zz\u00fck meg a <code>Startup.cs</code> f\u00e1jl k\u00f3dj\u00e1t is!</p> Startup.cs<pre><code>public class Startup \n{ \n    public Startup(IConfiguration configuration) \n    { \n        Configuration = configuration; \n    } \n\n    public IConfiguration Configuration { get; } \n\n    // This method gets called by the runtime. Use this method to add services to the container. \n    public void ConfigureServices(IServiceCollection services) \n    { \n        services.AddRazorPages() \n    } \n\n    // This method gets called by the runtime. Use this method to configure the HTTP request pipeline. \n    public void Configure(IApplicationBuilder app, IHostEnvironment env) \n    { \n        if (env.IsDevelopment()) \n        { \n            app.UseDeveloperExceptionPage(); \n        } \n        else \n        { \n            app.UseExceptionHandler(\"/Error\"); \n        } \n\n        app.UseStaticFiles(); \n        app.UseRouting(); \n        app.UseAuthorization(); \n        app.UseEndpoints(endpoints =&gt; { endpoints.MapRazorPages(); }); \n    }\n}\n</code></pre> </li> <li> <p>Ez az oszt\u00e1ly egy \u00e1ltal\u00e1nos oszt\u00e1ly, amely le\u00edrja az ASP.NET Core alkalmaz\u00e1sunkat. Az oszt\u00e1ly form\u00e1tuma r\u00e9szben k\u00f6t\u00f6tt, ugyanis a k\u00e9t implement\u00e1lt met\u00f3dus neve k\u00f6t\u00f6tt, param\u00e9terlist\u00e1ja viszont tetsz\u0151leges. Ennek oka, hogy az ASP.NET Core k\u00f6zponti eleme a .NET Core \u00e1ltal ny\u00fajtott inversion of control (IoC) dependency injection (DI) container, ami a f\u00fcgg\u0151s\u00e9gek felold\u00e1s\u00e1\u00e9rt felel\u0151s. Ez ebben a konkr\u00e9t esetben azt jelenti, hogy p\u00e9ld\u00e1ul a <code>Configure()</code> \u00e1ltal olyan param\u00e9tereket v\u00e1rhatunk, amelyeket a DI kont\u00e9ner ismer, az \u00edgy v\u00e1rt t\u00edpusokat a DI kont\u00e9ner fogja nek\u00fcnk feloldani, sz\u00fcks\u00e9g eset\u00e9n p\u00e9ld\u00e1nyos\u00edtani.</p> </li> <li> <p>A <code>Startup</code> oszt\u00e1ly p\u00e9ld\u00e1nyos\u00edt\u00e1sakor kapunk egy <code>IConfiguration</code> objektumot, amely \u00e1ltal el\u00e9rhetj\u00fck az <code>appsettings.json</code> f\u00e1jlokban megadott konfigur\u00e1ci\u00f3kat, ezt elt\u00e1roljuk a <code>Configuration</code> tulajdons\u00e1gban.</p> </li> <li>Ezut\u00e1n megh\u00edv\u00f3dik a <code>ConfigureServices()</code> met\u00f3dus, amelyben a kapott <code>IServiceCollection</code> DI kont\u00e9nerbe regisztr\u00e1lunk be saj\u00e1t objektumokat, szolg\u00e1ltat\u00e1sokat: jelenleg mag\u00e1t a RazorPage keretrendszert (pontosabban annak ilyen m\u00f3don defini\u00e1lt f\u00fcgg\u0151s\u00e9geit, szolg\u00e1ltat\u00e1sait). Itt is l\u00e1tjuk a builder minta egyik vari\u00e1ns\u00e1t.</li> <li>V\u00e9g\u00fcl a <code>Configure()</code> met\u00f3dusban \u00e9p\u00edtj\u00fck fel az alkalmaz\u00e1s middleware-jeit.</li> </ul>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.1%20Basics/#top-level-statement-tel","title":"Top level statement-tel","text":"<p>Az el\u0151bbiekben \u00e1ttekintett k\u00f3d helyett m\u00e1r Top Level Statement-tel gener\u00e1l\u00f3dik a Program.cs f\u00e1jl az al\u00e1bbi tartalommal.</p> Program.cs<pre><code>    var builder = WebApplication.CreateBuilder(args);\n\n    // Add services to the container.\n    builder.Services.AddRazorPages();\n\n    var app = builder.Build();\n\n    // Configure the HTTP request pipeline.\n    if (!app.Environment.IsDevelopment())\n    {\n        app.UseExceptionHandler(\"/Error\");\n        // The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.\n        app.UseHsts();\n    }\n\n    app.UseHttpsRedirection();\n\n    app.UseRouting();\n\n    app.UseAuthorization();\n\n    app.MapStaticAssets();\n    app.MapRazorPages().WithStaticAssets();\n\n    app.Run();\n</code></pre> <p>A fenti k\u00f3dban l\u00e1that\u00f3, hogy ugyan\u00fagy a <code>CreateBuilder</code>-rel hozzuk l\u00e9tre a <code>WebApplication</code>-t, majd regisztr\u00e1ljuk a szolg\u00e1ltat\u00e1sainkat. Ezt k\u00f6vet\u0151en hozz\u00e1adjuk a middleware-eket \u00e9s elind\u00edtjuk az alkalmaz\u00e1st. Pont ugyan\u00fagy mint top level statement n\u00e9lk\u00fcl, csak most a k\u00f3d igaz\u00e1b\u00f3l egym\u00e1s m\u00f6g\u00e9 van \"dob\u00e1lva\".</p>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.1%20Basics/#dbcontext-es-service-ek-regisztralasa","title":"DbContext \u00e9s Service-ek regisztr\u00e1l\u00e1sa","text":"<ol> <li> <p>Adjunk referenci\u00e1t a <code>BookShop.Web.RazorPage</code> projektb\u0151l az al\u00e1bbiakra</p> <ul> <li>BookShop.Bll projekt: \u00cdgy tudjuk a DI-ba beregisztr\u00e1lni a szolg\u00e1ltat\u00e1sainkat.</li> <li>BookShop.Transfer projekt: Hogy a DTO-kat is el\u00e9rj\u00fck.</li> <li>BookShop.Server.Abstraction: Hogy az IRequestContext-et be tudjuk regisztr\u00e1lni.</li> </ul> </li> <li> <p>Ahhoz, hogy le tudjuk futtatni a migr\u00e1ci\u00f3kat \u00fagy, hogy a Startup projekt a <code>BookShop.Web.RazorPage</code> adjuk hozz\u00e1 a projekthez a <code>Microsoft.EntityFrameworkCore.Design</code> nuGet package-et.</p> </li> <li> <p>A <code>Program.cs</code>-ben regisztr\u00e1ljuk be a BLL szolg\u00e1ltat\u00e1sainkat. Ehhez m\u00e1r megvan a <code>Wireup.cs</code>-ben a <code>AddBllServices</code> met\u00f3dus, amit csak meg kell h\u00edvunk.</p> Program.cs<pre><code>using BookShop.Bll;\n\nvar builder = WebApplication.CreateBuilder(args);\n\n// Register BLL and DAL Services.\nbuilder.Services.AddBllServices(builder.Configuration);\n\n// TODO: Register addtional services\n\n// Add services to the container.\nbuilder.Services.AddRazorPages();\n\nvar app = builder.Build();\n</code></pre> </li> <li> <p>Mivel a kiindul\u00f3 k\u00f3dban m\u00e1r haszn\u00e1ljuk az <code>IRequestContext</code>-et, ez\u00e9rt k\u00e9sz\u00edten\u00fcnk kell hozz\u00e1 egy implement\u00e1ci\u00f3t \u00e9s be kell regisztr\u00e1lni mint szolg\u00e1ltat\u00e1s. Implement\u00e1ljuk el\u0151sz\u00f6r az <code>IRequestContext</code> interf\u00e9szt egy mock k\u00f3ddal.</p> RequestContext.cs<pre><code>using BookShop.Server.Abstraction.Context;\nusing System.Security.Claims;\n\nnamespace BookShop.Web.RazorPage.Services;\n\npublic class RequestContext : IRequestContext\n{\n    public string? RequestId { get; }\n\n    public ClaimsIdentity? CurrentUser { get; }\n\n    public int? UserId =&gt; 1;//throw new NotImplementedException();\n}\n</code></pre> </li> <li> <p>Regisztr\u00e1ljuk be a <code>Program.cs</code>-ben</p> Program.cs<pre><code>using BookShop.Bll;\nusing BookShop.Server.Abstraction.Context;\nusing BookShop.Web.RazorPage.Services;\n\nvar builder = WebApplication.CreateBuilder(args);\n\n// Register Bll and Dal Servces.\nbuilder.Services.AddBllServices(builder.Configuration);\n\n// Register additional non-BLL services.\nbuilder.Services.AddScoped&lt;IRequestContext, RequestContext&gt;();\n</code></pre> </li> <li> <p>\u00c1ll\u00edtsuk be, hogy a <code>BookShop.Web.RazorPages</code> projekt legyen a startup project \u00e9s ind\u00edtsuk el. Els\u0151 ind\u00edt\u00e1skor egy felugr\u00f3 ablakban r\u00e1k\u00e9rdez, hogy megb\u00edzunk-e az \u00fajonnan gener\u00e1lt SSL tan\u00fas\u00edtv\u00e1nyban, \u00e9s telep\u00edtj\u00fck-e.</p> Seg\u00edts\u00e9g - Tan\u00fas\u00edtv\u00e1ny elfogad\u00e1sa k\u00e9perny\u0151k <p></p> <p>Figyelmeztet\u00e9s, hogy a gener\u00e1lt SSL tan\u00fas\u00edtv\u00e1nyban megb\u00edzunk-e</p> <p></p> <p>Tan\u00fas\u00edtv\u00e1ny telep\u00edt\u00e9se</p> </li> <li> <p>Ha mindent j\u00f3l csin\u00e1ltunk el is indul az alkalmaz\u00e1s</p> </li> </ol> <p></p> <p>ASP.NET oldalunk fut\u00e1s k\u00f6zben.</p>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.1%20Basics/#middleware","title":"Middleware","text":"<p>Hivatalos dokument\u00e1ci\u00f3: middleware.</p> <p>A middleware-ek egym\u00e1sra \u00e9p\u00fcl\u0151 r\u00e9tegek, amelyek a HTTP k\u00e9r\u00e9s alapj\u00e1n:</p> <ul> <li>vagy a kontextusunk \u00e1llapot\u00e1t m\u00f3dos\u00edtj\u00e1k, p\u00e9ld\u00e1ul a HTTP k\u00e9r\u00e9sben tal\u00e1lhat\u00f3 s\u00fcti alapj\u00e1n a kontextushoz hozz\u00e1rendelik az aktu\u00e1lis felhaszn\u00e1l\u00f3t reprezent\u00e1l\u00f3 objektumot</li> <li>vagy el\u0151\u00e1ll\u00edtj\u00e1k a HTTP v\u00e1laszt.</li> </ul> <p></p> <p>ASP.NET Middleware-ek</p> <p>A middleware-ek sorrendje \u00e9s regisztr\u00e1ci\u00f3j\u00e1nak m\u00f3dja (pl. opcion\u00e1lis vagy fut\u00e1si idej\u0171 felt\u00e9telhez k\u00f6t\u00f6tt mondjuk az \u00fatvonalban szerepl\u0151 param\u00e9ter, vagy azon vizsg\u00e1lt felt\u00e9tel alapj\u00e1n) kritikus, ugyanis, ha egy middleware el\u0151\u00e1ll\u00edtja a v\u00e1laszt, nem jut tov\u00e1bb a k\u00e9r\u00e9s a k\u00f6vetkez\u0151 middleware-hez. Ez\u00e9rt, ha az Razor Page v\u00e9gpontokat regisztr\u00e1ln\u00e1nk el\u0151bb, akkor statikus f\u00e1jlokat nem tudn\u00e1nk kiszolg\u00e1lni (az esetek t\u00falnyom\u00f3 r\u00e9sz\u00e9ben, de a p\u00e9lda kedv\u00e9\u00e9rt elegend\u0151 most ennyi).</p> <p></p> <p>ASP.NET Core Razor page middleware-ek</p> <p>A k\u00f3dban a middleware-eket regisztr\u00e1l\u00f3 met\u00f3dusok \u00e1ltal\u00e1ban a <code>Use...</code> prefix-szel kezd\u0151dnek.</p> <p>Eset\u00fcnkben a middleware-ek k\u00f6z\u00fcl az \u00e1ltal\u00e1nos hibakezel\u0151 middleware-t \u00e9s a HTST-t csak akkor regisztr\u00e1ljuk be, ha nem Development m\u00f3dban fut az alkalmaz\u00e1s. Ett\u0151l f\u00fcggetlen\u00fcl a statikus f\u00e1jlkiszolg\u00e1l\u00e1st enged\u00e9lyezz\u00fck a <code>wwwroot</code> mapp\u00e1b\u00f3l, majd be\u00e1ll\u00edtjuk a Https \u00e1tir\u00e1ny\u00edt\u00e1st, a routing-ot, az authoriz\u00e1ci\u00f3t, majd a RazorPage-ek v\u00e9gpontjaira b\u00edzzuk a v\u00e1lasz el\u0151\u00e1ll\u00edt\u00e1s\u00e1t.</p> <p>A <code>wwwroot</code> mapp\u00e1ban a statikusan kiszolg\u00e1land\u00f3 f\u00e1jljaink tal\u00e1lhat\u00f3k. Ezeket a b\u00f6ng\u00e9sz\u0151 let\u00f6lti, amikor hivatkozunk r\u00e1juk pl. <code>&lt;script&gt;</code> vagy <code>&lt;style&gt;</code> tagben. A statikus f\u00e1jlok kiszolg\u00e1l\u00e1s\u00e1\u00e9rt szint\u00e9n middleware felel\u0151s, a Static Files middleware.</p>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.1%20Basics/#appsettingsjson-beallitasa","title":"appsettings.json be\u00e1ll\u00edt\u00e1sa","text":"<ol> <li>A k\u00f3d az\u00e9rt tudott elindulni, mert nem akart adatb\u00e1zishoz ny\u00falni. Ha megn\u00e9zz\u00fck az appsettings.json f\u00e1jlt akkor l\u00e1thatjuk, hogy nem vett\u00fck fel a sz\u00fcks\u00e9ges adatb\u00e1zis kapcsol\u00f3d\u00e1si sztringet \u00e9s az AutoMapper licensz kulcsot sem \u00e1ll\u00edtottuk be.</li> <li> <p>Vegy\u00fck fel a <code>DefaultConnectionString</code>-et \u00e9s az <code>AutoMapper</code> kulcsot az al\u00e1bbiak szerint az <code>appsettings.json</code>-ban</p> appsettings.json<pre><code>{\n\"Logging\": {\n    \"LogLevel\": {\n    \"Default\": \"Information\",\n    \"Microsoft.AspNetCore\": \"Warning\"\n    }\n},\n\"AllowedHosts\": \"*\",\n\n\"ConnectionStrings\": {\n    \"DefaultConnection\": \"Data Source=.;Initial Catalog=BookShopDb2;Integrated Security=True;TrustServerCertificate=True\"\n},\n\n\"AutoMapper\": {\n    \"LicenseKey\": \"user secretb\u0151l \u00e1ll\u00edtsuk be\"\n}\n}\n</code></pre> </li> <li> <p>Mivel a licensz kulcs egy \u00e9rz\u00e9keny, titkos adat ez\u00e9rt azt a user secrets.json-ba vegy\u00fck fel. (BookShop.Web.RazorPage -&gt; Manage User Secrets)</p> secrets.json<pre><code>{\n    \"AutoMapper\": {\n        \"LicenseKey\": \"ide j\u00f6n a licensz kulcs\"\n    }\n}\n</code></pre> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.1%20Basics/#kezdo-oldal","title":"Kezd\u0151 oldal","text":"<p>Most, hogy m\u00e1r vannak adataink, \u00e9s az alkalmaz\u00e1sv\u00e1zzal is elk\u00e9sz\u00fclt\u00fcnk, meg tudjuk jelen\u00edteni a fel\u00fcleten az adatb\u00e1zisban lev\u0151 k\u00f6nyvek adatait. Ehhez az <code>Index</code> page-et fogjuk \u00e1t\u00edrni, \u00edgy az oldal kezdeti bet\u00f6lt\u00e9sekor a root URL-en meg fog jelenni az el\u00e9rhet\u0151 k\u00f6nyvek list\u00e1ja.</p> <ol> <li>Ahhoz, hogy a k\u00e9pek megjelenjenek, a <code>Solution Items</code> mapp\u00e1ban (ha f\u00e1jl rendszer szinten keress\u00fck, akkor a solution gy\u00f6ker\u00e9ben) l\u00e9v\u0151 <code>Boritok.zip</code> f\u00e1jlban tal\u00e1lhat\u00f3 covers mapp\u00e1t m\u00e1soljuk \u00e1t, hogy a k\u00e9pek a <code>BookShop.Web.RazorPage\\wwwroot\\images\\covers</code> k\u00f6nyvt\u00e1rba ker\u00fcljenek!</li> <li> <p>Nyissuk meg a <code>Pages</code> mapp\u00e1ban tal\u00e1lhat\u00f3 <code>Index.cshtml</code> \u00e9s <code>Index.cshtml.cs</code> f\u00e1jlokat.</p> <ul> <li>A <code>.cshtml</code>-ben az oldal megjelen\u00e9se van le\u00edrva html \u00e9s razor szintaxissal,</li> <li>A <code>.cshtml.cs</code> f\u00e1jl pedig a code behind C# nyelven</li> </ul> </li> <li> <p>A m\u00f6g\u00f6ttes k\u00f3df\u00e1jlban egy \u00fcres <code>OnGet</code> met\u00f3dust l\u00e1tunk.</p> Index.razor.cs<pre><code>using Microsoft.AspNetCore.Mvc;\nusing Microsoft.AspNetCore.Mvc.RazorPages;\n\nnamespace BookShop.Web.RazorPage.Pages\n{\n    public class IndexModel : PageModel\n    {\n        public void OnGet()\n        {\n        }\n    }\n}\n</code></pre> </li> <li> <p>Az <code>OnGet</code> v\u00e1rhat tetsz\u0151leges param\u00e9tereket, melyeket a model binder fog felt\u00f6lteni nek\u00fcnk. A model binder-nek megadhat\u00f3, hogy adott param\u00e9tert ne a k\u00e9r\u00e9s alapj\u00e1n k\u00f6ss\u00f6n, hanem oldjon fel a DI kont\u00e9nerb\u0151l, \u00edgy az <code>OnGet</code> met\u00f3dusban elk\u00e9rhetj\u00fck a BLL szolg\u00e1ltat\u00e1sokat is az interf\u00e9sz megad\u00e1s\u00e1val.</p> <p>Model binding hivatalos dokument\u00e1ci\u00f3</p> <p>\u00c9rdemes a Microsoft hivatalos dokument\u00e1ci\u00f3j\u00e1t is \u00e1tfutni, a model binder-r\u0151l.</p> <p>DbContext k\u00f6zvetlen el\u00e9r\u00e9se</p> <p>Ak\u00e1r a <code>DbContext</code>-et is el\u00e9rhetn\u00e9nk, de a t\u00f6bbr\u00e9teg\u0171 architekt\u00fara miatt a Web csak a BLL-be h\u00edvhat be, a DAL r\u00e9teget k\u00f6zvetlen\u00fcl nem \u00e9rheti el. E miatt fontos az is, hogy a Webes r\u00e9teghez m\u00e1r csak DTO-k jussanak el.</p> Index.razor.cs - OnGet DI<pre><code>public async Task OnGet([FromServices] IBookService bookService)\n{ }\n</code></pre> </li> <li> <p>A modelloszt\u00e1ly konstruktor\u00e1ban is v\u00e1rhatja \u00e9s elt\u00e1rolja a f\u00fcgg\u0151s\u00e9g\u00e9re a referenci\u00e1t, ilyen esetben attrib\u00fatummal sem sz\u00fcks\u00e9ges ell\u00e1tni. Ennek a megold\u00e1snak a h\u00e1tr\u00e1nya, hogy lehet, hogy feleslegesen k\u00e9r\u00fcnk el egy f\u00fcgg\u0151s\u00e9get, mert nem felt\u00e9tlen\u00fcl az <code>OnGet</code> \u00e1gba fog befutni a k\u00e9r\u00e9s. Ez viszont igen ritk\u00e1n okoz val\u00f3di teljes\u00edtm\u00e9nyprobl\u00e9m\u00e1kat \u00e9s mikrooptimaliz\u00e1l\u00e1snak sz\u00e1m\u00edt, ez\u00e9rt a leggyakrabban haszn\u00e1lt m\u00f3dszer. M\u00f3dos\u00edtsuk a k\u00f3dot, hogy ne az <code>OnGet</code> kapja meg az <code>IBookService</code>-t, amit a DI-b\u00f3l kell feloldani, hanem a primary constructor, \u00edgy az eg\u00e9sz oszt\u00e1lyban el\u00e9rhet\u0151 lesz.</p> Index.razor.cs - Primary ctor<pre><code>public class IndexModel(IBookService bookService) : PageModel\n{ }\n</code></pre> </li> <li> <p>M\u00f3dos\u00edtsuk \u00fagy a fenti k\u00f3dot, hogy az <code>IBookService</code>-en kereszt\u00fcl k\u00e9rj\u00fck le az akci\u00f3s \u00e9s a leg\u00fajabb 5-5 k\u00f6nyvet, valamit al\u00e1 az \u00f6sszes k\u00f6nyvet (k\u00e9s\u0151bb itt jelennek majd meg a kateg\u00f3ria k\u00f6nyvei), amit elt\u00e1rolunk egy-egy BookData list\u00e1ban. \u00dcgyelj\u00fcnk r\u00e1, hogy a <code>GetDiscountedBooksAsync</code>, <code>GetNewestBooksAsync</code> \u00e9s a <code>GetBooksAsync</code> met\u00f3dusok aszinkronok!</p> Index.razor.cs<pre><code>using BookShop.Bll.ServicesInterfaces;\nusing BookShop.Transfer.Dtos;\nusing Microsoft.AspNetCore.Mvc.RazorPages;\n\nnamespace BookShop.Web.RazorPage.Pages;\n\npublic class IndexModel(IBookService bookService) : PageModel\n{\n    public IList&lt;BookData&gt; NewestBooks { get; set; } = [];\n    public IList&lt;BookData&gt; DiscountedBooks { get; private set; } = [];\n    public IList&lt;BookData&gt; Books { get; private set; } = [];\n\n    public async Task OnGet()\n    {\n        // Query book data from the BLL service\n        NewestBooks = await bookService.GetNewestBooksAsync(5);\n        DiscountedBooks = await bookService.GetDiscountedBooksAsync(5);\n        Books = await bookService.GetBooksAsync(null);\n    }\n}\n</code></pre> </li> <li> <p>Alternat\u00edv megold\u00e1sokkal is el\u00e9rhetj\u00fck a f\u00fcgg\u0151s\u00e9geinket:</p> <ul> <li>Lehets\u00e9ges a n\u00e9zetbe k\u00f6zvetlen\u00fcl injekt\u00e1lni f\u00fcgg\u0151s\u00e9get az <code>@inject</code> direkt\u00edva seg\u00edts\u00e9g\u00e9vel. Ez ellenjavallt, nagyon ritka esetekben szabad csak haszn\u00e1lni, mert a k\u00f3d \u00e1tl\u00e1thatatlans\u00e1g\u00e1hoz \u00e9s rejtett f\u00fcgg\u0151s\u00e9gekhez vezet (amiket neh\u00e9z vagy lehetetlen lehet tesztelni).</li> <li>B\u00e1rhol elk\u00e9rhetj\u00fck f\u00fcgg\u0151s\u00e9gk\u00e9nt az <code>IServiceProvider</code> interf\u00e9szt, ami az IoC kont\u00e9ner\u00e9rt felel\u0151s objektum. T\u0151le k\u00e9rj\u00fck el a f\u00fcgg\u0151s\u00e9geinket akkor is, amikor azt pl. konstruktorparam\u00e9terbe tessz\u00fck, de a keretrendszer ezt elfedi. Ha az <code>IServiceProvider</code>-en kereszt\u00fcl k\u00e9r\u00fcnk el f\u00fcgg\u0151s\u00e9get, akkor az a f\u00fcgg\u0151s\u00e9g rejtett lesz, a statikus k\u00f3danal\u00edzis nem tudja felder\u00edteni egy\u00e9rtelm\u0171en, hogy az oszt\u00e1lyunk f\u00fcgg egy m\u00e1sikt\u00f3l. A tiszta f\u00fcgg\u0151s\u00e9gekre mindig \u00fcgyelj\u00fcnk!</li> </ul> </li> <li> <p>K\u00e9sz\u00edts\u00fck el az <code>Index.razor</code> f\u00e1jlt is, ami megjelen\u00edti a leg\u00fajabb k\u00f6nyveket. A k\u00f6nyvlista f\u00f6l\u00f6tt legyen egy c\u00edm, hogy Leg\u00fajabb k\u00f6nyvek. A k\u00f6nyvlista megjelen\u00edt\u00e9s\u00e9hez egy ciklussal iter\u00e1ljunk v\u00e9gig a k\u00f6nyveket \u00e9s jelen\u00edts\u00fck meg a bor\u00edt\u00f3 k\u00e9p\u00fcket, amire kattintva el tudunk navig\u00e1lni a Book oldalra \u00e9s param\u00e9terk\u00e9nt adjuk \u00e1t a k\u00f6nyv Id-j\u00e1t. Az <code>img-fluid</code> CSS oszt\u00e1llyal tudjuk megadni, hogy a k\u00e9p az oldal \u00e1tm\u00e9retez\u00e9s\u00e9vel \u00f6sszemenjen.</p> Index.razor<pre><code>@page \n@model IndexModel \n\n@{ \n    ViewData[\"Title\"] = \"K\u00f6nyvek\"; \n} \n\n&lt;h2&gt;Leg\u00fajabb k\u00f6nyvek&lt;/h2&gt;\n&lt;div class=\"row row-cols-5 g-2\"&gt;\n    @foreach (var book in Model.NewestBooks)\n    {\n        &lt;a asp-page=\"Book\" asp-route-id=\"@book.Id\" class=\"col\"&gt;\n            &lt;img src=\"images/covers/@(book.Id).jpg\" alt=\"@book.Title\" title=\"@book.Title\" class=\"img-fluid w-100\" /&gt;\n        &lt;/a&gt;\n    }\n&lt;/div&gt;\n</code></pre> </li> <li> <p>Hasonl\u00f3an k\u00e9sz\u00edts\u00fck el, hogy a leg\u00fajabb k\u00f6nyvek alatt az akci\u00f3s k\u00f6nyvek is megjelenjenek. Itt figyelj\u00fcnk arra is, hogy csak akkor jelenjen meg ez a blokk, ha a list\u00e1ban tal\u00e1lhat\u00f3 k\u00f6nyv.</p> Seg\u00edts\u00e9g - Akci\u00f3s k\u00f6nyvek megjelen\u00edt\u00e9se Index.razor<pre><code>@if (Model.DiscountedBooks?.Any() == true)\n{\n    &lt;h2&gt;Leg\u00fajabb k\u00f6nyvek&lt;/h2&gt;\n    &lt;div class=\"row row-cols-5 g-2\"&gt;\n        @foreach (var book in Model.DiscountedBooks)\n        {\n            &lt;a asp-page=\"Book\" asp-route-id=\"@book.Id\" class=\"col\"&gt;\n                &lt;img src=\"images/covers/@(book.Id).jpg\" alt=\"@book.Title\" title=\"@book.Title\" class=\"img-fluid w-100\" /&gt;\n            &lt;/a&gt;\n        }\n    &lt;/div&gt;\n}\n</code></pre> </li> <li> <p>Az oldal alj\u00e1ra k\u00e9sz\u00edts\u00fck el az \u00f6sszes k\u00f6nyv megjelen\u00edt\u00e9s\u00e9t is. A megjelen\u00edt\u00e9shez haszn\u00e1ljuk a Bootstrap-es Card Group-ot.</p> Index.razor<pre><code>&lt;h2&gt;A kateg\u00f3ria k\u00f6nyvei&lt;/h2&gt;\n&lt;div class=\"row row-cols-2 row-cols-md-3 row-cols-lg-4 row-cols-xl-5 g-4\"&gt;\n    @foreach (var book in Model.Books)\n    {\n        &lt;div class=\"col\"&gt;\n            &lt;div class=\"card h-100\"&gt;\n                &lt;a asp-page=\"Book\" asp-route-id=\"@book.Id\"&gt;\n                    &lt;img class=\"card-img-top\" src=\"~/images/covers/@(book.Id).jpg\" alt=\"@book.Title\" title=\"@book.Title\" /&gt;\n                &lt;/a&gt;\n\n                &lt;div class=\"card-body\"&gt;\n                    &lt;div class=\"card-title fw-bold mb-0\"&gt;\n                        @string.Join(\", \", book.Authors.Select(x =&gt; x.Name))\n                    &lt;/div&gt;\n                    &lt;p class=\"card-text\"&gt;\n                        @book.Title\n                    &lt;/p&gt;\n                &lt;/div&gt;\n                &lt;div class=\"card-footer text-end text-muted fw-bold small\"&gt;\n                    @(book.DiscountedPrice ?? book.Price)&amp;nbsp;Ft\n                &lt;/div&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    }\n&lt;/div&gt;\n</code></pre> </li> <li> <p>Itt azt vehetj\u00fck \u00e9szre, hogy a Razor szintaxissal a C# \u00e9s HTML k\u00f3dot vegy\u00edtj\u00fck: a <code>@</code> karakterek ut\u00e1n k\u00f6vetkez\u0151 k\u00f3dr\u00e9szletek m\u00e9g a szerveren, .NET-ben futnak le. Bej\u00e1rjuk a teljes k\u00f6nyv list\u00e1t, \u00e9s minden k\u00f6nyvet megjelen\u00edt\u00fcnk a fel\u00fcleten. \u00c9rdekess\u00e9g m\u00e9g a kiemelt <code>&lt;a&gt;</code> elem, ugyanis ez \u00fan. tag helper-ek seg\u00edts\u00e9g\u00e9vel \u00fatvonalat gener\u00e1l az elemhez. A tag helper-ek \u00faj szintaxisa a Razor-nak, seg\u00edts\u00e9g\u00fckkel komplexebb szerveroldali k\u00f3dot is futtathatunk, m\u00edg a HTML-\u00fcnk sz\u00e9p marad, megtartja val\u00f3s markup jelleg\u00e9t \u00e9s nem lesznek benne imperat\u00edv blokkok.</p> <p>Razor</p> <p>Hivatalos dokument\u00e1ci\u00f3 a Razor syntaxis-r\u00f3l</p> </li> <li> <p>Ind\u00edtsuk is el az alkalmaz\u00e1st</p> <p></p> <p>K\u00f6nyv lista a kezd\u0151 oldalon</p> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.2%20Main%20pages/","title":"4.2. F\u0151bb oldalak l\u00e9trehoz\u00e1sa","text":""},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.2%20Main%20pages/#42-fobb-oldalak-letrehozasa","title":"4.2. F\u0151bb oldalak l\u00e9trehoz\u00e1sa","text":""},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.2%20Main%20pages/#kategoria-fa","title":"Kateg\u00f3ria fa","text":"<p>K\u00e9sz\u00edts\u00fck el a kateg\u00f3riaf\u00e1t! A f\u00e1hoz sz\u00fcks\u00e9g\u00fcnk van az \u00f6sszes kateg\u00f3ri\u00e1ra, amelyeket megfelel\u0151en fogunk egym\u00e1s al\u00e1 rendezni. A kateg\u00f3riafa az <code>Index</code> oldalra ker\u00fcl, viszont \u00fagy val\u00f3s\u00edtjuk meg, hogy k\u00f6nnyen fel lehessen haszn\u00e1lni m\u00e1s oldalon is. Ehhez a kateg\u00f3riaf\u00e1t <code>ViewComponent</code>-k\u00e9nt k\u00e9sz\u00edtj\u00fck el, mert \u00edgy \u00f6sszek\u00f6thetj\u00fck az adatlek\u00e9r\u00e9st \u00e9s megjelen\u00edt\u00e9s\u00e9t \u00e9s egy \u00fajrafelhaszn\u00e1lhat\u00f3 komponenst tudunk k\u00e9sz\u00edteni. Hivatalos dokument\u00e1ci\u00f3: ViewComponent</p> <ol> <li>A kateg\u00f3ria fa megjelen\u00edt\u00e9s\u00e9hez sz\u00fcks\u00e9ges backend oldali k\u00f3d m\u00e1r k\u00e9szen van.</li> <li>Az adatmodell a <code>CategoryData</code>, amit a <code>BookShop.Transfer.Dtos</code> mapp\u00e1ban tal\u00e1lunk.</li> <li>A szolg\u00e1ltat\u00e1s interf\u00e9sze az <code>ICategoryService</code> a <code>BookShop.Bll.ServicesInterfaces</code> mapp\u00e1ban tal\u00e1lhat\u00f3</li> <li>A BLL service is k\u00e9szen van <code>CategoryService</code>, amit a <code>BookShop.Bll.Services</code> mapp\u00e1ban tal\u00e1lunk.</li> <li>A DI-ba is beregisztr\u00e1ltuk a BLL projektben tal\u00e1lhat\u00f3 <code>Wireup.cs</code> f\u00e1jlban.</li> <li>A kateg\u00f3ri\u00e1k sorrendez\u00e9s\u00e9n\u00e9l azt a tr\u00fckk\u00f6t haszn\u00e1ljuk ki, hogy az <code>Order</code> egy sztring \u00e9s a sorrendet egy ponttal elv\u00e1laszott sz\u00e1msor hat\u00e1rozza meg. Pl: 01.02 azt jelenti, hogy az 1-es kateg\u00f3ria alatt a 2. a sorrendben. Teh\u00e1t ha e szerint rendezz\u00fck akkor megfelel\u0151 sorrendben kapjuk meg a teljes list\u00e1t, \u00e9s a pontok sz\u00e1ma meghat\u00e1rozza a szintet is. \u00cdgy val\u00f3j\u00e1ban a <code>ParentCategory</code> \u00e9s <code>ChildCategories</code> navig\u00e1ci\u00f3s tulajdons\u00e1gokat nem is haszn\u00e1ljuk. (Csak azokkal is meg lehetne oldani, de az bonyolultabb k\u00f3dot ig\u00e9nyelne.)</li> <li> <p>A view component-eknek a k\u00f3dj\u00e1t speci\u00e1lis helyre kell tenni. Ehhez l\u00e9tre kell hozni a <code>BookShop.Web.RazorPage</code> projekt alatt egy <code>ViewComponents</code> k\u00f6nyvt\u00e1rat \u00e9s abba lehet elhelyezni a <code>CategoryListViewComponent.cs</code> f\u00e1jlt az al\u00e1bbi tartalommal:</p> CategoryListViewComponent.cs<pre><code>using BookShop.Bll.ServicesInterfaces;\nusing Microsoft.AspNetCore.Mvc;\n\nnamespace BookShop.Web.RazorPage.ViewComponents;\n\npublic class CategoryListViewComponent(ICategoryService categoryService) : ViewComponent\n{\n    public async Task&lt;IViewComponentResult&gt; InvokeAsync() \n    { \n        return View(await categoryService.GetCategoryTreeAsync()); \n    }\n}\n</code></pre> T\u00f6m\u00f6rebb met\u00f3dus le\u00edr\u00e1s az Expression-Bodied Methods haszn\u00e1lat\u00e1val <pre><code>public async Task&lt;IViewComponentResult&gt; InvokeAsync()\n        =&gt; View(await categoryService.GetCategoryTreeAsync());\n</code></pre> </li> <li> <p>A hozz\u00e1 tartoz\u00f3 n\u00e9zet is speci\u00e1lis helyre kell tenni. Ehhez a <code>BookShop.Web.RazorPage\\Pages</code> alatt hozzuk l\u00e9tre a <code>Components</code> k\u00f6nyvt\u00e1rat, azon bel\u00fcl pedig egy <code>CategoryList</code> k\u00f6nyvt\u00e1rat. Az\u00e9rt CategoryList a k\u00f6nyvt\u00e1r neve, mert a <code>CategoryListViewComponent</code>-hez tartozik. A f\u00e1jl neve legyen <code>Default.cshtml</code>, ami egy \u00fcres Razor view (Razor View\u2013Empty).</p> Default.cshtml<pre><code>@using BookShop.Transfer.Dtos\n@model IList&lt;CategoryData&gt;\n\n&lt;div class=\"categories\"&gt;\n    @foreach (var category in Model)\n    {\n        &lt;div class=\"category level-@category.Level\"&gt;\n            &lt;a asp-route-categoryId=\"@category.Id\"&gt;\n                @category.Name\n            &lt;/a&gt;\n        &lt;/div&gt;\n    }\n&lt;/div&gt;\n</code></pre> </li> <li> <p>A k\u00f3dban figyelj\u00fck meg, hogy a linket \u00fagy adjuk meg, hogy nincs benne <code>asp-page=\"Index\"</code>. Ezt az\u00e9rt csin\u00e1ljuk \u00edgy, hogy mindig arra az oldalra navig\u00e1ljon a link, amin \u00e9ppen vagyunk.</p> </li> <li> <p>A kateg\u00f3riaf\u00e1t jelenleg az Index oldalra szeretn\u00e9nk kitenni, ez\u00e9rt nyissuk meg az <code>Index.cshtml</code>-t \u00e9s val\u00f3j\u00e1ban a jelenlegi k\u00f3dot kell k\u00f6rbevenni div-ekkel \u00fagy, hogy legyen egy bal oldali has\u00e1b is, amiben a <code>CategoryList</code> ViewComponent-et meg tudjuk jelen\u00edteni. Ehhez az al\u00e1bbi m\u00f3dos\u00edt\u00e1s sz\u00fcks\u00e9ges:</p> <pre><code>&lt;div class=\"row\"&gt;\n    &lt;div class=\"col-md-3\"&gt;\n        @await Component.InvokeAsync(\"CategoryList\")\n    &lt;/div&gt;\n\n    &lt;div class=\"col-md-9\"&gt;\n        &lt;h2&gt;Leg\u00fajabb k\u00f6nyvek&lt;/h2&gt;\n        ...\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre> <p>A k\u00f3dban megadtuk, hogy a modell, amit megkapt egy <code>IList&lt;CategoryData&gt;</code> mert ezt adja vissza a <code>GetCategoryTreeAsync()</code>.</p> </li> <li> <p>A fenti p\u00e9ld\u00e1ban a egyszer\u0171 f\u00fcggv\u00e9nyh\u00edv\u00e1sk\u00e9nt ker\u00fclt be a view component. Azonban ez nem igaz\u00e1n illik a HTML vil\u00e1g\u00e1ba \u00edgy n\u00e9zz\u00fck meg, hogyan tudn\u00e1nk TagHelper-k\u00e9nt haszn\u00e1lni az elk\u00e9sz\u00edtett komponens\u00fcnket.</p> </li> <li> <p>El\u0151sz\u00f6r be kell regisztr\u00e1lni a <code>_ViewImports.cshtml</code>-be, hogy a mi assembly-nkben tal\u00e1lhat\u00f3 TagHelper-eket is haszn\u00e1lja. Ehhez vegy\u00fck fel az al\u00e1bbi k\u00f3dban az als\u00f3 sort:</p> <p><code>aspx-cs title=\"_ViewImports.cshtml\" hl_lnes=\"4\" @using BookShop.Web.RazorPage @namespace BookShop.Web.RazorPage.Pages @addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers @addTagHelper *, BookShop.Web.RazorPage</code></p> </li> <li> <p>Ezt k\u00f6vet\u0151en m\u00e1r az <code>Index.cshtml</code> oldalon tudjuk haszn\u00e1lni a TagHelper-\u00fcnket.</p> Index.cshtml<pre><code>&lt;div class=\"col-md-3\"&gt;\n     @await Component.InvokeAsync(\"CategoryList\") \n    &lt;vc:category-list /&gt;\n&lt;/div&gt;\n</code></pre> </li> <li> <p>A kateg\u00f3ri\u00e1kat \u00fagy jelen\u00edts\u00fck meg, hogy l\u00e1tsz\u00f3djon a beh\u00faz\u00e1s az alkateg\u00f3ri\u00e1k szerint. Ehhez a kateg\u00f3ri\u00e1t jelz\u0151 <code>div</code> elemekre m\u00e1r tett\u00fcnk egy category \u00e9s egy <code>level-X</code> oszt\u00e1lyt, ezeket defini\u00e1ljuk megfelel\u0151en az alkalmaz\u00e1shoz tartoz\u00f3 CSS f\u00e1jlunkban. Illetve \u00e1ll\u00edtsuk be azt is, hogy a linkek ne legyenek al\u00e1h\u00fazva. Az alkalmaz\u00e1s CSS f\u00e1jlj\u00e1ba <code>BookShop.Web.RazorPage\\wwwroot\\css\\site.css</code> vegy\u00fck fel az al\u00e1bbi szab\u00e1lyokat:</p> site.css<pre><code>.categories .category.level-1 {\n    padding-left: 0;\n}\n\n.categories .category.level-2 {\n    padding-left: 10px;\n}\n\n.categories .category.level-3 {\n    padding-left: 20px;\n}\n\n.categories &gt; .category &gt; a {\n    text-decoration: none;\n}\n</code></pre> <p>CSS-t \u00edrhatunk pl. SASS transpilerrel (.scss) is, ami t\u00f6bb lehet\u0151s\u00e9get biztos\u00edt fejleszt\u00e9shez, a fentit pl. \u00fan. mixinekkel tudn\u00e1nk gener\u00e1lni egy ciklusban. A st\u00edluslapok statikus f\u00e1jlok, amelyek alap\u00e9rtelmezetten cache-el\u0151dnek a b\u00f6ng\u00e9sz\u0151ben, ez\u00e9rt sz\u00fcks\u00e9ges lehet a cache \u00fcr\u00edt\u00e9se (Ctrl+F5 vagy Ctrl+R bizonyos b\u00f6ng\u00e9sz\u0151kben, vagy az F12 eszk\u00f6zt\u00e1r Network f\u00fcl\u00e9n be\u00e1ll\u00edthat\u00f3).</p> </li> <li> <p>\u00cdgy m\u00e1r megjelennek a kateg\u00f3ri\u00e1k, de hi\u00e1ba kattintunk egy kateg\u00f3ri\u00e1ra, az csak az URL-be teszi bele a <code>categoryId</code>-t viszont nem sz\u0171ri le a k\u00f6nyv list\u00e1t. Ehhez a <code>CategoryId</code> tulajdons\u00e1got fel kell venni a Page modellbe \u00e9s mivel HTTP GET k\u00e9r\u00e9sek eset\u00e9n is sz\u00fcks\u00e9ges, hogy a query string-b\u0151l kiolvassa ez\u00e9rt el\u00e9 kell tenni a <code>[BindProperty(SupportsGet = true)]</code> attrib\u00fatumot. Ezt k\u00f6vet\u0151en csak annyi dolgunk maradt, hogy a <code>GetBooksAsync</code>-nak is \u00e1tadjuk a <code>CategoryId</code>-t</p> Index.razor.cs<pre><code>public class IndexModel(IBookService bookService) : PageModel\n{\n    public IList&lt;BookData&gt; NewestBooks { get; set; } = [];\n    public IList&lt;BookData&gt; DiscountedBooks { get; set; } = [];\n    public IList&lt;BookData&gt; Books { get; private set; } = [];\n\n    [BindProperty(SupportsGet = true)]\n    public int? CategoryId { get; set; }\n\n    public async Task OnGet()\n    {\n        // Query book data from the BLL service\n        NewestBooks = await bookService.GetNewestBooksAsync(5);\n        DiscountedBooks = await bookService.GetDiscountedBooksAsync(5);\n        Books = await bookService.GetBooksAsync(CategoryId);\n    }\n}\n</code></pre> </li> <li> <p>Ezt k\u00f6vet\u0151en m\u00e1r csak annyi dolgunk van, hogy az aktu\u00e1lis kateg\u00f3ri\u00e1t valahogy vizu\u00e1lisan is emelj\u00fck ki a kateg\u00f3ria f\u00e1ban. Ehhez el\u0151sz\u00f6r a <code>CategoryListViewComponent</code>-ben az <code>InvokeAsync</code> met\u00f3dust eg\u00e9sz\u00edts\u00fck ki, hogy v\u00e1rja param\u00e9terk\u00e9nt a kiv\u00e1lasztott kateg\u00f3ri\u00e1t, \u00e9s a megkapott \u00e9rt\u00e9ket t\u00e1rolja ez a <code>ViewData</code>-ban</p> ViewData <p>A <code>ViewData</code> seg\u00edts\u00e9g\u00e9vel a <code>View</code>-nak tudunk \u00e1tadni kulcs-\u00e9rt\u00e9k p\u00e1rokat a modell mellett. Akkor hasznos a <code>ViewData</code> haszn\u00e1lata, ha nem szeretn\u00e9nk a <code>Model</code>-t kieg\u00e9sz\u00edteni, mert az \u00e1tadni k\u00edv\u00e1nt adat nem r\u00e9sze a modellnek. Mint eset\u00fcnkben a kiv\u00e1lasztott kateg\u00f3ria.</p> CategoryListViewComponent.cs<pre><code>public async Task&lt;IViewComponentResult&gt; InvokeAsync(int? categoryId)\n{ \n    ViewData[\"CategoryId\"] = categoryId;\n    return View(await categoryService.GetCategoryTreeAsync());\n}\n</code></pre> </li> <li> <p>Ezt k\u00f6vet\u0151en a komponenst megjelen\u00edt\u00e9s\u00e9t is m\u00f3dos\u00edtsuk. Ha az adott kateg\u00f3ria Id-ja megegyezik a <code>ViewData</code>-ban megkapott <code>CategoryId</code>-val akkor tegy\u00fcnk r\u00e1 egy <code>active</code> CSS oszt\u00e1lyt.</p> Default.cshtml<pre><code>&lt;div class=\"categories\"&gt;\n    @foreach (var category in Model)\n    {\n        &lt;div class=\"category level-@category.Level\"&gt;\n            &lt;a asp-route-categoryId=\"@category.Id\" \n                class=\"@((int?)ViewData[\"CategoryId\"] == category.Id ? \"active\" : \"\")\"&gt;\n                @category.Name\n            &lt;/a&gt;\n        &lt;/div&gt;\n    }\n&lt;/div&gt;\n</code></pre> </li> <li> <p>Ezt k\u00f6vet\u0151en m\u00e1r a kezd\u0151 oldal kell m\u00f3dos\u00edtani, hogy a kateg\u00f3ria fa komponens megkapja a kiv\u00e1lasztott kateg\u00f3ria Id-j\u00e1t. Mivel a query string-ben megkapott <code>categoryId</code>-t m\u00e1r elt\u00e1roljuk a modell <code>CategoryId</code> tulajdons\u00e1g\u00e1ban \u00edgy egyszer\u0171 a dolgunk.</p> Index.cshtml<pre><code>&lt;div class=\"col-md-3\"&gt;\n    &lt;vc:category-list category-id=\"@Model.CategoryId\" /&gt;\n&lt;/div&gt;\n</code></pre> </li> <li> <p>V\u00e9g\u00fcl a <code>site.css</code>-be vegy\u00fck le az <code>.active</code> selectorhoz tartoz\u00f3 form\u00e1z\u00e1st, ami jelen esetbe csak vastagg\u00e1 teszi a sz\u00f6veget. </p> site.css<pre><code>.active {\n    font-weight: bold;\n}\n</code></pre> </li> <li> <p>N\u00e9zz\u00fck meg az elk\u00e9sz\u00fclt kateg\u00f3ria f\u00e1t</p> </li> </ol> Elk\u00e9sz\u00fclt kateg\u00f3riafa <p></p> <p>Az elk\u00e9sz\u00fclt kateg\u00f3riafa</p>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.2%20Main%20pages/#lapozott-konyv-lista","title":"Lapozott k\u00f6nyv lista","text":"<p>Lapozott list\u00e1k megjelen\u00edt\u00e9se nagyon gyakori feladat, amit a BookShop projektben is meg kell val\u00f3s\u00edtanunk. A feladat nagyon j\u00f3l \u00e1ltal\u00e1nos\u00edthat\u00f3 a generikus list\u00e1k haszn\u00e1lat\u00e1val. Mi is egy ilyen megold\u00e1st fogunk elk\u00e9sz\u00edteni. Egy lapozott lista megjelen\u00edt\u00e9s\u00e9hez k\u00e9t feladatot kell megval\u00f3s\u00edtani. Egyfel\u0151l az adatb\u00e1zis lek\u00e9rdez\u00e9sn\u00e9l a <code>Skip()</code> \u00e9s <code>Take()</code> seg\u00edts\u00e9g\u00e9vel csak annyi adatot kell lek\u00e9rdezni az adatb\u00e1zisb\u00f3l, amennyit meg kell jelen\u00edteni, m\u00e1sfel\u0151l sz\u00fcks\u00e9ges egy lapoz\u00f3 komponensnek a megval\u00f3s\u00edt\u00e1sa, amivel az egyes oldalak k\u00f6z\u00f6tt tudunk navig\u00e1lni.</p> <ol> <li> <p>N\u00e9zz\u00fck meg a <code>BookShop.Transfer</code> projektben a <code>PagedList</code> oszt\u00e1lyt. Ez az oszt\u00e1ly fogja nyilv\u00e1ntartani egy adott oldalon megjelen\u0151 elemeket egy generikus list\u00e1ban \u00e9s azt, hogy \u00f6sszesen h\u00e1ny elem van.</p> PagedList.cs<pre><code>namespace BookShop.Transfer.Common;\n\npublic class PagedList&lt;T&gt;\n{\n    public int TotalItems { get; set; }\n\n    public IList&lt;T&gt; Items { get; set; } = [];\n}\n</code></pre> </li> <li> <p>N\u00e9zz\u00fck meg a <code>BookShop.Bll</code> projektben tal\u00e1lhat\u00f3 <code>PagedListHelper</code> met\u00f3dust. Ezt a b\u0151v\u00edt\u0151 met\u00f3dust meg tudjuk h\u00edvni egy query-n \u00e9s ha \u00e1tadjuk neki, hogy h\u00e1ny elemet k\u00e9rdezzen le \u00e9s mennyit ugorjon \u00e1t, akkor meg is kapjuk az aktu\u00e1lis oldalon l\u00e9v\u0151 elemeket \u00e9s az \u00f6sszes elemsz\u00e1mot.</p> PagedListHelper.cs<pre><code>using BookShop.Transfer.Common;\nusing Microsoft.EntityFrameworkCore;\n\nnamespace BookShop.Bll.Helpers;\n\npublic static class PagedListHelper\n{\n    public static async Task&lt;PagedList&lt;TQuery&gt;&gt; ToPagedListAsync&lt;TQuery&gt;(this IQueryable&lt;TQuery&gt; source, int? skip, int? top)\n    {\n        var totalItems = await source.CountAsync();\n\n        if (top is not null)\n            source = source.Skip(skip ?? 0).Take(top.Value);\n\n        return new PagedList&lt;TQuery&gt;\n        {\n            Items = await source.ToListAsync(),\n            TotalItems = totalItems\n        };\n    }\n}\n</code></pre> </li> <li> <p>A k\u00f3dban szerepel m\u00e9g egy <code>LoadDataArgs</code> oszt\u00e1ly is, amiben jelenleg egy <code>Skip</code> \u00e9s egy <code>Top</code> tulajdons\u00e1g szerepel.</p> LoadDataArgs.cs<pre><code>namespace BookShop.Transfer.Common;\n\npublic class LoadDataArgs\n{\n    /// &lt;summary&gt;\n    /// Gets how many items to skip. Related to paging and the current page. Usually used with the &lt;see cref=\"Enumerable.Skip{TSource}(IEnumerable{TSource}, int)\"/&gt; LINQ method.\n    /// &lt;/summary&gt;\n    public int? Skip { get; set; }\n\n    /// &lt;summary&gt;\n    /// Gets how many items to take. Related to paging and the current page size. Usually used with the &lt;see cref=\"Enumerable.Take{TSource}(IEnumerable{TSource}, int)\"/&gt; LINQ method.\n    /// &lt;/summary&gt;\n    /// &lt;value&gt;The top.&lt;/value&gt;\n    public int? Top { get; set; }\n}\n</code></pre> <p>Ezt arra haszn\u00e1ljuk, hogy amikor lapozott list\u00e1t kell bet\u00f6lteni, ezzel defini\u00e1ljuk, hogy a szerver h\u00e1ny elemet adjon vissza \u00e9s melyik oldalon.</p> </li> <li> <p>\u00cdgy m\u00e1r megn\u00e9zhetj\u00fck a <code>BookService</code>-ben a <code>GetBooksPagedAsync</code> met\u00f3dust, ami a fenti k\u00f3doknak h\u00e1la nagyon egyszer\u0171en vissza tudja adni az adott oldalon l\u00e9v\u0151 k\u00f6nyvek list\u00e1j\u00e1t.</p> BookService.cs<pre><code>public async Task&lt;PagedList&lt;BookData&gt;&gt; GetBooksPagedAsync(int? categoryId, LoadDataArgs? args)\n{\n    var books = await dbContext.Books\n        .Where(x =&gt; !categoryId.HasValue || x.CategoryId == categoryId.Value)\n        .OrderBy(x =&gt; x.Title)\n        .ProjectTo&lt;BookData&gt;(mapper.ConfigurationProvider)\n        .ToPagedListAsync(args?.Skip, args?.Top);\n\n    return books;\n}   \n</code></pre> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.2%20Main%20pages/#pager-viewcomponent","title":"Pager ViewComponent","text":"<p>Ahhoz, hogy t\u00e9nyleg lehessen lapozgatni a fel\u00fcleten k\u00e9sz\u00edteni kell egy \u00fajrafelhaszn\u00e1lhat\u00f3 komponenst, ami megjelen\u00edti a linkeket az egyes oldalakhoz. Teh\u00e1t k\u00e9sz\u00edten\u00fcnk kell egy <code>PagerViewComponent</code>-et.</p> <ol> <li> <p>A <code>BookShop.Web.RazorPage/ViewComponents</code> mapp\u00e1ban hozzuk l\u00e9tre a <code>PagerViewComponent.cs</code> f\u00e1jlt az al\u00e1bbi tartalommal</p> PagerViewComponent.cs<pre><code>using Microsoft.AspNetCore.Mvc;\n\nnamespace BookShop.Web.RazorPage.ViewComponents;\n\npublic class PagerViewComponent : ViewComponent\n{\n    public class PagerArgs\n    { \n        public int TotalItems { get; set; } \n        public int CurrentPage { get; set; } \n        public int PageSize { get; set; } = 10;\n        public int TotalPages { get; set; } \n        public int PagesToShow { get; set; } = 3;\n    }\n\n    public IViewComponentResult Invoke(int pageSize, int currentPage, int totalItems, int pagesToShow) \n    { \n        return View(new PagerArgs \n        { \n            PageSize = pageSize, \n            CurrentPage = currentPage,\n            TotalItems = totalItems, \n            TotalPages = (int)Math.Ceiling((double)totalItems / (double)pageSize), \n            PagesToShow = pagesToShow \n        }); \n    }\n}\n</code></pre> <p>Mint l\u00e1that\u00f3 a komponens megkapja az oldalm\u00e9retet, az aktu\u00e1lis oldal sz\u00e1m\u00e1t, az \u00f6sszes tal\u00e1lat sz\u00e1m\u00e1t \u00e9s egy olyan param\u00e9tert, hogy az aktu\u00e1lis oldal k\u00f6r\u00fcl mennyi linket kell megjelen\u00edteni. A c\u00e9l az al\u00e1bbi kin\u00e9zet\u0171 lapoz\u00f3 megval\u00f3s\u00edt\u00e1sa, teh\u00e1t egyszerre maximum 7 sz\u00e1mozott oldallink \u00e9s az els\u0151 / utols\u00f3 oldalra mutat\u00f3 linknek kell l\u00e1tsz\u00f3dnia. Term\u00e9szetesen az els\u0151 oldalon nem l\u00e1tsz\u00f3dik a <code>&lt;&lt;</code> az utols\u00f3 oldalon pedig a <code>&gt;&gt;</code> link, s\u0151t ha csak 1 oldal van, akkor az eg\u00e9sz lapoz\u00f3 nem l\u00e1tsz\u00f3dik. Figyelj\u00fck meg azt is, hogy a <code>PaperArgs</code> oszt\u00e1lyt a ViewComponent-en bel\u00fcl hoztuk l\u00e9tre, mert csak itt kell haszn\u00e1lni.</p> </li> <li> <p>A ViewComponent kin\u00e9zet\u00e9hez hozzuk l\u00e9tre a <code>BookShop.Web.RazorPage/Pages/Components</code> alatt a <code>Pager</code> k\u00f6nyvt\u00e1rat \u00e9s abban egy <code>Default.cshtml</code>-t (Razor View \u2013 Empty t\u00edpussal) az al\u00e1bbi tartalommal.</p> Default.cshtml<pre><code>@model BookShop.Web.RazorPage.ViewComponents.PagerViewComponent.PagerSpecification\n\n@{\n    // Read the query string parameters into a dictionary, and add the current page parameter (with empty string value) if not present.\n    Dictionary&lt;string, string&gt; allRouteData = Context.Request.Query.ToDictionary(q =&gt; q.Key, q =&gt; q.Value.ToString());\n    allRouteData[nameof(Model.CurrentPage)] = String.Empty;\n}\n\n@if (Model.TotalPages &gt; 1)\n{\n    &lt;nav&gt;\n        &lt;ul class=\"pagination justify-content-center\"&gt;\n            @* Link for the fist page. *@ \n            @if (Model.CurrentPage &gt; 1)\n            {\n                allRouteData[nameof(Model.CurrentPage)] = \"1\";\n                &lt;li class=\"page-item\"&gt;\n                    &lt;a asp-all-route-data=\"allRouteData\" class=\"page-link\"&gt;&lt;span&gt;&amp;laquo;&lt;/span&gt;&lt;/a&gt;\n                &lt;/li&gt;\n            }\n\n            @* Links in the middle with page numbers. *@\n            @for (var pageNumber = Math.Max(1, Model.CurrentPage - Model.PagesToShow); pageNumber &lt;= Math.Min(Model.TotalPages, Model.CurrentPage + Model.PagesToShow); pageNumber++)\n            {\n                @if (Model.CurrentPage == pageNumber)\n                {\n                    &lt;li class=\"page-item active\"&gt;&lt;a class=\"page-link\"&gt;@pageNumber&lt;/a&gt;&lt;/li&gt;\n                }\n                else\n                {\n                    allRouteData[nameof(Model.CurrentPage)] = pageNumber.ToString();\n\n                    &lt;li class=\"page-item\"&gt;\n                        &lt;a asp-all-route-data=\"allRouteData\" class=\"page-link\"&gt;@pageNumber&lt;/a&gt;\n                    &lt;/li&gt;\n                }\n            }\n\n            @* Link for the last page *@ \n            @if (Model.CurrentPage &lt; Model.TotalPages)\n            {\n                allRouteData[nameof(Model.CurrentPage)] = Model.TotalPages.ToString();\n                &lt;li class=\"page-item\"&gt;\n                    &lt;a asp-all-route-data=\"allRouteData\" class=\"page-link\"&gt;\n                        &lt;span aria-hidden=\"true\"&gt;&amp;raquo;&lt;/span&gt;\n                    &lt;/a&gt;\n                &lt;/li&gt;\n            }\n        &lt;/ul&gt;\n    &lt;/nav&gt;\n}\n</code></pre> </li> <li> <p>A fenti k\u00f3dban felt\u0171nhet, hogy nem a linkekn\u00e9l nem a megszokott <code>asp-route-currentPage=\"\"</code>-t haszn\u00e1ljuk, hanem a k\u00f3d elej\u00e9n a QueryString-b\u0151l \u00e9p\u00edt\u00fcnk egy allRouteData dictionary-t, amiben a <code>CurrentPage</code> \u00e9rt\u00e9ket m\u00f3dos\u00edtjuk a megfelel\u0151re \u00e9s a linkekben az  <code>asp-all-route-data=\"allRouteData\"</code>-t haszn\u00e1ljuk. Ennek az az oka, hogy csak az <code>all-route-data</code> haszn\u00e1lat\u00e1val tudjuk el\u00e9rni, hogy minden m\u00e1s QueryString param\u00e9ter megmaradjon, azok is, amit m\u00e1s \u00e1ll\u00edtott be. Ilyen p\u00e9ld\u00e1ul, ha egy kateg\u00f3ri\u00e1n bel\u00fcl lapozunk, hiszen ez a komponens a <code>currentPage</code>-t \u00e1ll\u00edtja csak m\u00edg a <code>CategoryList</code> komponenst be\u00e1ll\u00edtja a categoryId-t, amit nem szabad lapoz\u00e1skor elvesz\u00edteni.</p> </li> <li> <p>Az <code>Index.cshtml.cs</code> f\u00e1jlban</p> <ul> <li>vegy\u00fcnk fel egy <code>PagedBooks</code> tulajdons\u00e1got, amiben az lapozott lista elemek lesznek.</li> <li>Az <code>OnGet</code> v\u00e9g\u00e9n k\u00e9rdezz\u00fck le az adott oldal elmeit a <code>GetBooksPagedAsync</code>. A <code>CategoryId</code>-t itt is adjuk \u00e1t a lapoz\u00f3 be\u00e1ll\u00edt\u00e1sain fel\u00fcl.</li> <li>A sima Book list\u00e1t ak\u00e1r ki is kommentezhetj\u00fck, mert nem haszn\u00e1ljuk.</li> </ul> Index.cshtml.cs<pre><code>using BookShop.Bll.ServicesInterfaces;\nusing BookShop.Transfer.Common;\nusing BookShop.Transfer.Dtos;\nusing Microsoft.AspNetCore.Mvc;\nusing Microsoft.AspNetCore.Mvc.RazorPages;\n\nnamespace BookShop.Web.RazorPage.Pages;\n\npublic class IndexModel(IBookService bookService) : PageModel\n{\n    public IList&lt;BookData&gt; NewestBooks { get; set; } = [];\n    public IList&lt;BookData&gt; DiscountedBooks { get; set; } = [];\n    // public IList&lt;BookData&gt; Books { get; private set; } = [];\n\n    public PagedList&lt;BookData&gt; PagedBooks { get; private set; } = new();\n\n    public int PageSize { get; set; } = 10;\n\n    [BindProperty(SupportsGet = true)]\n    public int CurrentPage { get; set; } = 1;\n\n    [BindProperty(SupportsGet = true)]\n    public int? CategoryId { get; set; }\n\n    public async Task OnGet()\n    {\n        // Query book data from the BLL service\n        NewestBooks = await bookService.GetNewestBooksAsync(5);\n        DiscountedBooks = await bookService.GetDiscountedBooksAsync(5);\n        // Books = await bookService.GetBooksAsync(CategoryId);\n\n        PagedBooks = await bookService.GetBooksPagedAsync(CategoryId, new LoadDataArgs { Skip = (CurrentPage - 1) * PageSize, Top = PageSize });\n    }\n}\n</code></pre> </li> <li> <p>M\u00e1r csak annyi dolgunk van, hogy a kezd\u0151oldalra r\u00e1tegy\u00fck az elk\u00e9sz\u00edtett <code>PagerViewComponent</code>-et, \u00e9s a ciklusban a <code>Model.PagedBooks.Item</code>-en iter\u00e1ljunk v\u00e9gig, illve, hogy a tesztel\u00e9st k\u00f6nny\u00edts\u00fck \u00edrjuk ki a tal\u00e1latok sz\u00e1m\u00e1t is az oldalra. Ehhez m\u00f3dos\u00edtjuk az <code>Index.cshtml</code>-t az al\u00e1bbiak szerint</p> Index.cshtml<pre><code>&lt;h2&gt;A kateg\u00f3ria k\u00f6nyvei&lt;/h2&gt;\n\n&lt;div class=\"row row-cols-2 row-cols-md-3 row-cols-lg-4 row-cols-xl-5 g-4\"&gt;\n    @*  @foreach (var book in Model.Books)  *@\n    @foreach (var book in Model.PagedBooks.Items)\n    {\n        ...\n    }\n&lt;/div&gt;\n\n&lt;div class=\"card text-center border-0\"&gt;\n    &lt;div class=\"card-body\"&gt;\n        &lt;div class=\"mb-1\"&gt;\n            @Model.PagedBooks.TotalItems tal\u00e1lat\n        &lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;vc:pager page-size=\"Model.PageSize\"\n              current-page=\"Model.CurrentPage\"\n              total-items=\"Model.PagedBooks.TotalItems\"\n              pages-to-show=\"3\" /&gt;\n&lt;/div&gt;\n</code></pre> </li> <li> <p>Ind\u00edtsuk el az alkalmaz\u00e1st \u00e9s n\u00e9zz\u00fck meg az eredm\u00e9nyt.</p> Elk\u00e9sz\u00fclt kezd\u0151 oldal lapozott k\u00f6nyvlist\u00e1val <p></p> <p>Az elk\u00e9sz\u00fclt lapozott lista</p> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.2%20Main%20pages/#konyv-reszletes-oldal","title":"K\u00f6nyv r\u00e9szletes oldal","text":"<p>A k\u00f6nyvlist\u00e1z\u00f3 oldalon a k\u00e9pre kattintva kellene tudni eljutni a k\u00f6nyv r\u00e9szletes oldal\u00e1ra, azonban a link nem m\u0171k\u00f6dik, pedig be\u00e1ll\u00edtottuk, hogy a Book oldalra vigyen, \u00e9s megkapja a k\u00f6nyv ID-j\u00e1t is. Ha megn\u00e9zz\u00fck a HTML forr\u00e1st, azt l\u00e1tjuk, hogy a line <code>href</code> attrib\u00fatuma nincs be\u00e1ll\u00edtva, teh\u00e1t nem gener\u00e1l\u00f3dott le szerver oldalon a link, aminek az az oka, hogy m\u00e9g nem l\u00e9tezik a Book oldalunk.</p> <p></p> <p>Nincs be\u00e1ll\u00edtva a <code>href</code> attrib\u00fatum</p> <ol> <li>A <code>Pages</code> mapp\u00e1hoz adjunk hozz\u00e1 egy \u00faj <code>Razor Page</code>-et. A template-ek k\u00f6z\u00fcl v\u00e1lasszuk a Razor Page - Empty-t \u00e9s az oldal neve legyen <code>Book.cshtml</code></li> <li> <p>A k\u00f3dban constructor injection-nel k\u00e9rj\u00fck el a <code>IBookService</code> p\u00e9ld\u00e1nyt (haszn\u00e1ljuk a primary constructor-t) \u00e9s egy <code>Id</code> v\u00e1ltoz\u00f3hoz k\u00f6ss\u00fck hozz\u00e1 a query string-ben l\u00e9v\u0151 <code>id</code>-t.</p> Book.cshtml.cs<pre><code>using BookShop.Bll.ServicesInterfaces;\nusing Microsoft.AspNetCore.Mvc;\nusing Microsoft.AspNetCore.Mvc.RazorPages;\n\nnamespace BookShop.Web.RazorPage.Pages;\npublic class BookModel(IBookService bookService) : PageModel\n{\n    [BindProperty(SupportsGet = true)]\n    public int Id { get; set; }\n\n    public void OnGet()\n    {\n        // TODO: K\u00f6nyv adatainak lek\u00e9rdez\u00e9se\n    }\n}\n</code></pre> </li> <li> <p>Ezt k\u00f6vet\u0151en meg tudjuk \u00edrni a lek\u00e9rdez\u00e9st is, hogy az ID alapj\u00e1n kapjuk vissza a k\u00f6nyv adatait. Ehhez haszn\u00e1ljuk a <code>GetBookAsync</code> met\u00f3dust. \u00dcgyelj\u00fcnk r\u00e1, hogy aszinkron kell megh\u00edvni ezt a f\u00fcggv\u00e9nyt, ez\u00e9rt az <code>OnGetAsync</code>-ban kell megh\u00edvni.</p> Book.cshtml.cs<pre><code>public class BookModel(IBookService bookService) : PageModel\n{\n    [BindProperty(SupportsGet = true)]\n    public int Id { get; set; }\n\n    public BookData Book { get; set; } = null!;\n\n    public async Task OnGetAsync()\n    {\n        // Query the book details\n        Book = await bookService.GetBookAsync(Id);\n    }\n}\n</code></pre> </li> <li> <p>Ezut\u00e1n m\u00e1r csak meg kell jelen\u00edteni a k\u00f6nyv r\u00e9szletes adatait, amihez a <code>Book</code> tulajdons\u00e1got kell haszn\u00e1lnunk. Fontos, hogy az oldaln\u00e1l \u00e1ll\u00edtsuk be, hogy v\u00e1r egy <code>id</code>-t ami <code>int</code> t\u00edpus\u00fa. Ezzel azt \u00e9rj\u00fck el, hogy az <code>id</code> param\u00e9ter nem a query string-ben ker\u00fcl \u00e1tad\u00e1sra, hanem <code>/id</code>-k\u00e9nt azaz <code>Book/1</code> lesz a <code>Book?id=1</code></p> Book.cshtml<pre><code>@page \"{id:int}\"\n@model BookShop.Web.RazorPage.Pages.BookModel\n\n@{\n    ViewBag.Title = \"K\u00f6nyv - \" + Model.Book.Title;\n}\n\n&lt;h1 class=\"display-4 one-row\"&gt;\n    &lt;small&gt;@Model.Book.Title&lt;/small&gt;\n&lt;/h1&gt;\n\n&lt;div class=\"row\"&gt;\n    &lt;div class=\"col-md-3\"&gt;\n        &lt;img class=\"w-100 mb-2\" src=\"images/covers/@(Model.Book.Id).jpg\" alt=\"@Model.Book.Title\" title=\"@Model.Book.Title\" /&gt;\n        &lt;div class=\"d-flex justify-content-between align-items-center py-2\"&gt;\n            &lt;h4&gt;@(Model.Book.DiscountedPrice.HasValue ? Model.Book.DiscountedPrice : Model.Book.Price)&amp;nbsp;Ft&lt;/h4&gt;\n\n            &lt;form asp-page-handler=\"AddToCart\"&gt;\n                &lt;button class=\"btn btn-outline-primary\"&gt;Kor\u00e1rba&lt;/button&gt;\n            &lt;/form&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"text-center\"&gt;\n            &lt;a asp-page=\"CreateComment\" asp-route-bookId=\"@Model.Book.Id\"&gt;\u00daj aj\u00e1nl\u00f3 \u00edr\u00e1sa &amp;raquo;&lt;/a&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"col-md-9\"&gt;\n        @if (!String.IsNullOrWhiteSpace(Model.Book.Subtitle))\n        {\n            &lt;h3 class=\"one-row text-muted\"&gt;\n                &lt;small&gt;@Model.Book.Subtitle&lt;/small&gt;\n            &lt;/h3&gt;\n        }\n\n        &lt;div class=\"d-flex justify-content-between\"&gt;\n            &lt;div&gt;\n                &lt;h4 class=\"one-row\"&gt;\n                    @if (Model.Book.Authors == null || !Model.Book.Authors.Any())\n                    {\n                        @:Nincs megadva\n                    }\n                    else\n                    {\n                        foreach (var author in Model.Book.Authors)\n                        {\n                            &lt;a asp-page=\"/Index\" asp-route-authorId=\"@author.Id\"&gt;@author.Name&lt;/a&gt;\n                        }\n                    }\n                &lt;/h4&gt;\n\n                @if (Model.Book.Publisher != null)\n                {\n                    &lt;a asp-page=\"/Index\" asp-route-publisherId=\"@Model.Book.Publisher.Id\"&gt;@Model.Book.Publisher.Name&lt;/a&gt;\n                }\n            &lt;/div&gt;\n\n            &lt;div class=\"product-meta text-right\"&gt;\n                &lt;span&gt;Kiad\u00e1s&amp;nbsp;\u00e9ve:&amp;nbsp;@Model.Book.PublishYear.&lt;/span&gt;\n                &lt;br /&gt;\n                &lt;span&gt;Oldalsz\u00e1m:&amp;nbsp;@Model.Book.PageNumber&lt;/span&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;p class=\"py-2\"&gt;@Model.Book.ShortDescription&lt;/p&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre> </li> <li> <p>Figyelj\u00fck meg, a fenti k\u00f3dban az al\u00e1bbiakat</p> <ul> <li>Az oldal c\u00edm\u00e9t a <code>ViewBag.Title</code> seg\u00edts\u00e9g\u00e9vel tudjuk be\u00e1ll\u00edtani.</li> <li>A k\u00f6nyv adatai a <code>Model.Book</code>-en kereszt\u00fcl \u00e9rhet\u0151k el.</li> <li>Ha van kedvezm\u00e9nyes \u00e1r, akkor azt jelen\u00edtj\u00fck meg, ha nincs akkor a norm\u00e1l \u00e1rat</li> <li>A kor\u00e1rhoz ad\u00e1s egy gomb, aminek l\u00e9tre kell hozni egy \u0171rlapot. A <code>form</code> tagen meg kell adni az <code>asp-page-handler=\"AddToCart\"</code> ez jelzi, hogyha a gombra kattintanak akkor melyik esem\u00e9nykezel\u0151t kell futtatni.</li> <li>A szerz\u0151 \u00e9s kiad\u00f3 egy-egy link, ami jelenleg a kezd\u0151 oldalra ir\u00e1ny\u00edt \u00e1t, az URL-be belet\u00e9ve az <code>authorId</code> vagy <code>publisherId</code> param\u00e9tereket.</li> <li>A szerz\u0151k megjelen\u00edt\u00e9s\u00e9n\u00e9l kezelj\u00fck, azt az esetet is ha nincs szerz\u0151 megadva, illetve egy list\u00e1t v\u00e1runk el, \u00e9s minden szerz\u0151h\u00f6z egy k\u00fcl\u00f6n linket k\u00e9sz\u00edt\u00fcnk.</li> </ul> </li> <li> <p>Ha mindent j\u00f3l k\u00e9sz\u00edtett\u00fcnk el az al\u00e1bbi oldalt kapjuk</p> Elk\u00e9sz\u00fclt kezd\u0151 r\u00e9szletes oldal <p></p> <p>Az elk\u00e9sz\u00edtett k\u00f6nyv r\u00e9szletes oldal</p> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.2%20Main%20pages/#kosarkezeles","title":"Kos\u00e1rkezel\u00e9s","text":"<p>A k\u00f6nyv r\u00e9szletes oldalon m\u00e1r megtal\u00e1lhat\u00f3 a Kos\u00e1rba gomb viszont ez m\u00e9g nem csin\u00e1l semmit. K\u00e9sz\u00edts\u00fck el a kosaram oldalt, illetve val\u00f3s\u00edtsuk meg a kos\u00e1rba t\u00e9tel funkci\u00f3t is. A kos\u00e1rban l\u00e9v\u0151 elemeket t\u00e1rolhatn\u00e1nk adatb\u00e1zisban, ami egy j\u00f3 megold\u00e1s. Azonban most m\u00e9gsem ezt a bevett megold\u00e1st v\u00e1lasztjuk, hogy megismerkedhess\u00fcnk a Session haszn\u00e1lat\u00e1val, ami a szerver mem\u00f3ri\u00e1j\u00e1ban t\u00e1rolja a kos\u00e1rba tett elemeket.</p> Session <p>Amikor a felhaszn\u00e1l\u00f3 ell\u00e1togat egy weboldalra elindul egy munkamenet (session). Az ASP.NET lehet\u0151s\u00e9get ad arra, hogy a felhaszn\u00e1l\u00f3hoz tartoz\u00f3 adatokat ne a cookie-ban hanem egy \u00fagynevezett session-ben t\u00e1roljuk el. Ilyenkor az adat a szerveren t\u00e1rol\u00f3dik (alap\u00e9rtelmez\u00e9s szerint a mem\u00f3ri\u00e1ban, de lehet elosztott is ak\u00e1r egy Redis cache) \u00e9s csak egy sessionID utazik a s\u00fctiben, (vagy ak\u00e1r az URL-ben) ami azonos\u00edtja a felhaszn\u00e1l\u00f3hoz tartoz\u00f3 session p\u00e9ld\u00e1nyt, \u00edgy azt a szerveren b\u00e1rmikor el\u00e9rhetj\u00fck. Fontos azonban, hogy ha a felhaszn\u00e1l\u00f3 nem haszn\u00e1lja az oldalt (kb 20 percig) akkor a session t\u00f6rl\u0151dik a szerver mem\u00f3ri\u00e1j\u00e1b\u00f3l. Hivatalos dokument\u00e1ci\u00f3: Session</p> <ol> <li> <p>A <code>_Layout.cshtml</code> oldalon a men\u00fcbe vegy\u00fck fel egy Kosaram linket.</p> _Layout.cshtml<pre><code>&lt;nav class=\"navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow mb-3\"&gt;\n    &lt;div class=\"container\"&gt;\n        &lt;a class=\"navbar-brand\" asp-area=\"\" asp-page=\"/Index\"&gt;BookShop.Web.RazorPage&lt;/a&gt;\n        &lt;button class=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\".navbar-collapse\" aria-controls=\"navbarSupportedContent\"\n                aria-expanded=\"false\" aria-label=\"Toggle navigation\"&gt;\n            &lt;span class=\"navbar-toggler-icon\"&gt;&lt;/span&gt;\n        &lt;/button&gt;\n        &lt;div class=\"navbar-collapse collapse d-sm-inline-flex justify-content-between\"&gt;\n            &lt;ul class=\"navbar-nav flex-grow-1\"&gt;\n                &lt;li class=\"nav-item\"&gt;\n                    &lt;a class=\"nav-link text-dark\" asp-area=\"\" asp-page=\"/Index\"&gt;Home&lt;/a&gt;\n                &lt;/li&gt;\n                &lt;li class=\"nav-item\"&gt;\n                    &lt;a class=\"nav-link text-dark\" asp-area=\"\" asp-page=\"/Privacy\"&gt;Privacy&lt;/a&gt;\n                &lt;/li&gt;\n                &lt;li class=\"nav-item\"&gt;\n                    &lt;a class=\"nav-link text-dark\" asp-area=\"\" asp-page=\"/Cart\"&gt;Kosaram&lt;/a&gt;\n                &lt;/li&gt;\n            &lt;/ul&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/nav&gt;\n</code></pre> </li> <li> <p>Az k\u00f6nyv r\u00e9szletes oldal\u00e1n Pages/Book.cshtml m\u00e1r van egy kos\u00e1rba gombunk, ami meg is h\u00edvja az <code>OnPostAddToCart</code> handler-t, amit m\u00e9g nem k\u00e9sz\u00edtett\u00fcnk el. Most ezt fogjuk megtenni. A Kos\u00e1rba gombra kattintva a <code>Session</code>-ben fogjuk gy\u0171jteni a term\u00e9keket. Eg\u00e9szen pontosan a term\u00e9k azonos\u00edt\u00f3j\u00e1t, \u00e1r\u00e1t \u00e9s darabsz\u00e1m\u00e1t. K\u00e9sz\u00edts\u00fck is el hozz\u00e1 a sz\u00fcks\u00e9ges modell oszt\u00e1lyt a <code>BookShop.Web.RazorPage/Models</code> k\u00f6nyvt\u00e1rban <code>CartItem.cs</code> n\u00e9vvel.</p> CartItem.cs<pre><code>namespace BookShop.Web.RazorPage.Models;\n\npublic class CartItem\n{\n    public int BookId { get; set; }\n\n    public int Price { get; set; }\n\n    public int Count { get; set; }\n}\n</code></pre> </li> <li> <p>Ezt k\u00f6vet\u0151en a feladatunk annyi lesz, hogyha r\u00e1kattintanak a Kos\u00e1rba gombra, akkor a <code>Session</code>-ben t\u00e1roljuk el egy \u00faj <code>CartItem</code>-et. Ehhez el\u0151sz\u00f6r kapcsoljuk be el\u0151sz\u00f6r a Session-t a <code>Program.cs</code>-ben. Ehhez el\u0151sz\u00f6r az <code>AddDistributedMemoryCache</code>-t kell megh\u00edvni, hiszen mem\u00f3ri\u00e1ban fogjuk t\u00e1rolni a session-t, majd pedig az <code>AddSession</code>-t amiben az options pattern seg\u00edts\u00e9g\u00e9vel be\u00e1ll\u00edthatjuk hogyan viselkedjen a sessionId-t tartalmaz\u00f3 s\u00fcti, vagy mennyi legyen a session lej\u00e1rati ideje.</p> Program.cs<pre><code>// ...\n\n// Add services to the container.\nbuilder.Services.AddRazorPages();\n\nbuilder.Services.AddDistributedMemoryCache();\n\nbuilder.Services.AddSession(options =&gt;\n{\n    // options.IdleTimeout = TimeSpan.FromMinutes(20);\n    options.Cookie.HttpOnly = true;\n    options.Cookie.IsEssential = true;\n});\n\nvar app = builder.Build();\n\n// ..\n\napp.UseRouting();\n\napp.UseAuthorization();\n\napp.UseSession();\n\napp.MapStaticAssets();\napp.MapRazorPages()\n.WithStaticAssets();\n\napp.Run();\n</code></pre> </li> <li> <p>Mivel komplex objektumot szeretn\u00e9nk a session-ben t\u00e1rolni ez\u00e9rt \u00e9rdemes elk\u00e9sz\u00edteni az al\u00e1bbi k\u00e9t b\u0151v\u00edt\u0151met\u00f3dust, ami a komplex objektumot JSON-ba soros\u00edtva t\u00e1rolja el a sessionben, illetve onnan t\u00edpusosan olvassa vissza. Ehhez hozzuk l\u00e9tre a BookShop.Web.RazorPage/Extensions/SessionExtension.cs oszt\u00e1lyt az al\u00e1bbi tartalommal</p> SessionExtensions.cs<pre><code>using System.Text.Json;\n\nnamespace BookShop.Web.RazorPage.Extensions;\n\npublic static class SessionExtension\n{\n    public static void Set&lt;T&gt;(this ISession session, string key, T value)\n    {\n        session.SetString(key, JsonSerializer.Serialize(value));\n    }\n\n    public static T? Get&lt;T&gt;(this ISession session, string key)\n    {\n        var value = session.GetString(key);\n        return value == null ? default : JsonSerializer.Deserialize&lt;T&gt;(value);\n    }\n}\n</code></pre> </li> <li> <p>Ezt k\u00f6vet\u0151en m\u00e1r csak haszn\u00e1lni kell a fenti k\u00e9t met\u00f3dust a <code>Book.cshtml.cs</code> f\u00e1jl <code>OnPostAddToCart()</code> met\u00f3dus\u00e1ban.</p> Book.cshtml.cs<pre><code>public async Task&lt;IActionResult&gt; OnPostAddToCartAsync(int bookId) \n{\n    var cart = HttpContext.Session.Get&lt;List&lt;CartItem&gt;&gt;(\"Cart\") ?? [];\n\n    var book = await bookService.GetBookAsync(bookId);\n\n    var cartItem = cart.SingleOrDefault(c =&gt; c.BookId == book.Id);\n\n    if (cartItem != null)\n    {\n        cartItem.Count++;\n    }\n    else\n    {\n        cartItem = new CartItem \n        { \n            BookId = book.Id, \n            Count = 1, \n            Price = book.DiscountedPrice ?? book.Price \n        };\n\n        cart.Add(cartItem);\n    }\n\n    HttpContext.Session.Set(\"Cart\", cart);\n\n    return new RedirectToPageResult(\"/Book\", new { id = book.Id });\n}\n</code></pre> </li> <li> <p>A fenti k\u00f3dban sz\u00fcks\u00e9g\u00fcnk van a kos\u00e1rba tett k\u00f6nyv azonos\u00edt\u00f3j\u00e1ra, \u00edgy m\u00f3dos\u00edtani kell a cshtml-t is, hogy egy rejtett mez\u0151ben adja \u00e1t a k\u00f6nyv azonos\u00edt\u00f3j\u00e1t.</p> Book.cshtml<pre><code>&lt;form asp-page-handler=\"AddToCart\"&gt;\n    &lt;input type=\"hidden\" name=\"bookId\" value=\"@Model.Book.Id\" /&gt;\n    &lt;button class=\"btn btn-outline-primary\"&gt;Kor\u00e1rba&lt;/button&gt;\n&lt;/form&gt;\n</code></pre> </li> <li> <p>Ahhoz, hogy l\u00e1ssuk be is ker\u00fclt a kos\u00e1rba az elem m\u00f3dos\u00edtsuk a Layout oldalt \u00fagy, hogy a Kosaram m\u00f6g\u00f6tt \u00edrja ki a benne l\u00e9v\u0151 elemek sz\u00e1m\u00e1t - ha van benne elem - egy badge-ben.</p> <pre><code>&lt;li class=\"nav-item position-relative\"&gt;\n    &lt;a class=\"nav-link text-dark\" asp-area=\"\" asp-page=\"/Cart\"&gt;\n        Kosaram\n        @if (Context.Session.Get&lt;List&lt;CartItem&gt;&gt;(\"Cart\")?.Any() == true)\n        {\n            &lt;span class=\"position-absolute start-100 translate-middle badge rounded-pill bg-danger\"&gt;\n                @(Context.Session.Get&lt;List&lt;CartItem&gt;&gt;(\"Cart\")?.Sum(x =&gt; x.Count) ?? 0)\n                &lt;span class=\"visually-hidden\"&gt;elem a kos\u00e1rban&lt;/span&gt;\n            &lt;/span&gt;\n        }\n    &lt;/a&gt;\n&lt;/li&gt;\n</code></pre> </li> <li> <p>Ahogy a fenti k\u00f3dban l\u00e1tjuk most a Session kulcsot t\u00f6bb helyen beledr\u00f3toztuk az k\u00f3dba, \u00edgy neh\u00e9z lehet azt megv\u00e1ltoztatni. A sz\u00e9p megold\u00e1s ilyenkor, hogy felvesz\u00fcnk egy pl.: <code>BookShopConstants</code> oszt\u00e1lyt \u00e9s ott gy\u0171jtj\u00fck \u00f6ssze az \u00f6sszes magic konstanst \u00e9s azt haszn\u00e1ljuk.</p> <pre><code>namespace BookShop.Web.RazorPage.Models;\n\npublic class BookShopConstants\n{\n    public const string CartSessionKey = \"Cart\";\n}\n</code></pre> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.2%20Main%20pages/#kosaram-oldal","title":"Kosaram oldal","text":"<p>A k\u00f6vetkez\u0151 l\u00e9p\u00e9s, hogy meg is tudjuk mutatni, hogy pontosan milyen k\u00f6nyvek vannak a kos\u00e1rban.</p> <ol> <li> <p>Mivel az oldalon szeretn\u00e9nk ikonokat is haszn\u00e1lni (+ \u00e9s - gombok) ez\u00e9rt el\u0151sz\u00f6r adjuk hozz\u00e1 a projekthez a Bootstrap icons-t</p> <ul> <li>T\u00f6lts\u00fck le a fenti oldal legalj\u00e1n l\u00e9v\u0151 \"Download latest ZIP\" gombbal az ikonokat.</li> <li> <p>A let\u00f6lt\u00f6tt f\u00e1jlt tartalm\u00e1t m\u00e1soljuk be a <code>BookShop.Web.RazorPage</code> projekt <code>wwwroot/lib/bootstrap-icon</code> k\u00f6nyvt\u00e1r\u00e1ban. A <code>svg</code> f\u00e1jlokat nem sz\u00fcks\u00e9ges odam\u00e1solni, mert azt nem fogjuk haszn\u00e1lni.</p> Bootstrap ikonok a projektben <p></p> <p>Bootstrap ikonok a projektben</p> </li> <li> <p>Ezt k\u00f6vet\u0151en a <code>_Layout.cshtml</code> oldalon linkelj\u00fck be a CSS f\u00e1jlt.</p> _Layout.cshtml<pre><code>&lt;head&gt;\n    &lt;meta charset=\"utf-8\" /&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /&gt;\n    &lt;title&gt;@ViewData[\"Title\"] - BookShop.Web.RazorPage&lt;/title&gt;\n    &lt;script type=\"importmap\"&gt;&lt;/script&gt;\n    &lt;link rel=\"stylesheet\" href=\"~/lib/bootstrap/dist/css/bootstrap.min.css\" /&gt;\n    &lt;link rel=\"stylesheet\" href=\"~/lib/bootstrap-icons/bootstrap-icons.min.css\" /&gt;\n    &lt;link rel=\"stylesheet\" href=\"~/css/site.css\" asp-append-version=\"true\" /&gt;\n    &lt;link rel=\"stylesheet\" href=\"~/BookShop.Web.RazorPage.styles.css\" asp-append-version=\"true\" /&gt;\n&lt;/head&gt;\n</code></pre> </li> </ul> </li> <li> <p>Ezt k\u00f6vet\u0151en hozzuk l\u00e9tre a <code>Pages</code> alatt <code>Cart</code> oldalt. Ez is Razor Page Empty t\u00edpus\u00fa legyen.</p> </li> <li> <p>Az oldal k\u00f3dja meglehet\u0151sen egyszer\u0171, hiszen az <code>OnGet</code>-ben ki kell olvasni a Session-b\u0151l az elt\u00e1rolt kos\u00e1r tartalm\u00e1t, amihez m\u00e1r tudjuk haszn\u00e1lni a <code>SessionExtensions</code>-t illetve a <code>BookShopConstants</code>-t, majd le kell k\u00e9rdezni az <code>IBookService</code>-en kereszt\u00fcl a k\u00f6nyvek adatait az adatb\u00e1zisb\u00f3l, amihez a <code>GetBookHeadersAsync</code>-ot tudjuk haszn\u00e1lni.</p> Cart.cshtml.cs<pre><code>using BookShop.Bll.ServicesInterfaces;\nusing BookShop.Transfer.Dtos;\nusing BookShop.Web.RazorPage.Extensions;\nusing BookShop.Web.RazorPage.Models;\nusing Microsoft.AspNetCore.Mvc.RazorPages;\n\nnamespace BookShop.Web.RazorPage.Pages;\n\npublic class CartModel(IBookService bookService) : PageModel\n{\n    public IList&lt;CartItem&gt; Cart { get; set; } = null!;\n    public IList&lt;BookHeader&gt; Books { get; set; } = [];\n\n    public async Task OnGet() \n    { \n        Cart = HttpContext.Session.Get&lt;IList&lt;CartItem&gt;&gt;(BookShopConstants.CartSessionKey) ?? [];\n\n        var bookIds = Cart.Select(ci =&gt; ci.BookId).ToList();\n        Books = await bookService.GetBookHeadersAsync(bookIds) ?? [];\n    }\n}\n</code></pre> </li> <li> <p>Ezt k\u00f6vet\u0151en a megjelen\u00edt\u00e9st is k\u00e9sz\u00edts\u00fck el. A megjelen\u00edt\u00e9s a Bootstrap card-ot haszn\u00e1ljuk, csak itt a k\u00e9p a bal oldalon lesz nem fel\u00fcl.</p> <ul> <li>Iter\u00e1ljunk v\u00e9gig a kos\u00e1r elemein amit a <code>Model.Cart</code>-ban \u00e9r\u00fcnk el.</li> <li>V\u00e1lasszuk ki az adott kos\u00e1relemhez tartoz\u00f3 k\u00f6nyvet a <code>Model.Books</code> tulajdons\u00e1gb\u00f3l.</li> <li>A card-footer-be tegy\u00fck az egys\u00e9g\u00e1rat \u00e9s a mennyis\u00e9get egy + \u00e9s - gombbal. Ide egyedi form\u00e1z\u00e1s sz\u00fcks\u00e9ges, hogy sz\u00e9pen jelenjen meg. Mivel a + \u00e9s - gomboknak el kell k\u00fcldeni a szerverre, hogy melyik k\u00f6nyv\u00f6n nyomtuk meg, mindenk\u00e9ppen egy <code>form</code>-ba kell tenni \u00e9s a route param\u00e9terek k\u00f6z\u00f6tt \u00e1t kell adni a k\u00f6nyv azonos\u00edt\u00f3j\u00e1t.</li> <li>Vegy\u00fck fel egy <code>Elt\u00e1vol\u00edt\u00e1s</code> gombot is.</li> <li>V\u00e9g\u00fcl \u00edrjuk ki az teljes \u00e1rat. Itt arra kell figyelni, hogy egy k\u00f6nyvb\u0151l t\u00f6bbet is rendelhet\u00fcnk.</li> </ul> Cart.cshtml<pre><code>@page\n@model BookShop.Web.RazorPage.Pages.CartModel\n\n@{\n    ViewBag.Title = \"Kosaram\";\n}\n\n&lt;h2&gt;Kosaram&lt;/h2&gt;\n\n@foreach (var item in Model.Cart)\n{\n    // Query the book header (the Books property is populated in the PageModel, from the database)\n    var book = Model.Books.Single(b =&gt; b.Id == item.BookId);\n\n    &lt;div class=\"card flex-row mb-2\"&gt;\n        &lt;img src=\"@(\"/images/covers/\" + item.BookId + \".jpg\")\" class=\"img-fluid rounded-start\" alt=\"@book.Title\" title=\"@book.Title\" /&gt;\n\n        &lt;div class=\"card-body\"&gt;\n            &lt;h5 class=\"card-title\"&gt;\n                &lt;a asp-page=\"Book\" asp-route-id=\"@book.Id\"&gt;@book.Title&lt;/a&gt;\n                @if (!String.IsNullOrWhiteSpace(book.Subtitle))\n                {\n                    &lt;br /&gt;\n                    &lt;small&gt;@book.Subtitle&lt;/small&gt;\n                }\n            &lt;/h5&gt;\n\n            &lt;p class=\"card-text\"&gt;\n                &lt;small&gt;\n                    @foreach (var author in book.Authors)\n                    {\n                        &lt;a asp-page=\"Book\" asp-route-authorId=\"@author.Id\"&gt;@author.Name&lt;/a&gt;\n                    }\n                &lt;/small&gt;\n            &lt;/p&gt;\n\n        &lt;/div&gt;\n        &lt;div class=\"card-footer border-top-0 border-start\"&gt;\n            &lt;div class=\"mb-3\"&gt;Egys\u00e9g\u00e1r: &lt;b&gt;@item.Price.ToString(\"N0\") Ft&lt;/b&gt;&lt;/div&gt;\n\n            &lt;div class=\"d-flex align-items-center justify-content-center mb-3\"&gt;\n                &lt;form asp-page-handler=\"Decrement\" asp-route-bookId=\"@item.BookId\"&gt;\n                    &lt;button class=\"btn btn-outline-info btn-sm me-2\"&gt;&lt;i class=\"bi bi-dash\"&gt;&lt;/i&gt;&lt;/button&gt;\n                &lt;/form&gt;\n\n                &lt;b&gt;@item.Count db&lt;/b&gt;\n                &lt;form asp-page-handler=\"Increment\" asp-route-bookId=\"@item.BookId\"&gt;\n                    &lt;button class=\"btn btn-outline-info btn-sm ms-2\"&gt;&lt;i class=\"bi bi-plus\"&gt;&lt;/i&gt;&lt;/button&gt;\n                &lt;/form&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"d-flex justify-content-center\"&gt;\n                &lt;form asp-page-handler=\"RemoveFromCart\" asp-route-bookId=\"@item.BookId\"&gt;\n                    &lt;button class=\"btn btn-outline-danger btn-sm ms-2\"&gt;&lt;i class=\"bi bi-trash\"&gt;&lt;/i&gt; Elt\u00e1vol\u00edt\u00e1s&lt;/button&gt;\n                &lt;/form&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n}\n&lt;div class=\"d-flex justify-content-end me-3\"&gt;\n    \u00d6sszesen:&amp;nbsp;&lt;b&gt;@Model.Cart.Sum(book =&gt; book.Price * book.Count).ToString(\"N0\") Ft&lt;/b&gt;\n&lt;/div&gt;\n</code></pre> </li> <li> <p>K\u00e9sz\u00edts\u00fck el a +, - \u00e9s Elt\u00e1vol\u00edt\u00e1s gombok esem\u00e9nykezel\u0151j\u00e9t is.</p> <pre><code>public IActionResult OnPostDecrement(int bookId)\n{\n    var cart = HttpContext.Session.Get&lt;IList&lt;CartItem&gt;&gt;(BookShopConstants.CartSessionKey) ?? [];\n\n    var cartItem = cart.Single(c =&gt; c.BookId == bookId);\n\n    if (cartItem.Count == 1)\n        cart.Remove(cartItem);\n    else\n        cartItem.Count--;\n\n    HttpContext.Session.Set(BookShopConstants.CartSessionKey, cart);\n\n    return new RedirectToPageResult(\"Cart\");\n}\n\npublic IActionResult OnPostIncrement(int bookId)\n{\n    var cart = HttpContext.Session.Get&lt;IList&lt;CartItem&gt;&gt;(BookShopConstants.CartSessionKey) ?? [];\n\n    var cartItem = cart.Single(c =&gt; c.BookId == bookId);\n    cartItem.Count++;\n\n    HttpContext.Session.Set(BookShopConstants.CartSessionKey, cart);\n\n    return new RedirectToPageResult(\"Cart\");\n}\n\npublic IActionResult OnPostRemoveFromCart(int bookId)\n{\n    var cart = HttpContext.Session.Get&lt;IList&lt;CartItem&gt;&gt;(BookShopConstants.CartSessionKey) ?? [];\n\n    var cartItem = cart.Single(c =&gt; c.BookId == bookId);\n    cart.Remove(cartItem);\n\n    HttpContext.Session.Set(BookShopConstants.CartSessionKey, cart);\n\n    return new RedirectToPageResult(\"Cart\");\n}\n</code></pre> </li> <li> <p>Pr\u00f3b\u00e1ljuk is ki az oldalt. Ehhez el\u0151sz\u00f6r tegy\u00fcnk a kos\u00e1rba egy p\u00e1r k\u00f6nyvet, majd pr\u00f3b\u00e1ljuk ki a Kos\u00e1r oldalon a gombokat.</p> Az elk\u00e9sz\u00edtett kos\u00e1r oldal <p></p> <p>K\u00e9sz kos\u00e1r oldal</p> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.2%20Main%20pages/#hozzaszolasok","title":"Hozz\u00e1sz\u00f3l\u00e1sok","text":"<p>A felhaszn\u00e1l\u00f3k a k\u00f6nyvekhez hozz\u00e1sz\u00f3l\u00e1sokat (\u00e9s aj\u00e1nl\u00f3kat is \u00edrhatnak). Minden a k\u00e9t esetben az <code>ICommentService</code>-t haszn\u00e1ljuk, mert a k\u00e9t t\u00edpus\u00fa komment k\u00f6z\u00f6tt csak a <code>CommentType</code> \u00e9rt\u00e9ke elt\u00e9r\u0151.</p>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.2%20Main%20pages/#hozzaszolasok-listazasa","title":"Hozz\u00e1sz\u00f3l\u00e1sok list\u00e1z\u00e1sa","text":"<ol> <li> <p>A k\u00f6nyv r\u00e9szletes oldalon injekt\u00e1ljuk az <code>ICommentService</code>-t \u00e9s az <code>OnGetAsync</code>-ban k\u00e9rdezz\u00fck le a k\u00f6nyvh\u00f6z tartoz\u00f3 kommenteket a <code>GetCommentsAsync</code> seg\u00edts\u00e9g\u00e9vel</p> Book.cshtml.cs<pre><code>public class BookModel(IBookService bookService, ICommentService commentService) : PageModel\n{\n    [BindProperty(SupportsGet = true)]\n    public int Id { get; set; }\n\n    public BookData Book { get; set; } = null!;\n\n    public IList&lt;CommentData&gt; Comments { get; set; } = [];\n\n    public async Task OnGetAsync()\n    {\n        // Query the book details\n        Book = await bookService.GetBookAsync(Id);\n\n        Comments = await commentService.GetCommentsAsync(Id, CommentType.Comment);\n    }\n\n    // ...\n}\n</code></pre> </li> <li> <p>Ezt k\u00f6vet\u0151en jelen\u00edts\u00fck is meg a kommenteket, ehhez v\u00e9gig kell iter\u00e1lni a <code>Model.Comments</code>-en \u00e9s az egyes elemekhez bal oldalra kitenni egy <code>bi-person-square</code> bootstrap ikont, al\u00e1 pedig a hozz\u00e1sz\u00f3l\u00e1s d\u00e1tum\u00e1t \u00e9s idej\u00e9t, jobb oldalra pedig mag\u00e1t a hozz\u00e1sz\u00f3l\u00e1s sz\u00f6veg\u00e9t, ami egy sima sz\u00f6veg HTML tartalom n\u00e9lk\u00fcl.</p> Book.cshtml<pre><code>&lt;h3&gt;Kommentek&lt;/h3&gt;\n\n&lt;div class=\"comments my-2\"&gt;\n    @foreach (var comment in Model.Comments) \n    {\n        &lt;div class=\"comment d-flex p-3\"&gt;\n            &lt;div class=\"d-flex flex-column align-items-center justify-content-center flex-shrink-0 me-3\"&gt;\n                &lt;i class=\"bi bi-person-square fs-1\"&gt;&lt;/i&gt;\n                div class=\"text-muted\"&gt;@(comment.CreatedDate.DateTime.ToShortDateString())&lt;/div&gt;\n                &lt;div class=\"text-muted\"&gt;@(comment.CreatedDate.DateTime.ToShortTimeString())&lt;/div&gt;\n            &lt;/div&gt;\n            &lt;div class=\"w-100\"&gt;\n                @comment.Text\n            &lt;/div&gt;\n        &lt;/div&gt;\n    }\n&lt;/div&gt;\n</code></pre> </li> <li> <p>Ha mindent j\u00f3l csin\u00e1ltunk az 1-es ID-j\u00fa k\u00f6nyvn\u00e9l megjelenik kett\u0151 komment.</p> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.2%20Main%20pages/#hozzaszolas-letrehozasa","title":"Hozz\u00e1sz\u00f3l\u00e1s l\u00e9trehoz\u00e1sa","text":"<ol> <li>K\u00e9sz\u00edts\u00fck el az \u00faj hozz\u00e1sz\u00f3l\u00e1s r\u00e9szt is. Ehhez a <code>CreateCommentData</code> DTO-t haszn\u00e1ljuk, mert ebbe csak azokat az adatokat v\u00e1rjuk, amik sz\u00fcks\u00e9gesek egy komment l\u00e9trehoz\u00e1s\u00e1hoz. Figyelj\u00fck meg, hogy a felhaszn\u00e1l\u00f3 azonos\u00edt\u00f3ja nincs benne mert csak az aktu\u00e1lisan bel\u00e9pett felhaszn\u00e1l\u00f3 tud kommentet \u00edrni, azt pedig a szerver oldalon a <code>RequestContext</code>-b\u0151l el\u00e9rj\u00fck.</li> <li> <p>Kezdj\u00fck az \u00faj hozz\u00e1sz\u00f3l\u00e1s gomb esem\u00e9nykezel\u0151j\u00e9vel a <code>Book.cshtml.cs</code> f\u00e1jlban</p> Book.cshtml.cs<pre><code>public class BookModel(IBookService bookService, ICommentService commentService) : PageModel\n{\n    // ...\n\n    [BindProperty] \n    public CreateCommentData NewComment { get; set; } = null!;\n\n    public async Task OnGetAsync()\n    {\n        // Query the book details\n        Book = await bookService.GetBookAsync(Id);\n        Comments = await commentService.GetCommentsAsync(Id, CommentType.Comment);\n\n        NewComment = new CreateCommentData() { BookId = Id };\n    }\n\n    public async Task&lt;IActionResult&gt; OnPostCreateComment()\n    {\n        // Set the Type to comment, otherwise it remains 0 and stored in the DB as 0, not Comment.\n        NewComment.Type = CommentType.Comment;\n\n        if (!ModelState.IsValid)\n        {\n            Book = await bookService.GetBookAsync(NewComment!.BookId);\n\n            return Page();\n        }\n\n        await commentService.CreateCommentAsync(NewComment!); \n\n        return RedirectToPage(\"/Book\", new { Id = NewComment!.BookId }); \n    }\n}\n</code></pre> <ul> <li>Az <code>OnGetAsync</code>-ban be\u00e1ll\u00edtjuk, hogy az \u00faj komment az \u00e9ppen megtekintett k\u00f6nyvh\u00f6z kell, hogy k\u00e9sz\u00fclj\u00f6n. Ez az\u00e9rt fontos, hogy majd a cshtml-ben a m\u00e1r be\u00e1ll\u00edtott \u00e9rt\u00e9ket hozz\u00e1 tudjuk k\u00f6tni egy rejtett mez\u0151h\u00f6z, hogy azt a kliens visszak\u00fcldje, mert a Post nem fogja kiolvasni az \u00e9rt\u00e9kel az URL-b\u0151l.</li> <li>A komment t\u00edpus\u00e1t, csak az esem\u00e9nykezel\u0151ben \u00e1ll\u00edtjuk be, mert ahhoz nem tartozik rejtett mez\u0151, hiszen az \u00e9rt\u00e9ke fix.</li> <li>Az esem\u00e9nykezel\u0151ben itt m\u00e1r valid\u00e1ljuk is az adatokat, azaz ha b\u00e1rmelyik k\u00f6telez\u0151 mez\u0151 nincs megadva, akkor a <code>ModelState.IsValid</code> false \u00e9rt\u00e9ket fog visszaadni. Ilyenkor az aktu\u00e1lis k\u00f6nyv adatait \u00fajra le kell k\u00e9rdezni \u00e9s visszat\u00e9rni a <code>new Page()</code>-el</li> <li>Ha minden adat megvan, akkor megh\u00edvjuk a <code>CreateCommentAsync</code>-ot ami lementi az adatb\u00e1zisba a kommentet az aktu\u00e1lisan bel\u00e9pett felhaszn\u00e1l\u00f3 nev\u00e9ben, amit a <code>RequestContext</code>-b\u0151l vesz\u00fcnk, ami jelenleg mockolva van az 1-es ID-j\u00fa felhaszn\u00e1l\u00f3ra.</li> </ul> </li> <li> <p>Ezt k\u00f6vet\u0151en a megjelen\u00edt\u00e9st is k\u00e9sz\u00edts\u00fck el hozz\u00e1</p> Book.cshtml<pre><code>&lt;div class=\"row\"&gt;\n    &lt;div class=\"col-lg-6\"&gt;\n        &lt;h3&gt;Kommentek&lt;/h3&gt;\n\n        &lt;form asp-page-handler=\"CreateComment\"&gt;\n            @* Hidden field bound to NewComment.BookId so it will be set for the click handler. *@\n            &lt;input type=\"hidden\" asp-for=\"NewComment.BookId\" /&gt;\n\n            &lt;div class=\"d-flex\"&gt;\n                &lt;div class=\"d-flex flex-column align-items-center flex-shrink-0 me-3\"&gt;\n                    &lt;i class=\"bi bi-person-square fs-1\"&gt;&lt;/i&gt;\n                    &lt;div class=\"text-muted\"&gt;@(DateTime.Now.ToShortDateString())&lt;/div&gt;\n                    &lt;div class=\"text-muted\"&gt;@(DateTime.Now.ToShortTimeString())&lt;/div&gt;\n                &lt;/div&gt;\n\n                &lt;textarea class=\"w-100\" rows=\"3\" asp-for=\"NewComment.Text\"&gt;&lt;/textarea&gt; \n            &lt;/div&gt;\n\n            &lt;div class=\"d-flex justify-content-end my-2\"&gt;\n                &lt;button type=\"submit\" class=\"btn btn-outline-primary\"&gt;Hozz\u00e1sz\u00f3lok&lt;/button&gt;\n            &lt;/div&gt;\n        &lt;/form&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"col-lg-6\"&gt;\n    @* TODO: Aj\u00e1nl\u00f3k *@\n&lt;/div&gt;\n</code></pre> </li> <li> <p>Pr\u00f3b\u00e1ljuk is ki \u00e9s n\u00e9zz\u00fck meg az adatb\u00e1zisban is, hogy helyesen beker\u00fcltek-e az adatok, illetve, hogy a komment t\u00edpusa t\u00e9nyleg string-k\u00e9nt ker\u00fcl be.</p> Elk\u00e9sz\u00fclt komment funkci\u00f3 <p></p> <p>Sikeresen l\u00e9trehozott komment</p> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.2%20Main%20pages/#ajanlok-listazasa","title":"Aj\u00e1nl\u00f3k list\u00e1z\u00e1sa","text":"<p>A hozz\u00e1sz\u00f3l\u00e1sokhoz hasonl\u00f3an aj\u00e1nl\u00f3kat is lehet \u00edrni egy k\u00f6nyvh\u00f6z. Alak\u00edtsuk \u00e1t a hozz\u00e1sz\u00f3l\u00e1sok list\u00e1z\u00e1s\u00e1t \u00fagy, hogy az aj\u00e1nl\u00f3kat is tudjuk list\u00e1zni.</p> <p>Figyelj\u00fck meg, hogy a <code>GetCommentsAsync</code> lek\u00e9rdez\u00e9sben a <code>CommentType</code> egy opcion\u00e1lis mez\u0151 \u00e9s ha nem adjuk meg, akkor nem sz\u0171r a t\u00edpusra. Ezt kihaszn\u00e1lva le tudjuk k\u00e9rdezni egyben az \u00f6sszes kommentet \u00e9s a megjelen\u00edt\u00e9sn\u00e9l a mem\u00f3ri\u00e1ban tudjuk sz\u0171rni, hogy mit kell megjelen\u00edteni.</p> <p>Viszont ha tov\u00e1bb gondoljuk \u00e9s a k\u00e9s\u0151bbiekben lapozva szeretn\u00e9nk megjelen\u00edteni a hozz\u00e1sz\u00f3l\u00e1sokat illetve az aj\u00e1nl\u00f3kat, akkor k\u00e9nytelenek lesz\u00fcnk k\u00fcl\u00f6n-k\u00fcl\u00f6n lek\u00e9rdezni.</p> <p>\u00d6n\u00e1ll\u00f3 feladat - Aj\u00e1nl\u00f3k list\u00e1z\u00e1sa</p> <ul> <li>Eg\u00e9sz\u00edtsd ki a <code>Book.cshtml.cs</code> f\u00e1jlt, hogy kett\u0151 aj\u00e1nl\u00f3t is lek\u00e9rdezze.</li> <li>Eg\u00e9sz\u00edtsd ki a <code>Book.cshtml</code> f\u00e1jlt, hogy a <code>@* TODO: Aj\u00e1nl\u00f3k *@</code> alatt jelenjenek meg az aj\u00e1nl\u00f3k is, hasonl\u00f3an a kommentekhez, csak itt az ikon \u00e9s d\u00e1tum a jobb oldalon legyen.</li> </ul> Seg\u00edts\u00e9g az aj\u00e1nl\u00f3k megjelen\u00edt\u00e9s\u00e9hez <ol> <li> <p>K\u00e9rdezz\u00fck le az aj\u00e1nl\u00f3kat is egy k\u00fcl\u00f6n list\u00e1ban, de csak maximum 2db-ot.</p> Book.cshtml.cs<pre><code>public IList&lt;CommentData&gt; Comments { get; set; } = [];\npublic IList&lt;CommentData&gt; Reviews{ get; set; } = [];\n\n[BindProperty]\npublic CreateCommentData NewComment { get; set; } = null!;\n\npublic async Task OnGetAsync()\n{\n    // Query the book details\n    Book = await bookService.GetBookAsync(Id);\n\n    Comments = await commentService.GetCommentsAsync(Id, CommentType.Comment);\n    Reviews = await commentService.GetCommentsAsync(Id, CommentType.Review, 2);\n\n    NewComment = new CreateCommentData() { BookId = Id };\n}\n</code></pre> </li> <li> <p>Jelen\u00edts\u00fck meg az aj\u00e1nl\u00f3kat is hasonl\u00f3an a kommentekhez.</p> Book.cshtml<pre><code>&lt;div class=\"col-lg-6\"&gt;\n    @* TODO: Aj\u00e1nl\u00f3k *@\n    &lt;div class=\"comments my-2\"&gt;\n        @foreach (var comment in Model.Reviews)\n        {\n            &lt;div class=\"comment d-flex p-3\"&gt;\n                &lt;div class=\"w-100\"&gt;\n                    @comment.Text\n                &lt;/div&gt;\n                &lt;div class=\"d-flex flex-column align-items-center justify-content-center flex-shrink-0 me-3\"&gt;\n                    &lt;i class=\"bi bi-person-square fs-1\"&gt;&lt;/i&gt;\n                    &lt;div class=\"text-muted\"&gt;@(comment.CreatedDate.DateTime.ToShortDateString())&lt;/div&gt;\n                    &lt;div class=\"text-muted\"&gt;@(comment.CreatedDate.DateTime.ToShortTimeString())&lt;/div&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n        }\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/","title":"4.3. Felhaszn\u00e1l\u00f3 kezel\u00e9s","text":""},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#43-felhasznalo-kezeles","title":"4.3. Felhaszn\u00e1l\u00f3 kezel\u00e9s","text":"<p>Felhaszn\u00e1l\u00f3kezel\u00e9shez a legk\u00e9zenfekv\u0151bb megold\u00e1s ha nem saj\u00e1t implement\u00e1ci\u00f3t k\u00e9sz\u00edten\u00fcnk, ugyanis ez nagyon sok hibalehet\u0151s\u00e9get hordoz mag\u00e1ban. P\u00e9ld\u00e1ul a felhaszn\u00e1l\u00f3 jelszav\u00e1nak t\u00e9nylegesen titkos\u00edtott, nem visszafejthet\u0151 (hashel\u00e9st \u00e9s saltot alkalmaz\u00f3) m\u00f3don t\u00f6rt\u00e9n\u0151 t\u00e1rol\u00e1s\u00e1t vagy a harmadik f\u00e9l \u00e1ltali autentik\u00e1ci\u00f3s mechanizmusok kezel\u00e9s\u00e9t.</p> <p>Haszn\u00e1ljuk teh\u00e1t az ASP.NET Core elterjedt \u00e9s szinte b\u00e1rmilyen esetben j\u00f3l alkalmazhat\u00f3 ASP.NET Core Identity megold\u00e1s\u00e1t, amivel a fenti probl\u00e9m\u00e1kat meg tudjuk oldani.</p> <p>Az ASP.NET Identity hivatalos dokument\u00e1ci\u00f3j\u00e1t is \u00e9rdemes lehet \u00e1tn\u00e9zni.</p>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#identity-beallitasa","title":"Identity be\u00e1ll\u00edt\u00e1sa","text":"<p>Az ASP.NET Identity-t a <code>BookShop.Web.RazorPage</code> projektben is be kell \u00e1ll\u00edtani, hogy pontosan hogyan szeretn\u00e9nk haszn\u00e1lni.</p> <p>Az els\u0151 l\u00e9p\u00e9s, az Identity hozz\u00e1ad\u00e1sa amit sokf\u00e9lek\u00e9ppen megtehet\u00fcnk att\u00f3l f\u00fcgg\u0151en mit szeretn\u00e9nk haszn\u00e1lni. Tekints\u00fck is \u00e1t a lehet\u0151s\u00e9geket.</p>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#addidentitycore","title":"AddIdentityCore","text":"<p>A felhaszn\u00e1l\u00f3kezel\u00e9shez sz\u00fcks\u00e9ges legfontosabb szolg\u00e1ltat\u00e1sokat regisztr\u00e1lja be egy default implement\u00e1ci\u00f3val a DI-ba.</p> <ul> <li>Sz\u00fcks\u00e9ges valid\u00e1torok.</li> <li><code>IUserConfirmation&lt;TUser&gt;</code>, ami azt ellen\u0151rzi, hogy a felhaszn\u00e1l\u00f3 e-mail c\u00edme meg lett-e er\u0151s\u00edtve.</li> <li><code>IdentityErrorDescriber</code> a felhaszn\u00e1l\u00f3kezel\u00e9s sor\u00e1n keletkez\u0151 hib\u00e1k le\u00edr\u00e1sa.</li> <li><code>ClaimsPrincipalFactory</code>, amivel a <code>ClaimsPrincipal</code>-t hozza l\u00e9tre az adott felhaszn\u00e1l\u00f3hoz.</li> <li><code>UserManager</code>, ami a felhaszn\u00e1l\u00f3 kezel\u00e9shez n\u00e9lk\u00fcl\u00f6zhetetlen met\u00f3dusokat tartalmazza.</li> </ul> AddIdentityCore forr\u00e1sk\u00f3dja mit \u00e1ll\u00edt be helyett\u00fcnk IdentityServiceCollectionExtensions<pre><code>public static IdentityBuilder AddIdentityCore&lt;TUser&gt;(this IServiceCollection services, Action&lt;IdentityOptions&gt; setupAction)\n    where TUser : class\n{\n    // Services identity depends on\n    services.AddOptions().AddLogging();\n    services.AddMetrics();\n\n    // Services used by identity\n    services.TryAddScoped&lt;IUserValidator&lt;TUser&gt;, UserValidator&lt;TUser&gt;&gt;();\n    services.TryAddScoped&lt;IPasswordValidator&lt;TUser&gt;, PasswordValidator&lt;TUser&gt;&gt;();\n    services.TryAddScoped&lt;IPasswordHasher&lt;TUser&gt;, PasswordHasher&lt;TUser&gt;&gt;();\n    services.TryAddScoped&lt;ILookupNormalizer, UpperInvariantLookupNormalizer&gt;();\n    services.TryAddScoped&lt;IUserConfirmation&lt;TUser&gt;, DefaultUserConfirmation&lt;TUser&gt;&gt;();\n    // No interface for the error describer so we can add errors without rev'ing the interface\n    services.TryAddScoped&lt;IdentityErrorDescriber&gt;();\n    services.TryAddScoped&lt;IUserClaimsPrincipalFactory&lt;TUser&gt;, UserClaimsPrincipalFactory&lt;TUser&gt;&gt;();\n    services.TryAddScoped&lt;UserManager&lt;TUser&gt;&gt;();\n\n    if (setupAction != null)\n    {\n        services.Configure(setupAction);\n    }\n\n    return new IdentityBuilder(typeof(TUser), services);\n}\n</code></pre>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#adddefaultidentity","title":"AddDefaultIdentity","text":"<p>Haszn\u00e1lat\u00e1hoz sz\u00fcks\u00e9ges a <code>Microsoft.AspNetCore.Identity.UI</code> NuGet package telep\u00edt\u00e9se.  </p> <p>Hozz\u00e1adja a leggyakoribb szolg\u00e1ltat\u00e1sokat, bele\u00e9rtve az alap\u00e9rtelmezett felhaszn\u00e1l\u00f3i fel\u00fcletet, a token szolg\u00e1ltat\u00f3kat, valamint konfigur\u00e1lja a s\u00fcti alap\u00fa hiteles\u00edt\u00e9st, de a szerepk\u00f6r\u00f6k kezel\u00e9s\u00e9t k\u00fcl\u00f6n kell hozz\u00e1adni az <code>.AddRoles&lt;IdentityRole&lt;int&gt;&gt;()</code> megh\u00edv\u00e1s\u00e1val. Az al\u00e1bbiakban l\u00e1that\u00f3, hogy pontosan mit \u00e1ll\u00edt be.</p> <p>Nagyj\u00e1b\u00f3l azt csin\u00e1lja, mintha k\u00e9zzel megh\u00edvn\u00e1nk az <code>AddIdentityCore</code>, <code>AddDefaultUI</code>, <code>AddDefaultTokenProviders</code>-t.</p> <p>Az <code>AddDefaultUI</code> teszi lehet\u0151v\u00e9, hogy az alap\u00e9rtelmezett Identity oldalakat haszn\u00e1lhassuk. Az egyes oldalak egy k\u00fcl\u00f6n Razor Class Libraryben vannak, \u00edgy a k\u00f3dja nem \u00e9rhet\u0151 el, nem m\u00f3dos\u00edthat\u00f3 csak akkor ha legener\u00e1ljuk a megfelel\u0151 oldalat a mi k\u00f3dunkba is, amit majd a k\u00e9s\u0151bbiekben bemutatott Scaffolding-gal tudunk megtenni. A DefaultUI-hoz sz\u00fcks\u00e9ges ehhez sz\u00fcks\u00e9ges <code>SingInManager</code> \u00e9s egy \u00fcres <code>IEmailSender</code> is regisztr\u00e1ci\u00f3ra ker\u00fcl.</p> AddDefaultIdentity forr\u00e1sk\u00f3dja mit \u00e1ll\u00edt be helyett\u00fcnk IdentityServiceCollectionUIExtensions<pre><code>public static IdentityBuilder AddDefaultIdentity&lt;TUser&gt;(this IServiceCollection services, Action&lt;IdentityOptions&gt; configureOptions) where TUser : class\n{\n    services.AddAuthentication(o =&gt;\n    {\n        o.DefaultScheme = IdentityConstants.ApplicationScheme;\n        o.DefaultSignInScheme = IdentityConstants.ExternalScheme;\n    }).AddIdentityCookies(o =&gt; { });\n\n    return services.AddIdentityCore&lt;TUser&gt;(o =&gt;\n    {\n        o.Stores.MaxLengthForKeys = 128;\n        configureOptions?.Invoke(o);\n    }).AddDefaultUI().AddDefaultTokenProviders();\n}\n</code></pre>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#addidentity","title":"AddIdentity","text":"<p>\u00dagy konfigur\u00e1lja fel az Identity-t, hogy minden r\u00e9sz\u00e9t haszn\u00e1lhassuk, ami persze nem biztos, hogy mindig kell.</p> <ul> <li>HttpContextAccessor</li> <li>UserManager-en fel\u00fcl SingInManager \u00e9s RoleManager.</li> <li>3<sup>rd</sup> party login, 2FA autentik\u00e1c\u00f3 \u00e9s a hozz\u00e1 tartoz\u00f3 s\u00fctik.</li> <li>Bel\u00e9p\u00e9s pass key haszn\u00e1lat\u00e1val.</li> <li>Szerepk\u00f6r kezel\u00e9s be\u00e1ll\u00edt\u00e1sa.</li> </ul> AddIdentity forr\u00e1sk\u00f3dja mit \u00e1ll\u00edt be helyett\u00fcnk IdentityServiceCollectionExtensions<pre><code>public static IdentityBuilder AddIdentity&lt;TUser, [DynamicallyAccessedMembers(DynamicallyAccessedMemberTypes.PublicConstructors)] TRole&gt;(\n    this IServiceCollection services,\n    Action&lt;IdentityOptions&gt; setupAction)\n    where TUser : class\n    where TRole : class\n{\n    // Services used by identity\n    services.AddAuthentication(options =&gt;\n    {\n        options.DefaultAuthenticateScheme = IdentityConstants.ApplicationScheme;\n        options.DefaultChallengeScheme = IdentityConstants.ApplicationScheme;\n        options.DefaultSignInScheme = IdentityConstants.ExternalScheme;\n    })\n    .AddCookie(IdentityConstants.ApplicationScheme, o =&gt;\n    {\n        o.LoginPath = new PathString(\"/Account/Login\");\n        o.Events = new CookieAuthenticationEvents\n        {\n            OnValidatePrincipal = SecurityStampValidator.ValidatePrincipalAsync\n        };\n    })\n    .AddCookie(IdentityConstants.ExternalScheme, o =&gt;\n    {\n        o.Cookie.Name = IdentityConstants.ExternalScheme;\n        o.ExpireTimeSpan = TimeSpan.FromMinutes(5);\n    })\n    .AddCookie(IdentityConstants.TwoFactorRememberMeScheme, o =&gt;\n    {\n        o.Cookie.Name = IdentityConstants.TwoFactorRememberMeScheme;\n        o.Events = new CookieAuthenticationEvents\n        {\n            OnValidatePrincipal = SecurityStampValidator.ValidateAsync&lt;ITwoFactorSecurityStampValidator&gt;\n        };\n    })\n    .AddCookie(IdentityConstants.TwoFactorUserIdScheme, o =&gt;\n    {\n        o.Cookie.Name = IdentityConstants.TwoFactorUserIdScheme;\n        o.Events = new CookieAuthenticationEvents\n        {\n            OnRedirectToReturnUrl = _ =&gt; Task.CompletedTask\n        };\n        o.ExpireTimeSpan = TimeSpan.FromMinutes(5);\n    });\n\n    // Hosting doesn't add IHttpContextAccessor by default\n    services.AddHttpContextAccessor();\n    services.AddMetrics();\n    // Identity services\n    services.TryAddScoped&lt;IUserValidator&lt;TUser&gt;, UserValidator&lt;TUser&gt;&gt;();\n    services.TryAddScoped&lt;IPasswordValidator&lt;TUser&gt;, PasswordValidator&lt;TUser&gt;&gt;();\n    services.TryAddScoped&lt;IPasswordHasher&lt;TUser&gt;, PasswordHasher&lt;TUser&gt;&gt;();\n    services.TryAddScoped&lt;ILookupNormalizer, UpperInvariantLookupNormalizer&gt;();\n    services.TryAddScoped&lt;IRoleValidator&lt;TRole&gt;, RoleValidator&lt;TRole&gt;&gt;();\n    // No interface for the error describer so we can add errors without rev'ing the interface\n    services.TryAddScoped&lt;IdentityErrorDescriber&gt;();\n    services.TryAddScoped&lt;ISecurityStampValidator, SecurityStampValidator&lt;TUser&gt;&gt;();\n    services.TryAddEnumerable(ServiceDescriptor.Singleton&lt;IPostConfigureOptions&lt;SecurityStampValidatorOptions&gt;, PostConfigureSecurityStampValidatorOptions&gt;());\n    services.TryAddScoped&lt;ITwoFactorSecurityStampValidator, TwoFactorSecurityStampValidator&lt;TUser&gt;&gt;();\n    services.TryAddScoped&lt;IUserClaimsPrincipalFactory&lt;TUser&gt;, UserClaimsPrincipalFactory&lt;TUser, TRole&gt;&gt;();\n    services.TryAddScoped&lt;IUserConfirmation&lt;TUser&gt;, DefaultUserConfirmation&lt;TUser&gt;&gt;();\n    services.TryAddScoped&lt;IPasskeyHandler&lt;TUser&gt;, PasskeyHandler&lt;TUser&gt;&gt;();\n    services.TryAddScoped&lt;UserManager&lt;TUser&gt;&gt;();\n    services.TryAddScoped&lt;SignInManager&lt;TUser&gt;&gt;();\n    services.TryAddScoped&lt;RoleManager&lt;TRole&gt;&gt;();\n\n    if (setupAction != null)\n    {\n        services.Configure(setupAction);\n    }\n\n    return new IdentityBuilder(typeof(TUser), typeof(TRole), services);\n}\n</code></pre>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#addidentityapiendpoints","title":"AddIdentityApiEndpoints","text":"<p>Be\u00e1ll\u00edtja, hogy az autentik\u00e1ci\u00f3 m\u0171k\u00f6dj\u00f6n bearer tokennel \u00e9s s\u00fctivel is.</p> <ul> <li>Mint l\u00e1that\u00f3 ez is a <code>AddIdentityCore</code>-t h\u00edvja a sz\u00fcks\u00e9ges be\u00e1ll\u00edt\u00e1sokhoz, e miatt ez a megold\u00e1s sem \u00e1ll\u00edtja be alap\u00e9rtelmez\u00e9s szerint a szerepk\u00f6r\u00f6k kezel\u00e9s\u00e9t, amit a <code>.AddRoles&lt;IdentityRole&lt;int&gt;&gt;()</code> megh\u00edv\u00e1s\u00e1val tehet\u00fcnk meg.</li> <li>Az <code>AddApiEndpoints()</code> teszi lehet\u0151v\u00e9 hogy a k\u00f3dban haszn\u00e1lhassuk a <code>MapIdentityApi</code> ami egy minimal API a felhaszn\u00e1l\u00f3kezel\u00e9shez. Tipikusan akkor haszn\u00e1ljuk ha nem szerver oldalon renderelt alkalmaz\u00e1st k\u00e9sz\u00edt\u00fcnk (pl: Blazor WASM).</li> </ul> AddIdentityApiEndpoints forr\u00e1sk\u00f3dja mit \u00e1ll\u00edt be helyett\u00fcnk IdentityServiceCollectionExtensions<pre><code>/// Adds a set of common identity services to the application to support &lt;see cref=\"IdentityApiEndpointRouteBuilderExtensions.MapIdentityApi{TUser}(IEndpointRouteBuilder)\"/&gt;\n/// and configures authentication to support identity bearer tokens and cookies.\npublic static IdentityBuilder AddIdentityApiEndpoints&lt;TUser&gt;(this IServiceCollection services, Action&lt;IdentityOptions&gt; configure)\n    where TUser : class, new()\n{\n    ArgumentNullException.ThrowIfNull(services);\n    ArgumentNullException.ThrowIfNull(configure);\n\n    services\n        .AddAuthentication(IdentityConstants.BearerAndApplicationScheme)\n        .AddScheme&lt;AuthenticationSchemeOptions, CompositeIdentityHandler&gt;(IdentityConstants.BearerAndApplicationScheme, null, compositeOptions =&gt;\n        {\n            compositeOptions.ForwardDefault = IdentityConstants.BearerScheme;\n            compositeOptions.ForwardAuthenticate = IdentityConstants.BearerAndApplicationScheme;\n        })\n        .AddBearerToken(IdentityConstants.BearerScheme)\n        .AddIdentityCookies();\n\n    return services.AddIdentityCore&lt;TUser&gt;(configure)\n        .AddApiEndpoints();\n}\n</code></pre> <ul> <li>Illetve a minimal API v\u00e9gpontok haszn\u00e1lat\u00e1hoz a <code>MapIdentityApi</code> megh\u00edv\u00e1sa is sz\u00fcks\u00e9ges a megfelel\u0151 helyen. Program.cs<pre><code>app.UseAuthentication();\napp.UseAuthorization();\n\napp.UseSession();\n\napp.MapIdentityApi&lt;ApplicationUser&gt;();\n\napp.MapStaticAssets();\napp.MapRazorPages()\n.WithStaticAssets();\n</code></pre></li> </ul>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#identity-defaultui-al","title":"Identity DefaultUI-al","text":"<p>Felhaszn\u00e1l\u00f3i fel\u00fcletet m\u00e9g nem kaptunk a felhaszn\u00e1l\u00f3kezel\u00e9shez, viszont ezt sem kell k\u00e9zzel meg\u00edrni, mert Scaffolding seg\u00edts\u00e9g\u00e9vel l\u00e9tre tudunk hozni egy alap\u00e9rtelmezett implement\u00e1ci\u00f3t. Ahhoz, hogy tudjuk a Scaffoldingot haszn\u00e1lni a <code>BookShop.Web.RazorPage</code> projekthez adjuk hozz\u00e1 a <code>Microsoft.VisualStudio.Web.CodeGeneration.Design</code> NuGet package-et.</p> <ol> <li> <p>\u00c1ll\u00edtsuk be \u00fagy az Identity-t a lehet\u0151 legegyszer\u0171bb m\u00f3don.</p> Program.cs<pre><code>builder.Services.AddDbContext&lt;BookShopDbContext&gt;(options =&gt; options.UseSqlServer(connectionString));\n\nbuilder.Services.AddDefaultIdentity&lt;ApplicationUser&gt;()\n    .AddEntityFrameworkStores&lt;BookShopDbContext&gt;();\n</code></pre> </li> <li> <p>Ind\u00edtsuk el az alkalmaz\u00e1st \u00e9s nyissuk meg a <code>/Identity/Account/Login</code> oldalt \u00e9s azt fogjuk tapasztalni, hogy hi\u00e1nyzik a <code>_LoginPartial.cshtml</code> f\u00e1jl.</p> <p></p> <p>Hi\u00e1nyzik a LoginPartial.cshtml</p> </li> <li> <p>Hozzuk l\u00e9tre k\u00e9zzel \u00fcres tartalommal a Pages/Shared k\u00f6nyvt\u00e1rba. Fontos, hogy az Add New Item.. -&gt; Razor View - Empty-t v\u00e1lasszuk ne a page-et, mert egy nem oldal, hanem csak egy view \u00e9s mindenk\u00e9ppen <code>_LoginPartial.cshtml</code> nevet adjuk neki. A l\u00e9trehozott f\u00e1jt tartalm\u00e1t t\u00f6r\u00f6lhetj\u00fck.</p> </li> <li> <p>Ind\u00edtsuk el az alkalmaz\u00e1st \u00e9s ism\u00e9rt nyissuk meg a <code>/Identity/Account/Login</code> oldalt \u00e9s l\u00e9pj\u00fcnk be az admin felhaszn\u00e1l\u00f3val</p> <ul> <li>admin@example.com</li> <li>Password123!</li> </ul> </li> <li> <p>Ha mindent j\u00f3l csin\u00e1ltunk be is tudunk l\u00e9pni. Hasonl\u00f3an a <code>/Identity/Account/Logout</code> vagy a <code>/Identity/Account/Register</code> oldal is m\u0171k\u00f6dik, de a fejl\u00e9cben nincs bel\u00e9p\u00e9s / regisztr\u00e1ci\u00f3 gomb, amit pont a _LoginPartial.cshtml feladata lenne megjelen\u00edteni. \u00cdgy a k\u00f6vetkez\u0151 feladatunk, hogy ezeket az oldalakat valahogy legener\u00e1ljuk.</p> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#identity-options","title":"Identity Options","text":"<p>Tegy\u00fcnk egy kis kit\u00e9r\u0151t, \u00e9s n\u00e9zz\u00fck meg, hogy az Identity ny\u00fajtotta lehet\u0151s\u00e9geket hogyan tudjuk konfigur\u00e1lni az <code>IdentityOptions</code> be\u00e1ll\u00edt\u00e1saival. Ezt megtehetj\u00fck \u00fagy, hogy az <code>AddDefaultIdentity</code> / <code>AddIdentity</code> / <code>AddIdentityCore</code>-nek adjuk \u00e1t a be\u00e1ll\u00edt\u00e1st, \u00fagy ahogy eddig, vagy a <code>Configure&lt;IdentityOptions&gt;</code> f\u00fcggv\u00e9nyt haszn\u00e1ljuk.</p> <p>\u00c1ll\u00edtsuk be a jelsz\u00f3ra, kitilt\u00e1sa, felhaszn\u00e1l\u00f3ra \u00e9s bel\u00e9p\u00e9sre  vonatkat\u00f3 szab\u00e1lyokat. Az al\u00e1bbiban l\u00e1thatunk egy javasolt be\u00e1ll\u00edt\u00e1st ezekre az adatokra, a biztons\u00e1got szem el\u0151tt tartva.</p> Program.cs<pre><code>builder.Services.AddDefaultIdentity(\n// builder.Services.AddIdentityCore(\n// builder.Services.AddIdentity&lt;ApplicationUser, IdentityRole&lt;int&gt;&gt;(\noptions =&gt;\n{\n    // Password settings.\n    options.Password.RequiredLength = 12;\n    options.Password.RequireNonAlphanumeric = true;\n    options.Password.RequireUppercase = true;\n    options.Password.RequireLowercase = true;\n    options.Password.RequireDigit = true;\n\n    options.Password.RequiredUniqueChars = 6;\n\n    // Lockout settings.\n    options.Lockout.DefaultLockoutTimeSpan = TimeSpan.FromMinutes(10);\n    options.Lockout.MaxFailedAccessAttempts = 5;\n    options.Lockout.AllowedForNewUsers = true;\n\n    // User settings.\n    options.User.RequireUniqueEmail = true;\n    options.User.AllowedUserNameCharacters =\n    \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._@+\";\n\n    // Sign\u2011in (only for production scenarios, for development you might want to disable these).\n    options.SignIn.RequireConfirmedAccount = true;\n    options.SignIn.RequireConfirmedEmail = true;\n})\n.AddEntityFrameworkStores&lt;BookShopDbContext&gt;()\n.AddDefaultTokenProviders();\n</code></pre> A fenti be\u00e1ll\u00edt\u00e1s a Configure-t haszn\u00e1lva <p>Ha ezt a megold\u00e1st haszn\u00e1ljuk akkor az <code>AddIdentity</code>-n\u00e9l ne \u00e1ll\u00edtsuk be ezt. </p>Program.cs<pre><code>builder.Services.Configure&lt;IdentityOptions&gt;(options =&gt;\n{\n    // Password settings.\n    options.Password.RequiredLength = 12;\n    options.Password.RequireNonAlphanumeric = true;\n    options.Password.RequireUppercase = true;\n    options.Password.RequireLowercase = true;\n    options.Password.RequireDigit = true;\n\n    options.Password.RequiredUniqueChars = 6;\n\n    // Lockout settings.\n    options.Lockout.DefaultLockoutTimeSpan = TimeSpan.FromMinutes(10);\n    options.Lockout.MaxFailedAccessAttempts = 5;\n    options.Lockout.AllowedForNewUsers = true;\n\n    // User settings.\n    options.User.RequireUniqueEmail = true;\n    options.User.AllowedUserNameCharacters =\n    \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._@+\";\n\n    // Sign\u2011in (only for production scenarios, for development you might want to disable these).\n    options.SignIn.RequireConfirmedAccount = true;\n    options.SignIn.RequireConfirmedEmail = true;      \n});\n</code></pre><p></p>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#identity-oldalak-letrehozasa","title":"Identity oldalak l\u00e9trehoz\u00e1sa","text":"<p>A fenti p\u00e9ld\u00e1ban l\u00e1ttuk, hogy ha a <code>_LoginPartial.cshtml</code> megvan (ak\u00e1r \u00fcresen) akkor m\u00e1r m\u0171k\u00f6dik a DefaultUI. Most a feladat az lenne, hogy legener\u00e1ljunk p\u00e1r fontos oldalt, hogy azt sz\u00fcks\u00e9g eset\u00e9n testre tudjuk szabni. Erre k\u00e9t m\u00f3dszer van. Haszn\u00e1lhatjuk a Visual Studio grafikus fel\u00fclet\u00e9t, ami nem fog j\u00f3 k\u00f3dot gener\u00e1lni \u00e9s sok manu\u00e1lis m\u00f3dos\u00edt\u00e1s sz\u00fcks\u00e9ges, vagy .NET CLI-b\u0151l is gener\u00e1lhatjuk, ahol kevesebb m\u00f3dos\u00edt\u00e1s sz\u00fcks\u00e9ges.</p>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#grafikus-felulet","title":"Grafikus fel\u00fclet","text":"<p>Visual Studioban az Idenetity-hez tartoz\u00f3 oldalakat le lehet gener\u00e1lni (scaffold), amit a Add -&gt; New Scaffolded item... seg\u00edts\u00e9g\u00e9vel tehet\u00fcnk meg. Itt el\u0151sz\u00f6r ki kell v\u00e1lasztani, hogy az Identity oldalakat szeretn\u00e9nk gener\u00e1lni, majd kiv\u00e1lasztani, hogy mely oldalakat szeretn\u00e9nk \u00e9s megadni, hogy melyik DbContext-et haszn\u00e1lja.</p> <p></p> <p>Identity oldalak</p> <p>Ki lehet pr\u00f3b\u00e1lni, hogy milyen k\u00f3dot gener\u00e1l, de sajn\u00e1latos m\u00f3don a gener\u00e1tor nem fogja megtal\u00e1lni helyesen a <code>BookShopDbContext</code>-et \u00e9s a gener\u00e1lt k\u00f3dban a saj\u00e1t <code>ApplicationUser</code> oszt\u00e1ly helyett mindenhol az <code>IdentityUser</code>-t fogja haszn\u00e1lni, amit k\u00e9zzel kellene mindenhol jav\u00edtani.</p> <p>Fontos viszont hogy ha kipr\u00f3b\u00e1ljuk \u00e9s nem akarjuk mindenhol \u00e1t\u00edrni, akkor t\u00f6r\u00f6lj\u00fck az \u00f6sszes gener\u00e1lt k\u00f3dot</p> <ul> <li>Areas k\u00f6nyvt\u00e1r teljes tartalm\u00e1t</li> <li>Ha l\u00e9trehozza a <code>Pages/Shares/_LoginPartial.cshtml</code> akkor annak legal\u00e1bb a tartalm\u00e1t.</li> <li><code>Program.cs</code> f\u00e1jlb\u00f3l a <code>using BookShop.Web.RazorPage.Areas.Identity.Data;</code> sort.</li> </ul>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#net-cli","title":".NET CLI","text":"<p>A m\u00e1sik megold\u00e1s, hogy a parancssorb\u00f3l a <code>aspnet-codegenerator</code> seg\u00edts\u00e9g\u00e9vel gener\u00e1ljuk ki az oldalakat. Fontos, hogy a parancsot mindig a <code>BookShop.Web.RazorPage</code> projekt k\u00f6nyvt\u00e1r\u00e1b\u00f3l kell majd futtassuk!</p> <ol> <li> <p>Ehhez telep\u00edts\u00fck fel a <code>dotnet-aspnet-codegenerator</code> csomagot.</p> <pre><code>dotnet tool install -g dotnet-aspnet-codegenerator\n</code></pre> </li> <li> <p>A <code>BookShop.Web.RazorPage</code> projekt k\u00f6nyvt\u00e1r\u00e1b\u00f3l kell majd futtassuk a parancsot a <code>--help</code> kapcsol\u00f3val, hogy l\u00e1ssuk milyen opci\u00f3kat adhatunk meg.</p> <pre><code>dotnet aspnet-codegenerator identity --help \n</code></pre> </li> <li> <p>Futtassuk \u00fagy a parancsot, hogy az alap\u00e9rtelmezett oldalakat szeretn\u00e9nk haszn\u00e1lni. Ez legener\u00e1lja a <code>_LoginPartial.cshtml</code>-t is, viszont mivel ilyen f\u00e1jlunk m\u00e1r van (b\u00e1r csak \u00fcres tartalommal) sz\u00f3val t\u00f6r\u00f6lj\u00fck. Sajnos a <code>--force</code> kapcsol\u00f3t, hogy fel\u00fcl\u00edrja a m\u00e1r l\u00e9tez\u0151 f\u00e1jlokat itt nem m\u0171k\u00f6dik :(.</p> <pre><code>dotnet aspnet-codegenerator identity -dc BookShop.Dal.BookShopDbContext -u BookShop.Dal.Entities.ApplicationUser --useDefaultUI\n</code></pre> </li> <li> <p>A l\u00e9trehozott k\u00f3d persze nem t\u00f6k\u00e9letes, az al\u00e1bbi jav\u00edt\u00e1sok sz\u00fcks\u00e9gesek, hogy m\u0171k\u00f6dj\u00f6n az alkalmaz\u00e1s     Az <code>Ares/Identity/Data</code> k\u00f6nyvt\u00e1rat t\u00f6r\u00f6lj\u00fck, mert ide l\u00e9trehoz egy \u00faj DbContext-et, amire nincs sz\u00fcks\u00e9g \u00e9s az <code>ApplicationUser</code> oszt\u00e1lyt is l\u00e9trehozza. Hi\u00e1ba adjuk meg a DbContext-et \u00e9s a User oszt\u00e1ly t\u00edpus\u00e1t nem tal\u00e1lja meg a gener\u00e1tor. B\u00e1r azzal, hogy a User oszt\u00e1ly t\u00edpus\u00e1nak <code>-u</code> megadtuk a <code>BookShop.Dal.Entities.ApplicationUser</code> legal\u00e1bb j\u00f3 n\u00e9vvel hivatkozik r\u00e1, \u00edgy ha t\u00f6r\u00f6lj\u00fck a f\u00e1jlt minden probl\u00e9ma megold\u00f3dik :)</p> <p></p> <p>Alap\u00e9rtelmezett UI-hoz gener\u00e1lt oldalak</p> </li> <li> <p>Ha ezzel elk\u00e9sz\u00fclt\u00fcnk, akkor m\u00e1r csak egy apr\u00f3s\u00e1got kell megtenn\u00fcnk, m\u00e9gpedig a <code>_Layout</code> oldalra kitenni a Bejelentkez\u00e9s \u00e9s Regisztr\u00e1ci\u00f3 gombokat. Ehhez a Scaffolding elk\u00e9sz\u00edtett nek\u00fcnk egy <code>_LoginPartial</code> n\u00e9zetet, \u00e9s elegend\u0151 azt kitenni az oldalra, \u00e9s az majd lekezelni, hogy \u00e9ppen a Bejelentkez\u00e9s vagy a Kijelentkez\u00e9s gombot kell-e mutatni. A partial view-t a men\u00fcpontokat tartalmaz\u00f3  lez\u00e1r\u00f3 tag m\u00f6g\u00e9 tegy\u00fck, hogy jobbra legyen igaz\u00edtva.</p> _Layout.cshtml<pre><code>&lt;div class=\"navbar-collapse collapse d-sm-inline-flex justify-content-between\"&gt;\n    &lt;ul class=\"navbar-nav flex-grow-1\"&gt;\n        &lt;li class=\"nav-item\"&gt;\n            &lt;a class=\"nav-link text-dark\" asp-area=\"\" asp-page=\"/Index\"&gt;Home&lt;/a&gt;\n        &lt;/li&gt;\n        @* ... *@\n    &lt;/ul&gt;\n    &lt;partial name=\"_LoginPartial\" /&gt;\n&lt;/div&gt;\n</code></pre> </li> <li> <p>\u00cdgy m\u00e1r megjelenik a Register \u00e9s Login vagy a Logoff gombok is. Ha testre szeretn\u00e9nk szabni, akkor a <code>_LoginPartial.cshtml</code>-ben tudjuk ezt megtenni.</p> </li> <li> <p>Ha t\u00f6bb oldalt is testre szeretn\u00e9nk szabni, akkor azt \u00fagy tehetj\u00fck meg, hogy a <code>--files</code> kapcsol\u00f3 m\u00f6g\u00f6tt felsoroljuk azokat id\u00e9z\u0151jelek k\u00f6z\u00f6tt, pontosvessz\u0151vel elv\u00e1lasztva az oldalakat, amit le szeretn\u00e9nk gener\u00e1ltatni. A lehets\u00e9ges f\u00e1jlneveket megkapjuk ha a <code>--listFiles</code> kapcsol\u00f3val futtatva a parancsot.</p> Lehes\u00e9ges f\u00e1jlnevek list\u00e1z\u00e1sa<pre><code>dotnet aspnet-codegenerator identity --listFiles\n</code></pre> Register, Login... oldalak l\u00e9trehoz\u00e1sa<pre><code>dotnet aspnet-codegenerator identity -dc BookShop.Dal.BookShopDbContext -u BookShop.Dal.Entities.ApplicationUser  --files \"Account.Register;Account.Login;Account.Logout;Account.ConfirmEmail;Account._StatusMessage;Account.RegisterConfirmation\"\n</code></pre> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#egyedi-ui","title":"Egyedi UI","text":"<p>Ha a Default UI-t haszn\u00e1ljuk akkor minden oldal el\u00e9rhet\u0151 akkor is ha nem szerepel az oldal a k\u00f3dunkban. Teh\u00e1t ha csak bizonyos oldalakat szeretn\u00e9nk haszn\u00e1lni, akkor el kell engedni a Default UI haszn\u00e1lat\u00e1t \u00e9s a sz\u00fcks\u00e9ges oldalakhoz kell igaz\u00edtani a konfigur\u00e1ci\u00f3t. Az el\u0151z\u0151 l\u00e9p\u00e9sben ezeket az oldalakat gener\u00e1ltuk le:</p> <ul> <li>Account.Register: Regisztr\u00e1ci\u00f3s oldal, amit majd ki kell eg\u00e9sz\u00edteni a <code>DisplayName</code> tulajdons\u00e1ggal.</li> <li>Account.Login: Bejelentkez\u00e9s oldal</li> <li>Account.Logout: Kijelentkez\u00e9s oldal</li> <li> <p>Account.RegisterConfirmation: Ha a <code>options.SignIn.RequireConfirmedAccount = false</code>-ra van \u00e1ll\u00edtva, akkor nem haszn\u00e1lja ezt az oldalt, regisztr\u00e1ci\u00f3 ut\u00e1n azonnal bel\u00e9pteti a felhaszn\u00e1l\u00f3t. Ha <code>true</code> az \u00e9rt\u00e9ke akkor viszont erre az oldalra ir\u00e1ny\u00edtja a felhaszn\u00e1l\u00f3t, ahol jelzi, hogy e-mailben megkapta a meger\u0151s\u00edt\u00e9shez sz\u00fcks\u00e9ges adatokat.</p> Fel\u00fcletr\u0151l is meg tudjuk er\u0151s\u00edteni <p></p> <p>A fel\u00fcletr\u0151l is le tudjuk kattintani a meger\u0151s\u00edt\u00e9st.</p> Production k\u00f6rnyezetbe ezt kapcsoljuk ki <p>Az <code>RegisterConfirmation.cshtml.cs</code>-ben az <code>OnGetAsync()</code> met\u00f3dusban a <code>DisplayConfirmAccountLink = true;</code>-t kell m\u00f3dos\u00edtani, hogy ne jelen\u00edtse meg a j\u00f3v\u00e1hagy\u00e1s linket.</p> </li> <li> <p>Account.ConfirmEmail: Ezen az oldalon lehet meger\u0151s\u00edteni az email c\u00edmet, mert ennek az URL-j\u00e9t k\u00fcldi el emailben a felhaszn\u00e1l\u00f3nak regisztr\u00e1ci\u00f3 ut\u00e1n.</p> </li> <li> <p>Account._StatusMessage: A ConfirmEmail haszn\u00e1lja.</p> </li> <li> <p>Ha nincs sz\u00fcks\u00e9g 2FA akkor elegend\u0151 az <code>AddIdentityCore</code> haszn\u00e1lata, de a <code>SingInManager</code>-t k\u00e9zzel kell hozz\u00e1adni.</p> Program.cs<pre><code>builder.Services.AddIdentityCore&lt;ApplicationUser&gt;()\n    .AddRoles&lt;IdentityRole&lt;int&gt;&gt;()\n    .AddSignInManager()\n    .AddEntityFrameworkStores&lt;BookShopDbContext&gt;();\n</code></pre> </li> <li> <p>Ha \u00edgy elind\u00edtjuk az alkalmaz\u00e1st az bet\u00f6lt, de a Login \u00e9s Register oldal is hib\u00e1t dob</p> <ul> <li> <p>a Login oldal hi\u00e1nyolja a k\u00fcls\u0151 bel\u00e9p\u00e9ses s\u00fctiket.</p> No sign-out authentication handlers are registered <p>InvalidOperationException: No sign-out authentication handlers are registered. Did you forget to call AddAuthentication().AddCookie(\"Identity.External\",...)?</p> </li> <li> <p>a Register oldal pedig egy <code>IEmailSender</code> implement\u00e1ci\u00f3t hi\u00e1nyol.  </p> Unable to resolve service for IEmailSender <p>InvalidOperationException: Unable to resolve service for type 'Microsoft.AspNetCore.Identity.UI.Services.IEmailSender' while attempting to activate 'BookShop.Web.RazorPage.Areas.Identity.Pages.Account.RegisterModel'.</p> </li> <li> <p>A hiba\u00fczenet szerencs\u00e9re r\u00e9szletesen le\u00edrja, hogy mit kell m\u00e9g be\u00e1ll\u00edtani, \u00edgy az al\u00e1bbi k\u00f3dr\u00e9szlettel k\u00f6nnyen orvosolhatjuk a probl\u00e9m\u00e1t:</p> </li> </ul> Program.cs<pre><code>builder.Services.AddIdentityCore&lt;ApplicationUser&gt;()\n    .AddRoles&lt;IdentityRole&lt;int&gt;&gt;()\n    .AddSignInManager()\n    .AddEntityFrameworkStores&lt;BookShopDbContext&gt;();\n\nbuilder.Services.AddAuthentication()\n    .AddCookie(IdentityConstants.ExternalScheme, o =&gt;\n    {\n        o.Cookie.Name = IdentityConstants.ExternalScheme;\n        o.ExpireTimeSpan = TimeSpan.FromMinutes(5);\n    });\n\nbuilder.Services.TryAddTransient&lt;IEmailSender, NoOpEmailSender&gt;();\n</code></pre> </li> <li> <p>Ha nem szeretn\u00e9nk a fentiek szerint k\u00fczdeni a be\u00e1ll\u00edt\u00e1sokkal akkor a legtutibb megold\u00e1s, ami mindent bekapcsol csak az <code>IEmailSender</code> implement\u00e1ci\u00f3t kell beregisztr\u00e1lni, hiszen ez az implement\u00e1ci\u00f3 egyedi kell legyen. A k\u00e9s\u0151bbiekben k\u00e9sz\u00edt\u00fcnk is hozz\u00e1 saj\u00e1t implement\u00e1ci\u00f3t.</p> Program.cs<pre><code>builder.Services.AddIdentity&lt;ApplicationUser, IdentityRole&lt;int&gt;&gt;( options =&gt;\n    {\n        options.SignIn.RequireConfirmedAccount = false;\n    })\n    .AddEntityFrameworkStores&lt;BookShopDbContext&gt;()\n    .AddDefaultTokenProviders();\n\nbuilder.Services.TryAddTransient&lt;IEmailSender, NoOpEmailSender&gt;();\n</code></pre> </li> </ul> <p>A fenti be\u00e1ll\u00edt\u00e1sokat haszn\u00e1lva m\u00e1r t\u00e9nyleg nem \u00e9rj\u00fck el azokat az oldalakat, amiket nem gener\u00e1ltunk le.</p>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#validacios-hibak","title":"Valid\u00e1ci\u00f3s hib\u00e1k","text":"<ol> <li> <p>Ahhoz, hogy a valid\u00e1ci\u00f3s hib\u00e1k illeszkedjenek a bootstrap st\u00edlushoz, meg kell adni, hogy a jquery validation a bootstrap-es CSS oszt\u00e1lyokat (is-valid \u00e9s is-invalid) haszn\u00e1lja. Ehhez k\u00e9sz\u00edts\u00fcnk egy <code>validation.js</code> f\u00e1jlt a <code>wwwroot/js</code> k\u00f6nyvt\u00e1rban f\u00e1jlt az al\u00e1bbi tartalommal</p> validation.js<pre><code>var settings = {\n    validClass: \"is-valid\",\n    errorClass: \"is-invalid\"\n};\n\n$.validator.setDefaults(settings);\n$.validator.unobtrusive.options = settings;\n</code></pre> </li> <li> <p>Ezt k\u00f6vet\u0151en m\u00e1r csak annyi dolgunk van, hogy a <code>_ValidationScriptsPartial.cshtml</code>-be hivatkozzuk be ezt a js f\u00e1jlt is. Fontos, hogy a <code>Pages\\Shares</code> alatt \u00e9s az <code>Areas\\Identity\\Pages</code> k\u00f6nyvt\u00e1rban is tal\u00e1lhat\u00f3 1-1 <code>_ValidationScriptsPartial.cshtml</code> f\u00e1jl. Mind a kett\u0151be tegy\u00fck bele!</p> _ValidationScriptsPartial.cshtml<pre><code>&lt;script src=\"~/lib/jquery-validation/dist/jquery.validate.min.js\"&gt;&lt;/script&gt;\n&lt;script src=\"~/lib/jquery-validation-unobtrusive/dist/jquery.validate.unobtrusive.min.js\"&gt;&lt;/script&gt;\n&lt;script src=\"~/js/validation.js\"&gt;&lt;/script&gt;\n</code></pre> </li> <li> <p>\u00cdgy m\u00e1r bootstrap alap\u00fa a valid\u00e1ci\u00f3, viszont ha hiba van akkor az eg\u00e9sz \u0171rlap lentebb cs\u00faszik, hogy meg tudjon jelenni a hiba\u00fczenet. Ezt k\u00e9tf\u00e9lek\u00e9ppen orvosolhatjuk.</p> <ul> <li>A legegyszer\u0171bb megold\u00e1s, hogyha csak a k\u00f6telez\u0151s\u00e9get ellen\u0151rz\u00fcnk, akkor nem jelen\u00edt\u00fcnk meg hiba\u00fczenetet. Ehhez annyit kell tenni, hogy az \u0171rlapon az egyes inputokhoz rendelt <code>&lt;span asp-validation-for</code> tageket kiszedj\u00fck. De sajnos ilyenkor az a hiba\u00fczenet sem jelenik meg ami azt jelzi, ha \u00e9rv\u00e9nytelen az email c\u00edm.</li> </ul> Login.cshtml<pre><code>&lt;div class=\"form-floating mb-3\"&gt;\n    &lt;input asp-for=\"Input.Email\" class=\"form-control\" autocomplete=\"username\" aria-required=\"true\" placeholder=\"name@example.com\" /&gt;\n    &lt;label asp-for=\"Input.Email\" class=\"form-label\"&gt;Email&lt;/label&gt;\n     &lt;span asp-validation-for=\"Input.Email\" class=\"text-danger\"&gt;&lt;/span&gt; \n&lt;/div&gt;\n</code></pre> <ul> <li>A m\u00e1sik megold\u00e1s, hogy kicsit nagyobb helyet hagyunk az egyes inputok k\u00f6z\u00f6tt (mb-4) \u00e9s az <code>invalid-tooltip</code> CSS oszt\u00e1lyt haszn\u00e1ljuk egy kis testreszab\u00e1ssal. Ez a password mez\u0151n \u00e1ll\u00edtsuk be, \u00e9s akkor mindk\u00e9t valid\u00e1ci\u00f3 l\u00e1tsz\u00f3dik.</li> </ul> Login.cshtml<pre><code>&lt;div class=\"form-floating mb-4\"&gt;\n    &lt;input asp-for=\"Input.Password\" class=\"form-control\" autocomplete=\"current-password\" aria-required=\"true\" placeholder=\"password\" /&gt;\n    &lt;label asp-for=\"Input.Password\" class=\"form-label\"&gt;Password&lt;/label&gt;\n    &lt;span asp-validation-for=\"Input.Password\" class=\"invalid-tooltip\"&gt;&lt;/span&gt;\n&lt;/div&gt;\n</code></pre> site.css<pre><code>.invalid-tooltip {\n    width: 100%;\n    margin-top: 0;\n    padding-top: 0;\n    padding-bottom: 0;\n    font-size: .75rem;\n}\n</code></pre> </li> </ol> Elk\u00e9sz\u00fclt valid\u00e1ci\u00f3s hib\u00e1k <p></p> <p>A k\u00e9tf\u00e9le valid\u00e1ci\u00f3s hiba</p>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#sajat-email-sender","title":"Saj\u00e1t email sender","text":"<p>Email k\u00fcld\u00e9s\u00e9hez sz\u00fcks\u00e9g\u00fcnk van egy SMTP szerverre, ami lehet a google szolg\u00e1ltat\u00e1sa is, vagy a fejleszt\u00e9si c\u00e9lokra kital\u00e1lt \u00e1l email k\u00fcld\u0151 az Ethereal is. A gyakorlaton mi ez ut\u00f3bbit fogjuk haszn\u00e1lni, mert a regisztr\u00e1ci\u00f3ja nagyon egyszer\u0171.</p> <p>Nyissuk meg a b\u00f6ng\u00e9sz\u0151ben a https://ethereal.email/create oldalt \u00e9s ott kattintsunk a Create Ethereal Accont gombra, ami azonnal l\u00e9tre is hozza a felhaszn\u00e1l\u00f3nkat, melynek adatai az al\u00e1bbi \u00e1br\u00e1n l\u00e1that\u00f3. Figyelem, v\u00e9letlen adatokkal hozza l\u00e9tre, \u00edgy az adatok mindenkin\u00e9l m\u00e1sok lehetnek!</p> <p></p> <p>Etheral account adatai</p> <p>Az \u00e1br\u00e1n l\u00e1that\u00f3 adatokat kell megadni ahhoz, hogy email tudjunk k\u00fcldeni ezzel az SMTP szolg\u00e1ltat\u00e1ssal. Ehhez el\u0151sz\u00f6r vegy\u00fcnk fel egy oszt\u00e1lyt EMailSettings n\u00e9vvel \u00e9s az al\u00e1bbi k\u00f3ddal.</p> Settings/EmailSetting.cs<pre><code>namespace BookShop.Web.RazorPage.Settings;\n\npublic class EmailSettings\n{\n    public string Mail { get; set; } = null!;\n    public string DisplayName { get; set; } = null!;\n    public string Password { get; set; } = null!;\n    public string Host { get; set; } = null!;\n    public int Port { get; set; }\n}\n</code></pre> <p>A fenti oszt\u00e1ly fogja t\u00e1rolni az SMTP szervere be\u00e1ll\u00edt\u00e1sait, azonban a konkr\u00e9t \u00e9rt\u00e9keket a config f\u00e1jlba szeretn\u00e9nk t\u00e1rolni, \u00edgy az <code>appsettings.Developement.json</code>-ba vegy\u00fck fel az al\u00e1bbi r\u00e9szt. Az adatok az ethereal oldalr\u00f3l sz\u00e1rmaznak. Fontos, hogy a saj\u00e1t adatainkkal t\u00f6lts\u00fck fel a f\u00e1jlt, mert egy\u00e9bk\u00e9nt nem fogjuk tudni az Ethereal oldal\u00e1n megn\u00e9zni az emaileket.</p> appsettings.Developement.json<pre><code>{\n  \"DetailedErrors\": true,\n  \"Logging\": {\n    \"LogLevel\": {\n      \"Default\": \"Information\",\n      \"Microsoft.AspNetCore\": \"Warning\"\n    }\n  },\n  \"EMailSettings\": {\n    \"Mail\": \"hilbert57@ethereal.email\",\n    \"DisplayName\": \"Hilbert Blick\",\n    \"Password\": \"5czSsn3CmAsKjgyykP\",\n    \"Host\": \"smtp.ethereal.email\",\n    \"Port\": 587\n  }\n}\n</code></pre> <p>Ezt k\u00f6vet\u0151en m\u00e1r csak az <code>IEmailSender</code> interf\u00e9szt kell megval\u00f3s\u00edtani, hogy t\u00e9nylegesen ki tudjuk k\u00fcldeni a leveleket, amihez hozzuk l\u00e9tre az EmailSender oszt\u00e1lyt az al\u00e1bbi implement\u00e1ci\u00f3val:</p> Services/EmailSender.cs<pre><code>using BookShop.Web.RazorPage.Settings;\nusing Microsoft.AspNetCore.Identity.UI.Services;\nusing Microsoft.Extensions.Options;\nusing System.Net.Mail;\n\nnamespace BookShop.Web.RazorPage.Services;\n\npublic class EmailSender(IOptions&lt;EmailSettings&gt; emailSettingsOptions, ILogger&lt;EmailSender&gt; logger) : IEmailSender\n{\n    private readonly EmailSettings emailSettings = emailSettingsOptions.Value;\n\n    public async Task SendEmailAsync(string email, string subject, string htmlMessage)\n    {\n        var client = new SmtpClient(emailSettings.Host, emailSettings.Port)\n        {\n            EnableSsl = true,\n            Credentials = new System.Net.NetworkCredential(emailSettings.Mail, emailSettings.Password)\n        };\n\n        var from = new MailAddress(emailSettings.Mail, emailSettings.DisplayName, System.Text.Encoding.UTF8);\n        var to = new MailAddress(email);\n\n        var message = new MailMessage(from, to)\n        {\n            Body = htmlMessage,\n            BodyEncoding = System.Text.Encoding.UTF8,\n            IsBodyHtml = true,\n            Subject = subject,\n            SubjectEncoding = System.Text.Encoding.UTF8\n        };\n\n        await client.SendMailAsync(message);\n\n        if (logger.IsEnabled(LogLevel.Information))\n            logger.LogInformation(\"Email sent to: {to}\", to.Address);\n    }\n}\n</code></pre> <p>A Program.cs-ben \u00e1ll\u00edtsuk be, hogy az appsettings alapj\u00e1n t\u00f6ltse fel a EMailSettings oszt\u00e1lyt, \u00e9s a saj\u00e1t e-mail sender implement\u00e1ci\u00f3nkat regisztr\u00e1ljuk be a DI-ba a <code>NoOpEmailSender</code> helyett.</p> Program.cs<pre><code>// builder.Services.TryAddTransient&lt;IEmailSender, NoOpEmailSender&gt;();\nbuilder.Services.TryAddTransient&lt;IEmailSender, EmailSender&gt;();\n\n// Reads the email settings from the configuration and registers it in the DI container.\nbuilder.Services.Configure&lt;EmailSettings&gt;(builder.Configuration.GetSection(\"EMailSettings\"));\n</code></pre>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#regisztracios-oldal-testreszabasa","title":"Regisztr\u00e1ci\u00f3s oldal testreszab\u00e1sa","text":"<p>Ha kipr\u00f3b\u00e1ljuk a regisztr\u00e1ci\u00f3s oldalt, az m\u00e9g nem m\u0171k\u00f6dik, mert a <code>DisplayName</code>-et nem k\u00e9rj\u00fck be a fel\u00fcleten.</p> <ol> <li> <p>Nyissuk meg az <code>Areas.Identity.Pages.Account/Registe.cshtml.cs</code> f\u00e1jlt \u00e9s az <code>InputModel</code>-be vegy\u00fck fel a DisplayName-et, illetve az <code>OnPostAsync</code>-ba \u00e1ll\u00edtsuk is be.</p> Register.cshtml.cs - InputModel<pre><code>public class InputModel\n{\n    [Required]\n    [EmailAddress]\n    [Display(Name = \"Email\")]\n    public string Email { get; set; }\n\n    [Required]\n    [Display(Name = \"Display name\")]\n    public string DisplayName { get; set; }\n\n    [Required]\n    [StringLength(100, ErrorMessage = \"The {0} must be at least {2} and at max {1} characters long.\", MinimumLength = 6)]\n    [DataType(DataType.Password)]\n    [Display(Name = \"Password\")]\n    public string Password { get; set; }\n\n    [DataType(DataType.Password)]\n    [Display(Name = \"Confirm password\")]\n    [Compare(\"Password\", ErrorMessage = \"The password and confirmation password do not match.\")]\n    public string ConfirmPassword { get; set; }\n}\n</code></pre> <ul> <li>Figyelj\u00fck meg, hogy a modell oszt\u00e1lyban az egyes tulajdons\u00e1gok el\u0151tt l\u00e9v\u0151 attib\u00fatumokkal \u00e1ll\u00edtjuk be, hogy melyik megz\u0151 k\u00fctelez\u0151, vagy hogy a <code>ConfirmPassword</code> meg kell egyezzen a <code>Password</code>-del. Teh\u00e1t attrib\u00fatum alap\u00fa valid\u00e1ci\u00f3t haszn\u00e1lunk.</li> </ul> Register.cshtml.cs - OnPostAsync<pre><code>public async Task&lt;IActionResult&gt; OnPostAsync(string returnUrl = null)\n{\n    returnUrl ??= Url.Content(\"~/\");\n    ExternalLogins = (await _signInManager.GetExternalAuthenticationSchemesAsync()).ToList();\n    if (ModelState.IsValid)\n    {\n        var user = CreateUser();\n\n        // Set the display name for the user.\n        user.DisplayName = Input.DisplayName;\n\n        await _userStore.SetUserNameAsync(user, Input.Email, CancellationToken.None);\n        await _emailStore.SetEmailAsync(user, Input.Email, CancellationToken.None);\n        var result = await _userManager.CreateAsync(user, Input.Password);\n\n    // ...\n    }\n\n    // If we got this far, something failed, redisplay form\n    return Page();\n}\n</code></pre> <ul> <li>Sikeres valid\u00e1ci\u00f3 ut\u00e1n hozzuk l\u00e9tre a felhaszn\u00e1l\u00f3t a <code>CreateUser</code>-re, majd ezt k\u00f6vet\u0151en \u00e1ll\u00edtjuk be a <code>DisplayName</code>-et. K\u00fcl\u00f6n f\u00fcggv\u00e9nyek seg\u00edtik az <code>UserName</code> \u00e9s <code>Email</code> be\u00e1ll\u00edt\u00e1s\u00e1t, ami ut\u00e1n a <code>_userManager.CreateAsync()</code> hozza t\u00e9nylegesen l\u00e9tre a felhaszn\u00e1l\u00f3t a megadott jelsz\u00f3val.</li> </ul> </li> <li> <p>Ezt k\u00f6vet\u0151en a fel\u00fclere is tegy\u00fck ki az email c\u00edm al\u00e1 a sz\u00f6vegdobozt, amiben a felhaszn\u00e1l\u00f3 meg tudja adni a nev\u00e9t.</p> Register.cshtml<pre><code>&lt;form id=\"registerForm\" asp-route-returnUrl=\"@Model.ReturnUrl\" method=\"post\"&gt;\n    &lt;h2&gt;Create a new account.&lt;/h2&gt;\n    &lt;hr /&gt;\n    &lt;div asp-validation-summary=\"ModelOnly\" class=\"text-danger\" role=\"alert\"&gt;&lt;/div&gt;\n    &lt;div class=\"form-floating mb-3\"&gt;\n        &lt;input asp-for=\"Input.Email\" class=\"form-control\" autocomplete=\"username\" aria-required=\"true\" placeholder=\"name@example.com\" /&gt;\n        &lt;label asp-for=\"Input.Email\"&gt;Email&lt;/label&gt;\n        &lt;span asp-validation-for=\"Input.Email\" class=\"text-danger\"&gt;&lt;/span&gt;\n    &lt;/div&gt;\n    &lt;div class=\"form-floating mb-3\"&gt;\n        &lt;input asp-for=\"Input.DisplayName\" class=\"form-control\" aria-required=\"true\" placeholder=\"\" /&gt;\n        &lt;label asp-for=\"Input.DisplayName\"&gt;Display name&lt;/label&gt;\n        &lt;span asp-validation-for=\"Input.DisplayName\" class=\"text-danger\"&gt;&lt;/span&gt;\n    &lt;/div&gt;\n    &lt;div class=\"form-floating mb-3\"&gt;\n        &lt;input asp-for=\"Input.Password\" class=\"form-control\" autocomplete=\"new-password\" aria-required=\"true\" placeholder=\"password\" /&gt;\n        &lt;label asp-for=\"Input.Password\"&gt;Password&lt;/label&gt;\n        &lt;span asp-validation-for=\"Input.Password\" class=\"text-danger\"&gt;&lt;/span&gt;\n    &lt;/div&gt;\n    &lt;div class=\"form-floating mb-3\"&gt;\n        &lt;input asp-for=\"Input.ConfirmPassword\" class=\"form-control\" autocomplete=\"new-password\" aria-required=\"true\" placeholder=\"password\" /&gt;\n        &lt;label asp-for=\"Input.ConfirmPassword\"&gt;Confirm Password&lt;/label&gt;\n        &lt;span asp-validation-for=\"Input.ConfirmPassword\" class=\"text-danger\"&gt;&lt;/span&gt;\n    &lt;/div&gt;\n    &lt;button id=\"registerSubmit\" type=\"submit\" class=\"w-100 btn btn-lg btn-primary\"&gt;Register&lt;/button&gt;\n&lt;/form&gt;\n</code></pre> </li> <li> <p>Pr\u00f3b\u00e1ljuk ki az oldalt. Mivel a kor\u00e1bbiakban l\u00e9trehoztuk Scaffoldinggal a ConfirmEmail \u00e9s _StatusMessage oldalakat miden m\u0171k\u00f6dni fog. Viszont ha megn\u00e9zz\u00fck a <code>Register.cshtml.cs</code> f\u00e1jlban a k\u00f3dot, akkor azt vehetj\u00fck \u00e9rszre, hogy akkor is legener\u00e1lja a j\u00f3v\u00e1hagy\u00e1shoz sz\u00fcks\u00e9ges linket (ami null lesz ha nincs a ConfirmEmail legener\u00e1lva), ha nem kell kik\u00fcldeni a meger\u0151s\u00edt\u00e9st a felhaszn\u00e1l\u00f3nak.</p> </li> </ol> Csak akkor gener\u00e1ljuk a j\u00f3v\u00e1hagy\u00f3 linket ha sz\u00fcks\u00e9ges <ul> <li>A link gener\u00e1l\u00e1st el\u00e9g lenne akkor futtatni, ha t\u00e9nyleg ki kell k\u00fcldeni a linket. Az alap\u00e9relmezett implement\u00e1ci\u00f3ban <code>DefaultUserConfirmation</code> a logika az, hogy a meger\u0151s\u00edtett email n\u00e9zi <code>IsEmailConfirmedAsync</code>. Teh\u00e1t az eg\u00e9sz email gener\u00e1l\u00e1sos r\u00e9szt bele kell tenni az <code>if (_userManager.Options.SignIn.RequireConfirmedAccount)</code> al\u00e1.</li> </ul> Register.cshtml.cs<pre><code>if (result.Succeeded)\n{\n    _logger.LogInformation(\"User created a new account with password.\");\n\n    if (_userManager.Options.SignIn.RequireConfirmedAccount)\n    {\n        var userId = await _userManager.GetUserIdAsync(user);\n        var code = await _userManager.GenerateEmailConfirmationTokenAsync(user);\n        code = WebEncoders.Base64UrlEncode(Encoding.UTF8.GetBytes(code));\n        var callbackUrl = Url.Page(\n            \"/Account/ConfirmEmail\",\n            pageHandler: null,\n            values: new { area = \"Identity\", userId = userId, code = code, returnUrl = returnUrl },\n            protocol: Request.Scheme);\n\n        await _emailSender.SendEmailAsync(Input.Email, \"Confirm your email\",\n            $\"Please confirm your account by &lt;a href='{HtmlEncoder.Default.Encode(callbackUrl)}'&gt;clicking here&lt;/a&gt;.\");\n\n    // if (_userManager.Options.SignIn.RequireConfirmedAccount)\n    // {\n        return RedirectToPage(\"RegisterConfirmation\", new { email = Input.Email, returnUrl = returnUrl });\n    }\n    else\n    {\n        await _signInManager.SignInAsync(user, isPersistent: false);\n        return LocalRedirect(returnUrl);\n    }\n}\n</code></pre> <ol> <li> <p>Regisztr\u00e1ljunk be egy \u00faj felhaszn\u00e1l\u00f3t az al\u00e1bbi adatokkal</p> <ul> <li>email: test@example.com</li> <li>displayName: Teszt Elek</li> <li>password: Password123!</li> </ul> </li> </ol> Sikeres regisztr\u00e1ci\u00f3 <ol> <li> <p>Felhaszn\u00e1l\u00f3 l\u00e9trehoz\u00e1sa </p> </li> <li> <p>Meger\u0151s\u00edt\u00e9s sz\u00fcks\u00e9ges. Csak ha be van kapcsolva a <code>options.SignIn.RequireConfirmedAccount = true</code> akkor ez az oldal fogad. Egy\u00e9bk\u00e9nt bel\u00e9ptet. </p> </li> <li> <p>Meg\u00e9rkezik a meger\u0151s\u00edt\u0151 email </p> </li> <li> <p>Meger\u0151s\u00edt\u0151 email tartalma, benne a linkkel. </p> </li> <li> <p>Sikeres meger\u0151s\u00edt\u00e9s </p> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#jogosultsag-ellenorzes","title":"Jogosults\u00e1g ellen\u0151rz\u00e9s","text":"<p>Azzal, hogy van felhaszn\u00e1l\u00f3 \u00e9s jogosults\u00e1g kezel\u00e9s\u00fcnk, m\u00e1r be tudjuk \u00e1ll\u00edtani, hogy egyes funkci\u00f3k csak bel\u00e9pett felhaszn\u00e1l\u00f3knak, vagy adott szerepk\u00f6rnek legyenek csak el\u00e9rhet\u0151k.</p> <ol> <li> <p>El\u0151sz\u00f6r a <code>Book.cshtml.cs</code> oldalon \u00e1ll\u00edtsuk be, hogy  a kos\u00e1rba t\u00e9telkor szerver oldalon ellen\u0151rizz\u00fck, hogy be van-e l\u00e9pve a felhaszn\u00e1l\u00f3. Ha nincs akkor 401-el (UnAuthorized)-ot adjunk vissza.</p> Book.cshtml.cs<pre><code>public async Task&lt;IActionResult&gt; OnPostAddToCartAsync(int bookId) \n{\n    if(User.Identity?.IsAuthenticated != true)\n        return Unauthorized();\n\n    // ...\n}\n</code></pre> </li> <li> <p>Ugyanezt \u00e1ll\u00edtsuk be a komment l\u00e9trehoz\u00e1s\u00e1n\u00e1l is.</p> Book.cshtml.cs<pre><code>public async Task&lt;IActionResult&gt; OnPostCreateCommentAsync()\n{\n    if (User.Identity?.IsAuthenticated != true)\n        return Unauthorized();\n\n    // ..\n}\n</code></pre> </li> <li> <p>Pr\u00f3b\u00e1ljuk ki, hogy t\u00e9nyleg hibaoldalt kapunk.</p> </li> <li> <p>Rejts\u00fck el a gombokat (\u00faj komment, kos\u00e1rba \u00e9s \u00faj aj\u00e1nl\u00f3), ha nincs bel\u00e9pve a felhaszn\u00e1l\u00f3.</p> Book.cshml - Kos\u00e1rba<pre><code>@if (User.Identity?.IsAuthenticated == true)\n{\n    &lt;form asp-page-handler=\"AddToCart\"&gt;\n        &lt;input type=\"hidden\" name=\"bookId\" value=\"@Model.Book.Id\" /&gt;\n        &lt;button class=\"btn btn-outline-primary\"&gt;Kor\u00e1rba&lt;/button&gt;\n    &lt;/form&gt;\n}\n</code></pre> Book.cshml - \u00daj aj\u00e1nl\u00f3<pre><code>@if (User.Identity?.IsAuthenticated == true)\n{\n    &lt;a asp-page=\"CreateComment\" asp-route-bookId=\"@Model.Book.Id\"&gt;\u00daj aj\u00e1nl\u00f3 \u00edr\u00e1sa &amp;raquo;&lt;/a&gt;\n}\n</code></pre> Book.cshml - \u00daj komment<pre><code>@if (User.Identity?.IsAuthenticated == true)\n{\n    &lt;form asp-page-handler=\"CreateComment\"&gt;\n        @* Hidden field bound to NewComment.BookId so it will be set for the click handler. *@\n        &lt;input type=\"hidden\" asp-for=\"NewComment.BookId\" /&gt;\n\n        &lt;div class=\"d-flex\"&gt;\n            &lt;div class=\"d-flex flex-column align-items-center flex-shrink-0 me-3\"&gt;\n                &lt;i class=\"bi bi-person-square fs-1\"&gt;&lt;/i&gt;\n                &lt;div class=\"text-muted\"&gt;@(DateTime.Now.ToShortDateString())&lt;/div&gt;\n                &lt;div class=\"text-muted\"&gt;@(DateTime.Now.ToShortTimeString())&lt;/div&gt;\n            &lt;/div&gt;\n\n            &lt;textarea class=\"w-100\" rows=\"3\" asp-for=\"NewComment.Text\"&gt;&lt;/textarea&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"d-flex justify-content-end my-2\"&gt;\n            &lt;button type=\"submit\" class=\"btn btn-outline-primary\"&gt;Hozz\u00e1sz\u00f3lok&lt;/button&gt;\n        &lt;/div&gt;\n    &lt;/form&gt;\n}\nelse\n{\n    &lt;div&gt;Komment \u00edr\u00e1s\u00e1hoz be kell jelentkezned!&lt;/div&gt;\n}\n</code></pre> </li> <li> <p>Ezt k\u00f6vet\u0151en m\u00e1r a gombok sem l\u00e1tsz\u00f3dnak.</p> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#kosaram-oldal-lathatosag","title":"Kosaram oldal l\u00e1that\u00f3s\u00e1g","text":"<p>T\u00fcntess\u00fck el a kosaram oldal linkj\u00e9t is ha nincs bel\u00e9pve a felhaszn\u00e1l\u00f3.</p> <ol> <li> <p>A <code>_Layout.cshtml</code> oldalon rejts\u00fck el a men\u00fcpontot ha nincs bel\u00e9pve a felhaszn\u00e1l\u00f3.</p> _Layout.cshtml<pre><code>@if( User.Identity?.IsAuthenticated == true )\n{\n    &lt;li class=\"nav-item position-relative\"&gt;\n            &lt;a class=\"nav-link text-dark\" asp-area=\"\" asp-page=\"/Cart\"&gt;\n            Kosaram\n            @if (Context.Session.Get&lt;List&lt;CartItem&gt;&gt;(BookShopConstants.CartSessionKey)?.Any() == true)\n            {\n                &lt;span class=\"position-absolute start-100 translate-middle badge rounded-pill bg-danger\"&gt;\n                    @(Context.Session.Get&lt;List&lt;CartItem&gt;&gt;(BookShopConstants.CartSessionKey)?.Sum(x =&gt; x.Count) ?? 0)\n                    &lt;span class=\"visually-hidden\"&gt;elem a kos\u00e1rban&lt;/span&gt;\n                &lt;/span&gt;\n            }\n        &lt;/a&gt;\n    &lt;/li&gt;\n}\n</code></pre> </li> <li> <p>A code behind-ban is v\u00e9dj\u00fck le, hogy csak bel\u00e9pett felhaszn\u00e1l\u00f3 h\u00edvhassa. Itt m\u00e1r haszn\u00e1lhatjuk az <code>[Authorize]</code> attrib\u00fatumot, mert az eg\u00e9sz oldalt nem kell el\u00e9rni.     </p>Cart.cshtml.cs<pre><code>[Authorize]\npublic class CartModel(IBookService bookService) : PageModel\n</code></pre><p></p> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#admin-oldalak-lathatosaga","title":"Admin oldalak l\u00e1that\u00f3s\u00e1ga","text":"<p>Az alkalmaz\u00e1shoz, k\u00fcl\u00f6nb\u0151z\u0151 felt\u00f6lt\u0151 \u00e9s szerkeszt\u0151 oldalakat is kell k\u00e9sz\u00edteni a k\u00f6nyvekhez, kateg\u00f3ri\u00e1khoz, vagy ak\u00e1r a felhaszn\u00e1l\u00f3l\u00f3khoz. Annak \u00e9rdek\u00e9ben, hogy ezeknem az \"Admin\" oldalaknak a jogosults\u00e1g kezel\u00e9s\u00e9t egyszer\u0171en tudjuk be\u00e1ll\u00edtani egy \u00faj m\u00f3dszerrel ismerked\u00fcnk meg.</p> <ol> <li> <p>El\u0151sz\u00f6r a layout oldalra a navig\u00e1ci\u00f3s men\u00fcbe vegy\u00fck fel a Kateg\u00f3ri\u00e1k szerkeszt\u00e9se, K\u00f6nyvek szerkeszt\u00e9se, Felhaszn\u00e1l\u00f3k kezel\u00e9se linkeket. Azonban mivel ez sok helyet foglal tegy\u00fck az eg\u00e9szet az Adminisztr\u00e1ci\u00f3 leg\u00f6rd\u00fcl\u0151be. Ehhez az al\u00e1bbiak szerint m\u00f3dos\u00edtsuk a layout oldalt.</p> _Layout.cshtml<pre><code>&lt;ul class=\"navbar-nav flex-grow-1\"&gt;\n    @* Other links *@\n\n    @if (User.IsInRole(\"Admin\"))\n    {\n        &lt;li class=\"nav-item dropdown\"&gt;\n            &lt;a class=\"nav-link dropdown-toggle\" href=\"#\" id=\"navbarAdmin\" role=\"button\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\"&gt;\n                Adminisztr\u00e1ci\u00f3\n            &lt;/a&gt;\n            &lt;ul class=\"dropdown-menu\" aria-labelledby=\"navbarAdmin\"&gt;\n                &lt;li&gt;\n                    &lt;a class=\"dropdown-item\" asp-area=\"\" asp-page=\"/Admin/ManageCategories\"&gt;Kateg\u00f3ri\u00e1k&lt;/a&gt;\n                &lt;/li&gt;\n                &lt;li&gt;\n                    &lt;a class=\"dropdown-item\" asp-area=\"\" asp-page=\"/Admin/ManageBooks\"&gt;K\u00f6nyvek&lt;/a&gt;\n                &lt;/li&gt;\n                &lt;li&gt;\n                    &lt;hr class=\"dropdown-divider\"&gt;\n                &lt;/li&gt;\n                &lt;li&gt;\n                    &lt;a class=\"dropdown-item\" asp-area=\"\" asp-page=\"/Admin/ManageUsers\"&gt;Felhaszn\u00e1l\u00f3k&lt;/a&gt;\n                &lt;/li&gt;\n            &lt;/ul&gt;\n        &lt;/li&gt;\n    }\n&lt;/ul&gt;\n&lt;partial name=\"_LoginPartial\" /&gt;\n</code></pre> </li> <li> <p>Amint l\u00e1that\u00f3 az adminisztr\u00e1ci\u00f3s oldalakat egy <code>Admin</code> k\u00f6nyvt\u00e1rba szervezz\u00fck, hogy egyszer\u0171bb legyen majd az el\u00e9r\u00e9s korl\u00e1toz\u00e1sa. Ezen fel\u00fcl figyelj\u00fck meg, hogy ezt a men\u00fcpontot csak akkor \u00e9rheti el a felhaszn\u00e1l\u00f3, ha \u0151 is benne van az <code>Admin</code> szerepk\u00f6rben. Hozzuk is l\u00e9tre a sz\u00fcks\u00e9ges oldalakat a <code>Pages/Admin</code> k\u00f6nyvt\u00e1rban.</p> <ul> <li>Pages/Admin/ManageBooks.cshtml</li> <li>Pages/Admin/ManageCategories.cshtml</li> <li>Pages/Admin/ManageUsers.cshtml</li> </ul> Admin men\u00fcpontok <p></p> <p>Adminisztr\u00e1ci\u00f3s men\u00fcpontok</p> </li> <li> <p>Ha \u00edgy kipr\u00f3b\u00e1ljuk az alkalmaz\u00e1st egy nem adminisztr\u00e1tor felhaszn\u00e1l\u00f3val, akkor a men\u00fcpontot nem fogjuk l\u00e1tni, de ha ismerj\u00fck az URL-t akkor az oldal bet\u00f6lt. Ez egy komoly hiba, mert mindig v\u00e9deni kell a backend oldali funkci\u00f3t is, az nem ad biztons\u00e1got, hogy a fel\u00fclten elrejtj\u00fck a linket.</p> </li> <li> <p>\u00c1ll\u00edtsuk be, hogy a <code>Pages/Amin</code> k\u00f6nyvt\u00e1r tartalm\u00e1t csak <code>Admin</code> szerepk\u00f6rben l\u00e9v\u0151 felhaszn\u00e1l\u00f3k \u00e9rhess\u00e9k el. Ehhez l\u00e9trehozunk egy policy-t, ami megk\u00f6veteli, hogy a felhaszn\u00e1l\u00f3 benne legyen az adott szerepk\u00f6rben. Ehhez az al\u00e1bbi k\u00f3dr\u00e9szletet kell beletenni a <code>Program.cs</code>-be a <code>RequestContext</code> DI-ba regisztr\u00e1l\u00e1sa ut\u00e1n.</p> Program.cs<pre><code>builder.Services.AddAuthorizationBuilder()\n    .AddPolicy(\"RequireAdminRole\", policy =&gt; policy.RequireRole(\"Admin\"));\n\nbuilder.Services.AddRazorPages(options =&gt;\n{\n    options.Conventions.AuthorizeFolder(\"/Admin\", \"RequireAdministratorRole\");\n});\n</code></pre> </li> <li> <p>Hasonl\u00f3 konvenci\u00f3 alap\u00fa jogosults\u00e1g kezel\u00e9st a hivatalos dokument\u00e1ci\u00f3ban tekinthetj\u00fck meg.</p> </li> <li> <p>\u00cdgy m\u00e1r az oldalt nem lehet el\u00e9rni, de a login oldalra sem tud \u00e1tir\u00e1ny\u00edtani, mert azt nem a megfelel\u0151 helyen keresi, \u00edgy 404-es hibaoldalt kapunk. A megold\u00e1shoz a <code>Program.cs</code>-ben az <code>AddRazorPages</code> (amit az el\u0151bb m\u00f3dos\u00edtottunk) m\u00f6g\u00e9 illessz\u00fck be az al\u00e1bbi k\u00f3dot.</p> Program.cs<pre><code>builder.Services.ConfigureApplicationCookie(options =&gt;\n{\n    options.Cookie.Name = \".IdentityNet10.Auth\";\n    options.Cookie.HttpOnly = true;\n    options.Cookie.SecurePolicy = CookieSecurePolicy.Always;\n    options.Cookie.SameSite = SameSiteMode.Lax; // or Strict for pure server\u2011rendered sites\n\n    options.LoginPath = \"/Identity/Account/Login\";\n    options.LogoutPath = \"/Identity/Account/Logout\";\n    options.AccessDeniedPath = \"/Identity/Account/AccessDenied\";\n\n    options.SlidingExpiration = true;\n    options.ExpireTimeSpan = TimeSpan.FromMinutes(5);\n});\n</code></pre> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#onallo-feladat-profil-oldalak-opcionalis","title":"\u00d6n\u00e1ll\u00f3 feladat: Profil oldalak (opcion\u00e1lis)","text":"<p>\u00d6n\u00e1ll\u00f3 feladat: Profil oldalak</p> <ul> <li>Gener\u00e1lja le a profil adatokat szerkeszt\u0151 oldalakat is, ahol a felhaszn\u00e1l\u00f3 meg tudja v\u00e1ltoztatni a szem\u00e9lyed adatait, email c\u00edm\u00e9t, jelszav\u00e1t, vagy a 2FA adatokat. </li> </ul>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#3rd-party-login","title":"3<sup>rd</sup> party login","text":""},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#app-registration-gui","title":"App registration (GUI)","text":"<p>Nagy val\u00f3sz\u00edn\u0171s\u00e9ggel ez a megold\u00e1s a BME tenantban nem haszn\u00e1lhat\u00f3, mert r\u00e9szlegesen letiltott\u00e1k.</p> <ol> <li> <p>Ahhoz, hogy Microsoft Accounttal is be lehessen l\u00e9pni be kell regisztr\u00e1lnunk az alkalmaz\u00e1st az Azure port\u00e1lon, ahol a fent tal\u00e1lhat\u00f3 \u00daj regisztr\u00e1ci\u00f3-ra kattintva tudunk \u00faj alkalmaz\u00e1st regisztr\u00e1lni. Ez l\u00e1thatjuk az al\u00e1bbi \u00e1br\u00e1n.</p> <p></p> <p>Azure App registrations</p> </li> <li> <p>Adjuk meg az alkalmaz\u00e1s adatait (ha el\u00e9rhet\u0151 a webes fel\u00fclet). \u00c9rdemes megpr\u00f3b\u00e1lni a k\u00f6zvetlen linket, mert akkor lehet, hogy engedi: \u00daj alkalmaz\u00e1s regisztr\u00e1l\u00e1s</p> <ul> <li>Alkalmaz\u00e1s neve</li> <li>Kik \u00e9rhetik el az alkalmaz\u00e1st</li> <li>Milyen URL-re kell visszair\u00e1ny\u00edtani a bejelentkez\u00e9s ut\u00e1n. Ide az alkalmaz\u00e1s URL + a /signin-microsoft -ot kell megadni. http://localhost:5001/signin-microsoft \u00e9s a https://localhost:44329/signin-microsoft fontos, hogy a HTTPS-es URL-t is megadjuk!</li> <li>V\u00e9g\u00fcl kattintsunk a Regisztr\u00e1ci\u00f3 gombra.</li> </ul> <p></p> <p>\u00daj alkalmaz\u00e1s regisztr\u00e1ci\u00f3</p> </li> <li> <p>Majd k\u00e9sz\u00edts\u00fcnk hozz\u00e1 priv\u00e1t kulcsot is</p> <p></p> <p>App registration be\u00e1ll\u00edt\u00e1sa</p> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#app-registration-powershell","title":"App registration (powershell)","text":"<p>Sajn\u00e1latos m\u00f3don a BME Azure-ban ezt a webes fel\u00fcletet m\u00e1r nem lehet el\u00e9rni, kis tr\u00fckk\u00f6z\u00e9ssel m\u00e9g a l\u00e9trehoz\u00e1s kij\u00e1tszhat\u00f3, de m\u00e1r be\u00e1ll\u00edtani nem tudjuk.</p> <ol> <li>Ind\u00edtsunk el egy VS Code-ot</li> <li> <p>Telep\u00edts\u00fck fel az Azure Application Registration extensiont, majd ind\u00edtsuk \u00fajra a VS Code-ot.</p> <p></p> <p>Azure Application Registration extension</p> </li> <li> <p>Ezt k\u00f6vet\u0151en nyissuk meg bal oldalon a kieg\u00e9sz\u00edt\u0151t, \u00e9s lent az Application Registration r\u00e9sz kell nek\u00fcnk.</p> </li> <li> <p>Ha nincs feltelep\u00edtve, akkor telep\u00eds\u00fck fel az Azure CLI-t. Ehhez a terminal ablakban futtassuk az al\u00e1bbi parancsot.</p> <pre><code>winget install --exact --id Microsoft.AzureCLI\n</code></pre> </li> <li> <p>L\u00e9pj\u00fcnk be Azure CLI-vel, ehhez k\u00e9rni fogja a TenantId-t ami 6a3548ab-7570-4271-91a8-58da00697029. Illetve fel fog dobni egy b\u00f6ng\u00e9sz\u0151 ablakot a bejelentkez\u00e9shez, ahol meg kell adni a BME-s felhaszn\u00e1l\u00f3t.</p> </li> <li> <p>Bel\u00e9p\u00e9s ut\u00e1n m\u00e1r az Application Registration mellett a + gombra kattinva l\u00e9tre is tudjuk hozni az \u00faj regisztr\u00e1ci\u00f3t.</p> <ul> <li>El\u0151sz\u00f6r v\u00e1lasszuk ki, hogy kik l\u00e9phetnek be. V\u00e1lasszuk a Multi Tenants opci\u00f3t.          /// caption     Bejelentkez\u00e9si m\u00f3d megad\u00e1sa     ///</li> <li>Majd adjuk meg az alkalmaz\u00e1s nev\u00e9t.          /// caption     Application n\u00e9v megad\u00e1sa     ///</li> <li>V\u00e9g\u00fcl friss\u00edts\u00fck az Application Registration list\u00e1t.</li> </ul> </li> <li> <p>Ha mindent j\u00f3l csin\u00e1ltuk a list\u00e1ban le tudjuk nyitni az \u00faj App registration-t, ahonnan a ClientId-ra lesz sz\u00fcks\u00e9g\u00fcnk, illetve be kell \u00e1ll\u00edtania Redirect URIs-t \u00e9s a Credentials alatt tal\u00e1lhat\u00f3 Client Secrets-ben kell egy \u00faj secretet l\u00e9trehozni.</p> <p></p> <p>Regisztr\u00e1lt alkalmaz\u00e1s Azure-ben.</p> </li> <li> <p>A Redirect URIs alatt a Web jobb klikk -&gt; Add \u00e9s adjuk meg a https://localhost:44329/signin-microsoft URI-t.</p> </li> <li> <p>Majd hozzuk l\u00e9tre az \u00faj secretet. (Client Secrets -&gt; jobb klikk -&gt; Add)</p> <ul> <li>Els\u0151 l\u00e9p\u00e9sk\u00e9nt description-t k\u00e9r, ahova \u00edrjuk be a 'Login-secret'-et vagy b\u00e1rmit ez csak egy le\u00edr\u00e1s, hogy t\u00f6bb titok eset\u00e9n tudjuk melyiket mire haszn\u00e1ljuk.</li> <li>M\u00e1sodik l\u00e9p\u00e9sk\u00e9nt pedig a lej\u00e1rat d\u00e1tum\u00e1t kell megadni.</li> </ul> <p>Secret \u00e9rt\u00e9ke csak a l\u00e9trehoz\u00e1skor \u00e9rhet\u0151 el</p> <p>A secret \u00e9rt\u00e9ke automatikusan a v\u00e1g\u00f3lapra ker\u00fclt l\u00e9trehoz\u00e1skor \u00e9s k\u00e9s\u0151bb az \u00e9rt\u00e9k\u00e9t m\u00e1r nem lehet kiolvasni! \u00cdgy mens\u00fck el, hogy k\u00e9s\u0151bb ne kelljen \u00fajat l\u00e9trehozni!</p> </li> <li> <p>T\u00f6r\u00f6lni is tudjuk a titkokat, vagy ak\u00e1r az eg\u00e9sz App registration-t, csak arra kell figyelni, hogy ha a jobb klikk -&gt; delete-re kattintunk akkor ut\u00e1na a jobb als\u00f3 sarokban r\u00e1k\u00e9rdez, hogy val\u00f3ban t\u00f6r\u00f6lni szeretn\u00e9nk-e. Ott kell meger\u0151s\u00edteni a t\u00f6rl\u00e9st.</p> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#ms-auth-hozzaadasa-a-projekthez","title":"MS Auth hozz\u00e1ad\u00e1sa a projekthez","text":"<p>Bel\u00e9p\u00e9shez sz\u00fcks\u00e9g\u00fcnk van egy harmadik f\u00e9l \u00e1ltal ny\u00fajtott authentik\u00e1ci\u00f3s mechanizmusra. A legt\u00f6bb ilyen megold\u00e1s egyszer\u0171en egy middleware be\u00e9kel\u00e9s\u00e9t jelenti a rendszerbe, ahol a k\u00fcls\u0151 providerrel kommunik\u00e1l.</p> <ol> <li>A Microsoft Account haszn\u00e1lat\u00e1hoz a <code>Microsoft.AspNetCore.Authentication.MicrosoftAccount</code> NuGet packaget kell feltelep\u00edteni a Webes projekthez. \u00dcgyelj\u00fcnk, hogy a megfelel\u0151 verzi\u00f3t v\u00e1lasszuk bel\u0151le, ami az ASP.NET Core verzi\u00f3val megegyezik.</li> <li> <p>Majd m\u00f3dos\u00edtsuk a DI konfigur\u00e1ci\u00f3t, hogy az authentik\u00e1ci\u00f3 Microsoft Accountot (is) haszn\u00e1ljon. Ehhez m\u00e1soljuk be az al\u00e1bbi k\u00f3dr\u00e9szletet a <code>Program.cs</code>-be az <code>AddIdentity</code> ut\u00e1n.</p> Program.cs<pre><code>builder.Services.AddAuthentication().AddMicrosoftAccount(options =&gt;\n{\n    options.ClientId = builder.Configuration[\"Authentication:Microsoft:ClientId\"] ?? throw new InvalidOperationException(\"Microsoft ClientId not found in configuration.\");\n    options.ClientSecret = builder.Configuration[\"Authentication:Microsoft:ClientSecret\"] ?? throw new InvalidOperationException(\"Microsoft ClientSecret not found in configuration.\");\n});\n</code></pre> </li> <li> <p>A k\u00f3dba nem \u00e9gett\u00fck bele a <code>ClientId</code>-t \u00e9s a <code>ClientSecret</code>-et (ezeket hoztuk l\u00e9tre az App registrationn\u00e9l), hanem az <code>appsettings.Developement.json</code>-b\u0151l olvassuk ki. Ez\u00e9rt oda fel kell venni az al\u00e1bbi k\u00f3dr\u00e9szletet. Fontos, hogy a <code>ClientId</code> \u00e9s <code>ClientSecret</code> \u00e9rt\u00e9ket a saj\u00e1t App registration-b\u0151l kell venni.</p> appsettings.Developement.json<pre><code>\"Authentication\": {\n    \"Microsoft\": {\n    \"ClientId\": \"cfe7...\",\n    \"ClientSecret\": \"9f...\"\n    }\n}\n</code></pre> </li> <li> <p>Ha elind\u00edtjuk az alkalmaz\u00e1st, akkor a Login oldalon megjelenik a k\u00fcls\u0151 hiteles\u00edt\u00e9s szolg\u00e1ltat\u00f3kn\u00e1l a Microsoft gomb. Ha r\u00e1kattinva nem t\u00f6rt\u00e9nik semmi, akkor l\u00e9tre kell hozni Scaffoldinggal ay <code>ExternalLogin</code> oldalt.</p> <pre><code>dotnet aspnet-codegenerator identity -dc BookShop.Dal.BookShopDbContext -u BookShop.Dal.Entities.ApplicationUser  --files \"Account.ExternalLogin\"\n</code></pre> <p>Hib\u00e1san gener\u00e1lt f\u00e1jlok t\u00f6rl\u00e9se</p> <p>\u00dcgyelj\u00fcnk r\u00e1, hogy ilyenkor a <code>Data</code> k\u00f6nyvt\u00e1rat t\u00f6r\u00fclj\u00fck kell \u00e9s a <code>Program.cs</code>-ben ha m\u00e9gegszer regisztr\u00e1lja a DbContext-et akkor azt is t\u00f6r\u00f6lj\u00fck.</p> </li> <li> <p>Ezt k\u00f6vet\u0151en a Microsoft gombra kattinva m\u00e1r \u00e1tir\u00e1ny\u00edt a Microsoft fi\u00f3kos bel\u00e9p\u00e9s oldal\u00e1ra, ahol a BME-s felhaszn\u00e1l\u00f3nkkal tudunk bel\u00e9pni.</p> <p></p> <p>Sz\u00fcks\u00e9ges enged\u00e9lyek bek\u00e9r\u00e9se</p> </li> <li> <p>Ha beleegyezt\u00fcnk a jogosults\u00e1gok megad\u00e1s\u00e1ba, akkor visszair\u00e1ny\u00edt az alkalmaz\u00e1sunkba az <code>ExternalLogin</code>, ahol m\u00e1r el\u00e9rj\u00fck a k\u00fcls\u0151 azonos\u00edt\u00e1sb\u00f3l rendelkez\u00e9sre \u00e1ll\u00f3 adatokat mint az email c\u00edm.</p> <p></p> <p>ExternalLogin oldal bet\u00f6lt\u00e9se</p> </li> <li> <p>Ha r\u00e1kattintunk a Register gombra, akkor viszont elsz\u00e1ll a k\u00f3d, mert a <code>DisplayName</code> nincs megadva.</p> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#onallo-feladat-externallogin-kiegeszitese","title":"\u00d6n\u00e1ll\u00f3 feladat: ExternalLogin kieg\u00e9sz\u00edt\u00e9se","text":"<p>\u00d6n\u00e1ll\u00f3 feladat: DisplayName felv\u00e9tele az <code>ExternalLogin</code> oldalra</p> <ul> <li>A k\u00f3d behindban az InputModel-be vegye fel a <code>DisplayName</code>-et</li> <li>Az <code>OnPostConfirmationAsync</code> \u00e1ll\u00edtsa be a <code>user</code>-et a <code>DisplayName</code>-et.</li> <li>M\u00f3dos\u00edtsa az <code>ExternalLogin.cstml</code> oldal k\u00f3dj\u00e1t \u00fagy, hogy az k\u00f6telez\u0151en bek\u00e9rje a <code>DisplayName</code> \u00e9rt\u00e9k\u00e9t is.</li> </ul> <p></p> <p>A k\u00fcls\u0151 bel\u00e9p\u00e9s ut\u00e1n bek\u00e9ri a felhaszn\u00e1l\u00f3 nev\u00e9t is.</p> Seg\u00edts\u00e9g <ul> <li> <p>Input modell kieg\u00e9sz\u00edt\u00e9se     </p>ExternalLogin.cshtml.cs - Input model<pre><code>public class InputModel\n{\n    [Required]\n    [EmailAddress]\n    public string Email { get; set; }\n\n    [Required]\n    public string DisplayName { get; set; }\n}\n</code></pre><p></p> </li> <li> <p>DisplayName elment\u00e9se     </p>ExternalLogin.cshtml.cs - OnPostConfirmationAsync<pre><code>public async Task&lt;IActionResult&gt; OnPostConfirmationAsync(string returnUrl = null)\n{\n    returnUrl = returnUrl ?? Url.Content(\"~/\");\n    // Get the information about the user from the external login provider\n    var info = await _signInManager.GetExternalLoginInfoAsync();\n    if (info == null)\n    {\n        ErrorMessage = \"Error loading external login information during confirmation.\";\n        return RedirectToPage(\"./Login\", new { ReturnUrl = returnUrl });\n    }\n\n    if (ModelState.IsValid)\n    {\n        var user = CreateUser();\n        user.DisplayName = Input.DisplayName;\n\n        await _userStore.SetUserNameAsync(user, Input.Email, CancellationToken.None);\n        await _emailStore.SetEmailAsync(user, Input.Email, CancellationToken.None);\n\n        var result = await _userManager.CreateAsync(user);\n</code></pre><p></p> </li> <li> <p>Fel\u00fclet kieg\u00e9sz\u00edt\u00e9se     </p>ExternalLogin.cshtml<pre><code>&lt;div class=\"form-floating mb-3\"&gt;\n    &lt;input asp-for=\"Input.DisplayName\" class=\"form-control\" placeholder=\"Please enter your name.\" /&gt;\n    &lt;label asp-for=\"Input.DisplayName\" class=\"form-label\"&gt;&lt;/label&gt;\n    &lt;span asp-validation-for=\"Input.DisplayName\" class=\"text-danger\"&gt;&lt;/span&gt;\n&lt;/div&gt;\n</code></pre><p></p> </li> </ul>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#gdpr","title":"GDPR","text":"<p>Az ASP.NET a GDPR szab\u00e1lyoz\u00e1s betart\u00e1s\u00e1hoz is ny\u00fajt seg\u00edts\u00e9get. Az al\u00e1bbi linken p\u00e9ld\u00e1ul l\u00e1that\u00f3, hogy milyen egyszer\u0171en lehet a s\u00fctik haszn\u00e1lat\u00e1t elfogadtattni.</p> <p>ASP.NET t\u00e1mogat\u00e1s a GDPR-hoz</p>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.3%20Felhasznalokezeles/#migraciok-automatikus-futtatasa","title":"Migr\u00e1ci\u00f3k automatikus futtat\u00e1sa","text":"Middleware adatb\u00e1zis migr\u00e1ci\u00f3k futtat\u00e1s\u00e1hoz development m\u00f3dban <p>Fejleszt\u00e9s k\u00f6zben gyakran m\u00f3dosul az Entity Framework modell \u00e9s ilyenkor a migr\u00e1ci\u00f3 gener\u00e1l\u00e1sa ut\u00e1n k\u00e9zzel kell kiadni az <code>Update-Database</code> parancsot, ha migr\u00e1ci\u00f3s hiba miatt nem indul az alkalmaz\u00e1st. Ebben tud seg\u00edteni a <code>UseMigrationsEndPoint</code>, melynek haszn\u00e1lat\u00e1hoz a <code>Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore</code> NuGet package-et kell hozz\u00e1adni a Webes projekthez.</p> Program.cs<pre><code>if (app.Environment.IsDevelopment())\n{\n    // Processes requests to execute migrations operations\n    app.UseMigrationsEndPoint();\n}\n</code></pre>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.4%20Admin%20pages/","title":"4.4. Admin oldalak","text":""},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.4%20Admin%20pages/#44-admin-oldalak","title":"4.4. Admin oldalak","text":""},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.4%20Admin%20pages/#kategoriak-szerkesztese","title":"Kateg\u00f3ri\u00e1k szerkeszt\u00e9se","text":"<p>A ManageCategories oldalt m\u00e1r l\u00e9trehoztuk, most k\u00e9sz\u00edts\u00fck is el \u00fagy, hogy a bal oldalon megjelenik a kateg\u00f3ria fa ViewComponent, a jobb oldalon pedig att\u00f3l f\u00fcgg\u0151en, hogy v\u00e1lasztottunk-e ki kateg\u00f3ri\u00e1t a szerkeszt\u00e9s vagy \u00faj felvitele r\u00e9sz.</p> <p>A kateg\u00f3ria menedzsel\u00e9s\u00e9n\u00e9l a kateg\u00f3ria nev\u00e9t, a sz\u00fcl\u0151 kateg\u00f3ri\u00e1t \u00e9s a sorrendet szeretn\u00e9nk be\u00e1ll\u00edtani, illetve az Id-ra lesz sz\u00fcks\u00e9g, hogy el tudjuk d\u00f6nteni, hogy szerkeszt\u00e9sr\u0151l vagy \u00faj kateg\u00f3ria felvitel\u00e9r\u0151l van sz\u00f3.</p> <p>Jelenleg a <code>CategoryService</code>-ben a <code>GetCategoryTreeAsync()</code> egy <code>CategoryData</code> list\u00e1t ad vissza, amiben csak azok az adatok szerepelnek, amire a kateg\u00f3ria fa kirajzol\u00e1s\u00e1n\u00e1l sz\u00fcks\u00e9g van. Lehetne b\u0151v\u00edteni ezt a DTO-t, hogy a kateg\u00f3ria szerkeszt\u00e9sre \u00e9s l\u00e9trehoz\u00e1sra is alkalmas legyen (kv\u00e1zi minden adatot tartalmaz), azonban szerencs\u00e9sebb ha k\u00fcl\u00f6n DTO-t hozunk erre l\u00e9tre, mert \u00edgy \u00e1tl\u00e1that\u00f3bb a k\u00f3d \u00e9s a valid\u00e1ci\u00f3s szab\u00e1lyokat is r\u00e1 tudjuk tenni. Abban az esetben ha csak bizonyos mez\u0151k lenn\u00e9nek szerkeszthet\u0151k, akkor m\u00e9g a l\u00e9trehoz\u00e1shoz \u00e9s m\u00f3dos\u00edt\u00e1shoz haszn\u00e1l DTO-kat is k\u00fcl\u00f6n \u00e9rdemes felvenni. \u00cdgy a k\u00f3d \u00e1tl\u00e1that\u00f3s\u00e1ga n\u00f6velhet\u0151.</p> <ol> <li> <p>A megval\u00f3s\u00edt\u00e1shoz a DTO \u00e9s szolg\u00e1ltat\u00e1s oszt\u00e1lyok m\u00e1r k\u00e9szen vannak, n\u00e9zz\u00fck is \u00e1t, hogy mit kell haszn\u00e1lni.</p> <ul> <li>Az \u00f6sszes kateg\u00f3ri\u00e1t a <code>CategoryService</code>-ben tal\u00e1lhat\u00f3 <code>GetCategoryTreeAsync()</code> seg\u00edts\u00e9g\u00e9vel tudjuk lek\u00e9rdezni.</li> <li>A <code>CategoryService</code>-ben tal\u00e1lhat\u00f3 <code>AddOrUpdateAsync</code> met\u00f3dussal tudunk \u00faj kateg\u00f3ri\u00e1t l\u00e9trehozni, vagy egy megl\u00e9v\u0151t m\u00f3dos\u00edtani. Att\u00f3l f\u00fcgg, hogy szerkesztj\u00fck vagy l\u00e9trehozzuk a kateg\u00f3ri\u00e1t, hogy az Id ki van-e t\u00f6ltve. A met\u00f3dus egy <code>CreateOrEditCategory</code> DTO-t v\u00e1r ami alapj\u00e1n l\u00e9trehozza a <code>Category</code> entit\u00e1st \u00e9s besz\u00farja az adatb\u00e1zisba, majd visszaadja a <code>CategoryData</code>-t. Ezt most nem fogjuk kihaszn\u00e1lni, de egy Blazor alkalmaz\u00e1s eset\u00e9n hasznos lehet, hogy nem kell a teljes kateg\u00f3riaf\u00e1t \u00fajrat\u00f6lteni, hiszen az \u00fajonnan besz\u00far kateg\u00f3ria adatait egyb\u0151l visszakapjuk.</li> <li>Figyelj\u00fck meg, hogy a <code>CreateOrEditCategory</code> DTO-ba nem vett\u00fck fel a <code>Level</code>-t hiszen az egy sz\u00e1m\u00edtott tulajdons\u00e1g, illetve a valid\u00e1ci\u00f3hoz sz\u00fcks\u00e9ges annot\u00e1ci\u00f3kat is elk\u00e9sz\u00edtett\u00fck.</li> </ul> </li> <li> <p>A fentiek alapj\u00e1n k\u00e9sz\u00edts\u00fck el a <code>ManageCategories</code> oldalt is. Kezdj\u00fck az adatbet\u00f6lt\u00e9ssel.</p> <ul> <li>A primary konstruktorban v\u00e1rjuk az <code>ICategoryService</code>-t.</li> <li>Az oldalnak sz\u00fcks\u00e9ge lesz egy <code>CategoryId</code>-ra illetve egy Category-ra amit adatk\u00f6tni kell. Ebben t\u00e1roljuk a szerkeszt\u00e9shez kiv\u00e1lasztott kateg\u00f3ri\u00e1t, ami lehet null hiszen a l\u00e9trehoz\u00e1sn\u00e1l nem lesz kateg\u00f3ria kiv\u00e1lasztva.</li> <li>Az <code>OnGetAsync()</code>-ban pedig el\u0151sz\u00f6r le kell k\u00e9rni az \u00f6sszes kateg\u00f3ri\u00e1t, hogy a dropdown list\u00e1t fel tudjuk t\u00f6lteni elemekkel, illetve att\u00f3l f\u00fcgg\u0151en, hogy a CategoryId ki van-e t\u00f6ltve le kell k\u00e9rdezni a m\u00f3dos\u00edtand\u00f3 kateg\u00f3ri\u00e1t.</li> </ul> ManageCategories.cshtml.cs<pre><code>using BookShop.Bll.ServicesInterfaces;\nusing BookShop.Transfer.Dtos;\nusing Microsoft.AspNetCore.Mvc;\nusing Microsoft.AspNetCore.Mvc.RazorPages;\nusing Microsoft.AspNetCore.Mvc.Rendering;\n\nnamespace BookShop.Web.RazorPage.Pages.Admin;\n\npublic class ManageCategoriesModel(ICategoryService categoryService) : PageModel\n{\n    public IEnumerable&lt;SelectListItem&gt; AllCategories = [];\n\n    [BindProperty(SupportsGet = true)]\n    public int? CategoryId { get; set; }\n\n    [BindProperty]\n    public CreateOrEditCategory Category { get; set; } = new CreateOrEditCategory();\n\n    public async Task OnGetAsync()\n    { \n        var categoryList = await categoryService.GetCategoryTreeAsync();\n\n        // Create list for dropdown, indenting names based on level\n        AllCategories = categoryList.Select(c =&gt; new SelectListItem { \n            Text = c.Name.PadLeft(c.Name.Length + c.Level * 2, '\\xA0'), \n            Value = c.Id.ToString() \n        }); \n\n        if (CategoryId.HasValue) \n            Category = await categoryService.GetCategoryForEditAsync(CategoryId.Value); \n    }\n}\n</code></pre> </li> <li> <p>K\u00e9sz\u00edts\u00fck el az oldalhoz a cshtml-t is az al\u00e1bbiak szerint.</p> <ul> <li>Bal oldalra ker\u00fclj\u00f6n a categoryList ViewComponent.</li> <li>Jobb oldalon pedig k\u00e9rj\u00fck be az al\u00e1bbi adatokat, amit a SelectedCategory-hoz kell k\u00f6tni<ul> <li><code>Name</code> - sz\u00f6vegdoboz</li> <li><code>ParentCategoryId</code> \u2013 Dropdown lista, amiben az <code>AllCategories</code> adja meg a lehets\u00e9ges elemeket</li> <li><code>Order</code> \u2013 sz\u00f6vegdoboz.</li> <li>L\u00e9trehoz\u00e1s / M\u00f3dos\u00edt\u00e1s / M\u00e9gsem / T\u00f6rl\u00e9s gomb a megfelel\u0151 <code>asp-handler</code> be\u00e1ll\u00edt\u00e1s\u00e1val.</li> </ul> </li> </ul> ManageCategories.cshtml<pre><code>@page\n@model BookShop.Web.RazorPage.Pages.Admin.ManageCategoriesModel\n\n&lt;h2&gt;Kateg\u00f3ri\u00e1k menedzsel\u00e9se&lt;/h2&gt;\n&lt;p&gt;Az adminisztr\u00e1torok itt hozhatnak l\u00e9tre \u00faj kateg\u00f3ri\u00e1t, vagy m\u00f3dos\u00edthatj\u00e1k / t\u00f6r\u00f6lhetik a megl\u00e9v\u0151ket.&lt;/p&gt;\n\n&lt;div class=\"row\"&gt;\n    &lt;div class=\"col-md-3\"&gt;\n        &lt;vc:category-list category-id=\"@Model.CategoryId\" /&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"col-md-9\"&gt;\n        &lt;h2&gt;@(Model.CategoryId.HasValue ? \"Kateg\u00f3ria m\u00f3dos\u00edt\u00e1sa\" : \"\u00daj kateg\u00f3ria felvitele\")&lt;/h2&gt;\n\n        &lt;form method=\"post\" class=\"form-horizontal\" role=\"form\"&gt;\n            &lt;div asp-validation-summary=\"All\" class=\"text-danger\"&gt;&lt;/div&gt;\n\n            &lt;input type=\"hidden\" asp-for=\"Category.Id\" /&gt;\n\n            &lt;div class=\"form-floating mb-3\"&gt;\n                &lt;input class=\"form-control\" asp-for=\"Category.Name\" placeholder=\" \" /&gt;\n                &lt;label asp-for=\"Category.Name\"&gt;Kateg\u00f3ria neve&lt;/label&gt;\n            &lt;/div&gt;\n            &lt;div class=\"form-floating mb-3\"&gt;\n                &lt;select class=\"form-select\" asp-for=\"Category.ParentCategoryId\" asp-items=\"Model.AllCategories\"&gt;\n                    &lt;option value=\"\"&gt;Nincs&lt;/option&gt;\n                &lt;/select&gt;\n                &lt;label asp-for=\"Category.ParentCategoryId\"&gt;Sz\u00fcl\u0151 kateg\u00f3ria&lt;/label&gt;\n            &lt;/div&gt;\n            &lt;div class=\"form-floating mb-3\"&gt;\n                &lt;input class=\"form-control\" asp-for=\"Category.Order\" placeholder=\" \" /&gt;\n                &lt;label asp-for=\"Category.Order\"&gt;Sorrend&lt;/label&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"d-flex justify-content-between\"&gt;\n                &lt;button asp-page-handler=\"AddOrUpdate\" class=\"btn btn-primary\"&gt;\n                    @(Model.Category.Id.HasValue ? \"M\u00f3dos\u00edt\u00e1s\" : \"L\u00e9trehoz\u00e1s\")\n                &lt;/button&gt; \n\n                @if (Model.Category.Id.HasValue) \n                {\n                    &lt;button asp-page-handler=\"Cancel\" class=\"btn btn-dark\"&gt;M\u00e9gsem&lt;/button&gt;\n\n                    &lt;button asp-page-handler=\"Delete\" class=\"btn btn-danger\"&gt;T\u00f6rl\u00e9s&lt;/button&gt;\n                }\n            &lt;/div&gt;\n        &lt;/form&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre> <p>Figyelj\u00fck meg a k\u00f3dban az al\u00e1bbiakat:</p> <ul> <li><code>@if</code> r\u00e9szeket, amivel felt\u00e9telesen tudunk tartalmat megjelen\u00edteni.</li> <li>A <code>&lt;select&gt;</code> tag l\u00e9trehoz\u00e1s\u00e1t.</li> <li>Az <code>asp-page-handler</code> haszn\u00e1lat\u00e1t</li> <li>Az <code>asp-validation-summary</code>-t a form tagen bel\u00fclre helyezz\u00fck el.</li> <li> <p>AntiForgeryToken-t nem haszn\u00e1lunk, mert az alap\u00e9rtelmez\u00e9s szerint r\u00e1ker\u00fcl a form-ra.</p> T\u00f6bb sumbit gomb kezel\u00e9se <p>Ha egy \u0171rlapon t\u00f6bb submit gomb tal\u00e1lhat\u00f3 akkor az <code>asp-page-handler</code> seg\u00edts\u00e9g\u00e9vel tudunk k\u00f6zt\u00fcnk k\u00fcl\u00f6nbs\u00e9get tenni. A cshtml.cs-ben pedig az <code>OnPostXYZ</code> met\u00f3dusokkal tudjuk kezelni, ahol az XYZ az <code>asp-page-handler</code>-ben megadott r\u00e9sz.</p> </li> </ul> </li> <li> <p>Ha \u00edgy elind\u00edtjuk az alkalmaz\u00e1st, akkor azt tapasztaljuk, hogy t\u00e9nyleg csak Admin \u00e9rheti el az oldalt \u00e9s a linket is, ehhez l\u00e9pj\u00fcnk be az admin felhaszn\u00e1l\u00f3val (admin@exmaple.com / Password123!) Alap\u00e9rtelmez\u00e9s szerint az \u00faj kateg\u00f3ria l\u00e9trehoz\u00e1sa t\u00f6lt be, de ha r\u00e1kattintunk egy kateg\u00f3ri\u00e1ra akkor \u00e1tv\u00e1lt m\u00f3dos\u00edt\u00e1sra.</p> </li> <li> <p>Ezt k\u00f6vet\u0151en m\u00e1r csak annyi dolgunk van, hogy a form postol\u00e1st szerver oldalok kezelj\u00fck, teh\u00e1t megval\u00f3s\u00edtjuk az \u00faj kateg\u00f3ria l\u00e9trehoz\u00e1s\u00e1hoz, m\u00f3dos\u00edt\u00e1s\u00e1hoz, t\u00f6rl\u00e9s\u00e9hez \u00e9s m\u00e9gsem gombhoz sz\u00fcks\u00e9ges k\u00f3dot.</p> <ul> <li> <p>A l\u00e9trehoz\u00e1s \u00e9s m\u00f3dos\u00edt\u00e1st ugyanaz a gomb kezeli, csak m\u00e1s a felirata. Ennek a gombnak az <code>asp-page-hander=\"AddOrUpdate\"</code> van megadva, teh\u00e1t ehhez kell elk\u00e9sz\u00edteni a megfelel\u0151 met\u00f3dust, aminek a neve <code>OnPostAddOrUpdate</code> vagy ha aszinkron akkor <code>OnPostAddOrUpdateAsync</code> kell legyen.</p> ManageCategories.cshtml.cs - OnPostAddOrUpdateAsync<pre><code>public async Task&lt;IActionResult&gt; OnPostAddOrUpdateAsync()\n{\n    if (ModelState.IsValid) \n    { \n        await categoryService.AddOrUpdateAsync(Category); \n        return new RedirectToPageResult(\"/Admin/ManageCategories\"); \n    } \n\n    // TODO: Hiba eset\u00e9n a Model-t \u00fajra bet\u00f6lteni.\n    return Page(); \n}\n</code></pre> </li> <li> <p>M\u00e9gsem gomb csak null-ra \u00e1ll\u00edtja a kiv\u00e1lasztott <code>CategoryId</code>-t</p> ManageCategories.cshtml.cs - OnPostCancelAsync<pre><code>public async Task&lt;IActionResult&gt; OnPostCancelAsync()\n{\n    CategoryId = null;\n\n    return new RedirectToPageResult(\"/Admin/ManageCategories\");\n}\n</code></pre> </li> <li> <p>Hasonl\u00f3an a l\u00e9trehoz\u00e1shoz k\u00e9sz\u00edts\u00fck el a t\u00f6r\u00e9s gomb esem\u00e9nykezel\u0151j\u00e9t is.</p> ManageCategories.cshtml.cs - OnPostDeleteAsync<pre><code>public async Task&lt;IActionResult&gt; OnPostDeleteAsync() \n{ \n    if (Category.Id.HasValue) \n        await categoryService.DeleteAsync(Category.Id.Value); \n\n    return new RedirectToPageResult(\"/Admin/ManageCategories\"); \n}\n</code></pre> </li> </ul> Entit\u00e1s t\u00f6rl\u00e9se PK alapj\u00e1n <p>Figyelj\u00fck meg a <code>CategoryService.DeleteAsync()</code> k\u00f3dj\u00e1ban, hogy a k\u00f3dban nem k\u00e9rdezt\u00fck le a kateg\u00f3ri\u00e1t az adatb\u00e1zisb\u00f3l, hanem csak l\u00e9trehoztunk egy \u00faj <code>Category</code>-t, aminek az <code>Id</code>-j\u00e1t (Primary key) \u00e1ll\u00edtottuk be \u00e9s ez alapj\u00e1n t\u00f6r\u00f6lt\u00fck a rekordot az adatb\u00e1zisb\u00f3l. \u00cdgy egy adatb\u00e1zishoz fordul\u00e1st meg tudunk sp\u00f3rolni. A kikommentezett sorban l\u00e1that\u00f3 az a megold\u00e1s, ahol el\u0151sz\u00f6r lek\u00e9rdezz\u00fck adatb\u00e1zisb\u00f3l a rekordot \u00e9s ezt k\u00f6vet\u0151en t\u00f6r\u00f6lj\u00fck.</p> </li> <li> <p>Ind\u00edtsuk el az alkalmaz\u00e1st \u00e9s vegy\u00fcnk fel egy kateg\u00f3ri\u00e1t, megadva minden adat\u00e1t, majd szerkessz\u00fck meg \u00e9s t\u00f6r\u00f6lj\u00fck. Ezzel a happy path-t le is tesztelt\u00fck.</p> </li> <li>De mi a helyzet akkor nem adjuk meg a kateg\u00f3ria nev\u00e9t? Ha nem adtunk volna meg valid\u00e1ci\u00f3s szab\u00e1lyokat akkor az adatb\u00e1zis constraint miatt kapn\u00e1nk hib\u00e1t. Viszont mivel felvett\u00fck a k\u00f6telez\u0151 mez\u0151kh\u00f6z a <code>[Required]</code> attrib\u00fatumokat \u00edgy sz\u00e9p valid\u00e1ci\u00f3s hib\u00e1t kapunk.</li> <li> <p>Fontos, hogy a szerver oldali valid\u00e1ci\u00f3 a <code>Model.IsValid</code> h\u00edv\u00e1s miatt fut le. Erre mindig figyelni kell. Viszont hiba eset\u00e9n elt\u0171nnek a Sz\u00fcl\u0151 kateg\u00f3ria elemei. Ennek az az oka, hogy csak az <code>OnGetAsync()</code>-ban t\u00f6ltj\u00fck fel az <code>AllCategories</code>-t. A megold\u00e1s annyi, hogy akkor is t\u00f6lts\u00fck fel, ha valid\u00e1ci\u00f3s hiba van. Ennek a legegyszer\u0171bb m\u00f3dja, ha k\u00e9sz\u00edt\u00fcnk egy <code>LoadModelAsync()</code> met\u00f3dust \u00e9s oda szervezz\u00fck ki az \u00f6sszes ilyen adatfelt\u00f6lt\u00e9st, \u00e9s ezt h\u00edvjuk az <code>OnGetAsync()</code>-ban \u00e9s mindenhol ahol \u00fajra fel kell t\u00f6lteni az adatokat.</p> ManageCategories.cshtml.cs<pre><code>public async Task OnGetAsync()\n{\n    await LoadModelAsync();\n\n    if (CategoryId.HasValue) \n        Category = await categoryService.GetCategoryForEditAsync(CategoryId.Value); \n}\n\nprivate async Task LoadModelAsync()\n{\n    var categoryList = await categoryService.GetCategoryTreeAsync();\n\n    // Create list for dropdown, indenting names based on level\n    AllCategories = categoryList.Select(c =&gt; new SelectListItem\n    {\n        Text = c.Name.PadLeft(c.Name.Length + c.Level * 2, '\\xA0'),\n        Value = c.Id.ToString()\n    });\n}\n\npublic async Task&lt;IActionResult&gt; OnPostAddOrUpdateAsync()\n{\n    if (ModelState.IsValid) \n    { \n        await categoryService.AddOrUpdateAsync(Category); \n        return new RedirectToPageResult(\"/Admin/ManageCategories\"); \n    }\n\n    // Load the model if any validation error occurs, otherwise the dropdown will be empty and the page will not render correctly\n    await LoadModelAsync();\n    return Page(); \n}\n</code></pre> </li> </ol>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.4%20Admin%20pages/#kliens-oldali-validacio","title":"Kliens oldali valid\u00e1ci\u00f3","text":"<p>M\u00e1r majdnem k\u00e9szen is vagyunk, viszont \u00e9rdemes lenne a valid\u00e1ci\u00f3kat kliens oldalon is ki\u00e9rt\u00e9kelni. Ezt a jquery validate seg\u00edts\u00e9g\u00e9vel lehet megtenni, amit a <code>_ValidationScriptsPartial.cshtml</code>-ben l\u00e9v\u0151 k\u00f3dr\u00e9szlet tud beemelni. Ebben a f\u00e1jlban vannak a valid\u00e1ci\u00f3hoz sz\u00fcks\u00e9ges JavaScript f\u00e1jlok behivatkozva. Az\u00e9rt egy k\u00fcl\u00f6n partial view-ban, hogy csak azokon az oldalakon t\u00f6lts\u00fck be, ahol t\u00e9nyleg sz\u00fcks\u00e9ges.</p> <p>Az oldalainknak a v\u00e1za a <code>_Layout.csml</code> f\u00e1jlt tal\u00e1lhat\u00f3. Itt t\u00f6ltj\u00fck be azokat a CSS \u00e9s JS f\u00e1jlokat, ami minden oldalon sz\u00fcks\u00e9ges \u00e9s itt adjuk meg az oldal elrendez\u00e9s\u00e9t is.</p> <p>K\u00e9t k\u00f3dsort \u00e9rdemes kiemelni.</p> <ul> <li>A <code>@RenderBody()</code> hely\u00e9re ker\u00fclnek be az oldalak (p\u00e9ld\u00e1ul a <code>Book.cshtml</code>)</li> <li>Az oldal alj\u00e1n l\u00e9v\u0151 <code>@await RenderSectionAsync(\"Scripts\", required: false)</code> pedig egy opcion\u00e1lis <code>Scripts</code> nev\u0171 szekci\u00f3t hoz l\u00e9tre. \u00cdgy az oldalon jelen esetben a <code>ManageCategories.cshtml</code> ha l\u00e9trehozunk egy ilyen nev\u0171 szekci\u00f3t, akkor annak a tartalma ide fog beker\u00fclni.</li> </ul> <p>Teh\u00e1t a megold\u00e1s annyi, hogy a <code>ManageCategories.cshtml</code> oldal alj\u00e1ra tegy\u00fck oda az al\u00e1bbi k\u00f3dr\u00e9szletet.</p> ManageCategories.cshtml<pre><code>@section Scripts {\n    &lt;partial name=\"_ValidationScriptsPartial\" /&gt;\n}\n</code></pre> <p>\u00cdgy futtatva a k\u00f3dot m\u00e1r megt\u00f6rt\u00e9nik a kliens oldali valid\u00e1ci\u00f3s is, s\u0151t mivel m\u00e1r kliens oldalon kider\u00fcl a hiba el sem jut a szerverre a k\u00e9r\u00e9s, \u00edgy a leg\u00f6rd\u00fcl\u0151ben l\u00e9v\u0151 elemek is megmaradnak. Term\u00e9szetesen a <code>LoadModelAsync()</code> megold\u00e1sra \u00edgy is sz\u00fcks\u00e9g van, mert elk\u00e9pzelhet\u0151, hogy bizonyos hib\u00e1k csak szerver oldalon der\u00fclnek ki, teh\u00e1t \u00e9rdemes ezt a gyakorlatot k\u00f6vetni.</p> Ha mindent j\u00f3l csin\u00e1ltunk az al\u00e1bbi oldalt kapjuk <p></p> <p>A kateg\u00f3ria menedzsel\u0151 oldal kliens oldali valid\u00e1ci\u00f3val</p>"},{"location":"seminar/4%20-%20ASP.NET%20Razor%20Pages/4.4%20Admin%20pages/#konyvek-szerkesztese","title":"K\u00f6nyvek szerkeszt\u00e9se","text":"<ol> <li> <p>A kezd\u0151 oldalon a kateg\u00f3ria k\u00f6nyvek l\u00e1bl\u00e9c\u00e9be az \u00e1r mell\u00e9 az admin felhaszn\u00e1l\u00f3nak tegy\u00fcnk ki egy szerkeszt\u00e9s gombot, ami ugyan\u00fagy a <code>ManageBooks</code> oldalra visz minket a kiv\u00e1lasztott k\u00f6nyv <code>Id</code>-j\u00e1val, \u00edgy a k\u00f6nyv szerkeszt\u00e9s / t\u00f6rl\u00e9s is el\u00e9rhet\u0151 lesz navig\u00e1ci\u00f3val.</p> Index.cshtml<pre><code>&lt;div class=\"card-footer d-flex justify-content-evenly text-muted fw-bold small\"&gt;\n    @if (User.IsInRole(\"Admin\"))\n    {\n        &lt;a asp-page=\"/Admin/ManageBooks\" asp-route-bookId=\"@book.Id\"&gt;&lt;i class=\"bi bi-pencil-fill\"&gt;&lt;/i&gt;&lt;/a&gt;\n    }\n    @(book.DiscountedPrice ?? book.Price)&amp;nbsp;Ft\n&lt;/div&gt;\n</code></pre> K\u00f6nyv szerkeszt\u00e9s gomb <p></p> <p>Szerkeszt\u00e9s gomb a k\u00f6nyv alatt</p> </li> <li> <p>Hozzunk l\u00e9tre a <code>BookShop.Web.RazorPage</code> projektben a <code>Settings</code> mappa alatt egy <code>FileSettings</code> oszt\u00e1lyt, amibe a file felt\u00f6lt\u00e9ssel kapcsolatos be\u00e1ll\u00edt\u00e1sokat fogjuk felolvasni az <code>appsettings.json</code>-b\u00f3l.</p> FileSettings.cs<pre><code>namespace BookShop.Web.RazorPage.Settings;\n\npublic class FileSettings\n{\n    public int FileSizeLimit { get; set; }\n    public List&lt;string&gt; PermittedExtensions { get; set; } = [];\n}\n</code></pre> </li> <li> <p>Adjuk hozz\u00e1 az <code>appsettings.json</code>-h\u00f6z a be\u00e1ll\u00edt\u00e1s \u00e9rt\u00e9keit A ConnectionStrings m\u00f6g\u00e9. Az\u00e9rt nem az appsettings.Development.json-ba tessz\u00fck mert ez a be\u00e1ll\u00edt\u00e1s minden k\u00f6rnyezetben azonos lesz.</p> appsettings.json<pre><code>\"FileSettings\": {\n    \"FileSizeLimit\": 2097152,\n    \"PermittedExtensions\": [ \".jpg\" ]\n},\n</code></pre> </li> <li> <p>A <code>Program.cs</code>-t eg\u00e9sz\u00edts\u00fck ki, hogy ezt az Options-t is felolvassa. A k\u00f3dot k\u00f6zvetlen\u00fcl az <code>EmailSettings</code> felolvas\u00e1sa ut\u00e1n tegy\u00fck.</p> Program.cs<pre><code>builder.Services.Configure&lt;FileSettings&gt;(builder.Configuration.GetSection(\"FileSettings\"));\n</code></pre> </li> <li> <p>K\u00e9sz\u00edts\u00fck el az oldal k\u00f3dj\u00e1t</p> <ul> <li>Az oldal v\u00e1r egy opcion\u00e1lis BookId-t az URL-ben (GET eset\u00e9n)</li> <li>Itt is egy k\u00fcl\u00f6n DTO-t haszn\u00e1lunk a <code>CreateOrEditBook</code>-ot, amit bind-olni kell.</li> <li>A k\u00e9p felt\u00f6lt\u00e9shez is sz\u00fcks\u00e9ges egy <code>IFormFile</code> t\u00edpus\u00fa param\u00e9ter, amit bind-olni kell.</li> <li>A kateg\u00f3ri\u00e1k \u00e9s kiad\u00f3k kiv\u00e1laszt\u00e1s\u00e1t egy dropdown list\u00e1ban szeretn\u00e9nk megjelen\u00edteni, \u00edgy le kell k\u00e9rdezni az \u00f6sszes kateg\u00f3ri\u00e1t \u00e9s kiad\u00f3t is.</li> <li>Haszn\u00e1ljuk itt is a <code>LoadModelAsync</code>-os megold\u00e1st.</li> <li>Ha van BookId, akkor k\u00e9rdezz\u00fck le a szervert\u0151l az adatait <code>CreateOrEditBook</code> t\u00edpus.</li> <li> <p>Az <code>OnPostAddOrUpdateAsync</code> kicsivel \u00f6sszetettebb a k\u00e9pfelt\u00f6lt\u00e9s miatt.</p> <ul> <li>Valid\u00e1ljuk a Model-t,</li> <li>Ha t\u00f6lt\u00fcnk fel k\u00e9pet, de a kiterjeszt\u00e9se nem szerepel az <code>appsettings.json</code>-ban megadott list\u00e1ban akkor adjunk vissza valid\u00e1ci\u00f3s hib\u00e1t.</li> <li>Ments\u00fck el a k\u00f6nyv adatait a <code>BookService</code>-ben m\u00e1r l\u00e9tez\u0151 <code>AddOrUpdateAsync</code> met\u00f3dussal.</li> <li>Ha t\u00f6lt\u00fcnk fel k\u00e9pet, akkor ments\u00fck is le a f\u00e1jlrendszerbe.</li> <li>V\u00e9g\u00fcl ir\u00e1ny\u00edtsuk vissza a felhaszn\u00e1l\u00f3t az <code>Index</code> oldalra.</li> </ul> </li> <li> <p>A <code>OnPostDeleteAsync()</code> a sikeres t\u00f6rl\u00e9s ut\u00e1n ir\u00e1ny\u00edtson vissza az <code>Index</code> oldalra.</p> </li> </ul> ManageBooks.cshtml.cs<pre><code>using BookShop.Bll.ServicesInterfaces;\nusing BookShop.Transfer.Dtos;\nusing BookShop.Web.RazorPage.Settings;\nusing Microsoft.AspNetCore.Mvc;\nusing Microsoft.AspNetCore.Mvc.RazorPages;\nusing Microsoft.AspNetCore.Mvc.Rendering;\nusing Microsoft.Extensions.Options;\n\nnamespace BookShop.Web.RazorPage.Pages.Admin;\n\npublic class ManageBooksModel(IBookService bookService, ICategoryService categoryService, IPublisherService publisherService,\n    IOptions&lt;FileSettings&gt; fileSettingsOptions, IWebHostEnvironment environment) : PageModel\n{\n    private readonly IBookService bookService = bookService;\n    private readonly ICategoryService categoryService = categoryService;\n    private readonly IPublisherService publisherService = publisherService;\n    private readonly IWebHostEnvironment environment = environment;\n\n    // Must be public to be able to access from cshtml.\n    public readonly FileSettings FileSettings = fileSettingsOptions.Value;\n\n    [BindProperty(SupportsGet = true)]\n    public int? BookId { get; set; }\n\n    [BindProperty]\n    public CreateOrEditBook Book { get; set; } = new() { PublishYear = DateTime.Now.Year };\n\n    [BindProperty]\n    public IFormFile? CoverImage { get; set; }\n\n    public IEnumerable&lt;SelectListItem&gt; AllCategories { get; set; } = [];\n    public IEnumerable&lt;SelectListItem&gt; AllPublishers { get; set; } = [];\n\n    public async Task OnGetAsync()\n    {\n        await LoadModelAsync();\n\n        if (BookId.HasValue)\n            Book = await bookService.GetBookForEditAsync(BookId.Value);\n    }\n\n    public async Task&lt;IActionResult&gt; OnPostAddOrUpdateAsync()\n    {\n        if (!ModelState.IsValid)\n        {\n            await LoadModelAsync();\n            return Page();\n        }\n\n        var ext = Path.GetExtension(CoverImage?.FileName)?.ToLowerInvariant();\n\n        if (CoverImage is not null &amp;&amp; !FileSettings.PermittedExtensions.Contains(ext ?? \"\"))\n        {\n            // Add validation error if the file extension is not permitted.\n            ModelState.AddModelError(\"CoverImage\", \"A k\u00e9p kiterjeszt\u00e9se nem megfelel\u0151.\");\n\n            await LoadModelAsync();\n            return Page();\n        }\n\n        var updatedBook = await bookService.AddOrUpdateAsync(Book);\n\n        if (CoverImage?.Length &gt; 0)\n        {\n            var filePath = Path.Combine(this.environment.WebRootPath, $\"images/covers/{updatedBook.Id}{ext}\");\n            using var stream = System.IO.File.Create(filePath);\n            await CoverImage.CopyToAsync(stream);\n        }\n\n        return new RedirectToPageResult(\"/Index\");\n    }\n\n    public async Task&lt;IActionResult&gt; OnPostDeleteAsync()\n    {\n        if (Book?.Id is not null)\n            await bookService.DeleteAsync(Book.Id.Value);\n\n        return new RedirectToPageResult(\"/Index\");\n    }\n\n    private async Task LoadModelAsync()\n    {\n        var categoryList = await categoryService.GetCategoryTreeAsync();\n\n        AllCategories = categoryList.Select(c =&gt; new SelectListItem\n        {\n            Text = c.Name.PadLeft(c.Name.Length + (c.Level - 1) * 3, '\\xA0'),\n            Value = c.Id.ToString()\n        });\n\n        AllPublishers = (await publisherService.GetAllPublishersAsync()).Select(c =&gt; new SelectListItem\n        {\n            Text = c.Name,\n            Value = c.Id.ToString()\n        });\n    }\n}\n</code></pre> <ul> <li>Figyelj\u00fck meg hogy a DI-t\u00f3l elk\u00e9rt\u00fck az <code>IWebHostEnvironment</code>-et is, hogy amikor a k\u00e9pet lementj\u00fck ismerj\u00fck a <code>wwwroot</code> k\u00f6nyvt\u00e1r fizikai hely\u00e9t. </li> <li>A <code>FileSettings</code> publikus lett, hogy a file input tagben le tudjunk sz\u0171rni majd az enged\u00e9lyezett kiterjeszt\u00e9sekre.</li> </ul> </li> <li> <p>K\u00e9sz\u00edts\u00fck el az oldal megjelen\u00edt\u00e9s\u00e9t is.</p> <ul> <li>Az URL-ben v\u00e1rjuk a bookId-t ami opcion\u00e1lis \u00e9s eg\u00e9sz sz\u00e1m</li> <li>Az oldal c\u00edme v\u00e1ltozzon, hogy \"K\u00f6nyv szerkeszt\u00e9se\" vagy \"\u00daj k\u00f6nyv felvitele\"</li> <li>A <code>form</code> tagben meg kell adni az <code>enctype=\"multipart/form-data\"</code>, hogy tudjunk f\u00e1jlt felt\u00f6lteni.</li> <li>Tegy\u00fcnk ki validation summary-t.</li> <li> <p>Bal oldalon szerepeljenek a k\u00f6nyv adatai:</p> <ul> <li>kiad\u00f3: leg\u00f6rd\u00fcl\u0151 lista, </li> <li>kateg\u00f3ria: leg\u00f6rd\u00fcl\u0151 lista, a kiad\u00f3val egy sorban</li> <li>kiad\u00e1s \u00e9ve: number t\u00edpus\u00fa</li> <li>oldalsz\u00e1m: number t\u00edpus\u00fa \u00e9s a kiad\u00e1s \u00e9v\u00e9vel egy sorban.</li> <li>c\u00edm: sima input.</li> <li>alc\u00edm: sima input.</li> <li>f\u00fclsz\u00f6veg: text area</li> </ul> </li> <li> <p>Jobb oldalon a k\u00e9p felt\u00f6lt\u00e9s, \u00e1r \u00e9s kedvezm\u00e9nyes \u00e1r legyen.</p> </li> <li>L\u00e9trehoz\u00e1s / M\u00f3dos\u00edt\u00e1s illetve T\u00f6rl\u00e9s gombok a megfelel\u0151 <code>asp-page-handler</code>-rel.</li> </ul> ManageBooks.cshtml<pre><code>@page \"{bookId:int?}\"\n@model BookShop.Web.RazorPage.Pages.Admin.ManageBooksModel\n\n&lt;h1&gt;K\u00f6nyvek kezel\u00e9se&lt;/h1&gt;\n&lt;h2&gt;@( Model.BookId.HasValue ? \"K\u00f6nyv szerkeszt\u00e9se\" : \"\u00daj k\u00f6nyv felvitele\")&lt;/h2&gt;\n\n&lt;form method=\"post\" enctype=\"multipart/form-data\" class=\"form-horizontal\" role=\"form\"&gt;\n    &lt;div asp-validation-summary=\"All\" class=\"text-danger\"&gt;&lt;/div&gt;\n\n    &lt;input type=\"hidden\" asp-for=\"Book.Id\" /&gt;\n\n    &lt;div class=\"row g-4\"&gt;\n        &lt;div class=\"col-md-8\"&gt;\n            &lt;h4&gt;Alapadatok&lt;/h4&gt;\n            &lt;div class=\"row g-3\"&gt;\n                &lt;div class=\"col-lg-6\"&gt;\n                    &lt;div class=\"form-floating mb-3\"&gt;\n                        &lt;select class=\"form-select\" asp-for=\"Book.PublisherId\" asp-items=\"Model.AllPublishers\"&gt;\n                            &lt;option value=\"\"&gt;Nincs&lt;/option&gt;\n                        &lt;/select&gt;\n                        &lt;label asp-for=\"Book.PublisherId\"&gt;Kiad\u00f3&lt;/label&gt;\n                    &lt;/div&gt;\n                &lt;/div&gt;\n\n                &lt;div class=\"col-lg-6\"&gt;\n                    &lt;div class=\"form-floating mb-3\"&gt;\n                        &lt;select class=\"form-select\" asp-for=\"Book.CategoryId\" asp-items=\"Model.AllCategories\"&gt;\n                            &lt;option value=\"\"&gt;Nincs&lt;/option&gt;\n                        &lt;/select&gt;\n                        &lt;label asp-for=\"Book.CategoryId\"&gt;Kateg\u00f3ria&lt;/label&gt;\n                    &lt;/div&gt;\n                &lt;/div&gt;\n\n                &lt;div class=\"col-6\"&gt;\n                    &lt;div class=\"form-floating mb-3\"&gt;\n                        &lt;input class=\"form-control\" asp-for=\"Book.PublishYear\" placeholder=\" \" /&gt;\n                        &lt;label asp-for=\"Book.PublishYear\"&gt;Kiad\u00e1s \u00e9ve&lt;/label&gt;\n                    &lt;/div&gt;\n                &lt;/div&gt;\n\n                &lt;div class=\"col-6\"&gt;\n                    &lt;div class=\"form-floating mb-3\"&gt;\n                        &lt;input class=\"form-control\" asp-for=\"Book.PageNumber\" placeholder=\" \" /&gt;\n                        &lt;label asp-for=\"Book.PageNumber\"&gt;Oldalsz\u00e1m&lt;/label&gt;\n                    &lt;/div&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"form-floating mb-3\"&gt;\n                &lt;input class=\"form-control\" asp-for=\"Book.Title\" placeholder=\" \" /&gt;\n                &lt;label asp-for=\"Book.Title\"&gt;C\u00edm&lt;/label&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"form-floating mb-3\"&gt;\n                &lt;input class=\"form-control\" asp-for=\"Book.Subtitle\" placeholder=\" \" /&gt;\n                &lt;label asp-for=\"Book.Subtitle\"&gt;Alc\u00edm&lt;/label&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"form-floating mb-3\"&gt;\n                &lt;textarea class=\"form-control\" asp-for=\"Book.ShortDescription\" rows=\"10\" placeholder=\" \"&gt;&lt;/textarea&gt;\n                &lt;label asp-for=\"Book.ShortDescription\"&gt;F\u00fclsz\u00f6veg&lt;/label&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"col-md-4\"&gt;\n            &lt;h4&gt;Bor\u00edt\u00f3k\u00e9p&lt;/h4&gt;\n            &lt;div class=\"mb-3\"&gt;\n                &lt;input class=\"form-control\" asp-for=\"CoverImage\" accept=\"@string.Join(',', Model.FileSettings.PermittedExtensions)\" /&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"row g-3\"&gt;\n                &lt;div class=\"col-6\"&gt;\n                    &lt;div class=\"form-floating\"&gt;\n                        &lt;input class=\"form-control\" asp-for=\"Book.Price\" placeholder=\" \" /&gt;\n                        &lt;label asp-for=\"Book.Price\"&gt;\u00c1r&lt;/label&gt;\n                    &lt;/div&gt;\n                &lt;/div&gt;\n                &lt;div class=\"col-6\"&gt;\n                    &lt;div class=\"form-floating\"&gt;\n                        &lt;input class=\"form-control\" asp-for=\"Book.DiscountedPrice\" placeholder=\" \" /&gt;\n                        &lt;label asp-for=\"Book.DiscountedPrice\"&gt;Kedv. \u00e1r&lt;/label&gt;\n                    &lt;/div&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"d-flex justify-content-between\"&gt;\n            &lt;button asp-page-handler=\"AddOrUpdate\" class=\"btn btn-primary\"&gt;\n                @(Model.BookId is null ? \"L\u00e9trehoz\u00e1s\" : \"M\u00f3dos\u00edt\u00e1s\")\n            &lt;/button&gt;\n\n            @if (Model.BookId.HasValue)\n            {\n                &lt;button asp-page-handler=\"Delete\" class=\"btn btn-danger\"&gt;T\u00f6rl\u00e9s&lt;/button&gt;\n            }\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/form&gt;\n\n\n@section Scripts {\n    &lt;partial name=\"_ValidationScriptsPartial\" /&gt;\n}\n</code></pre> <ul> <li>Figyelj\u00fck meg, hogy itt is haszn\u00e1ljuk a kliens oldali valid\u00e1ci\u00f3t.</li> </ul> </li> </ol> K\u00f6nyv m\u00f3dos\u00edt\u00e1sa <p></p> <p>K\u00f6nyv szerkeszt\u00e9se</p> \u00daj k\u00f6nyv l\u00e9trehoz\u00e1sa <p></p> <p>K\u00f6nyv l\u00e9trehoz\u00e1sa valid\u00e1ci\u00f3s hib\u00e1k.</p> L\u00e9trehozott \u00faj k\u00f6nyv <p></p> <p>Sikeresen l\u00e9trehozott k\u00f6nyv</p>"},{"location":"seminar/5%20-%20Blazor/5.1%20Basics/","title":"5.1. Projekt fel\u00e9p\u00edt\u00e9se, alapok","text":""},{"location":"seminar/5%20-%20Blazor/5.1%20Basics/#51-projekt-felepitese-alapok","title":"5.1. Projekt fel\u00e9p\u00edt\u00e9se, alapok","text":"<p>A labor anyag m\u00e9g fejleszt\u00e9s alatt \u00e1ll!</p> <p>Ezen a laboron egy Blazor WebApp projektet hozunk l\u00e9tre, melyben megn\u00e9zz\u00fck, hogyan \u00e9p\u00fcl fel egy modern interakt\u00edv kliens fejleszt\u00e9s\u00e9re alkalmaz Blazor alkalmaz\u00e1s a hozz\u00e1 tartoz\u00f3 szerver oldal API projekttel.</p>"},{"location":"seminar/5%20-%20Blazor/5.1%20Basics/#blazor-web-app-projekt-letrehozasa","title":"Blazor Web App projekt l\u00e9trehoz\u00e1sa","text":"<ol> <li> <p>Hozzuk l\u00e9tre az \u00faj Blazor Web App projektek <code>BookShop.Web</code> n\u00e9vvel. Val\u00f3j\u00e1ban ez k\u00e9t projektet fog l\u00e9trehozni. Egy ASP.NET Core projektet <code>BookShop.Web</code> n\u00e9vvel, ami a szerver oldali API-t (controller) tartalmazza \u00e9s egy Blazor Web Assembly projektet <code>BookShop.Web.Client</code> n\u00e9vvel, ami a b\u00f6ng\u00e9sz\u0151ben fut\u00f3 kliens oldali k\u00f3dot tartalmazza.</p> L\u00e9trehoz\u00e1s k\u00e9pery\u0151i <p></p> <p>Projekt t\u00edpus kiv\u00e1laszt\u00e1sa</p> <p></p> <p>Projekt neve \u00e9s k\u00f6nyvt\u00e1ra</p> <p></p> <p>Projekt adatok</p> <ul> <li>Figyelj\u00fck meg, hogy az utols\u00f3 l\u00e9p\u00e9sben be\u00e1ll\u00edtottuk, hogy<ul> <li>Az Interactive render mode: WebAssembly</li> <li>Az interactivity location: Global</li> <li>Bekapcsoltuk a Use the .dev.localhost TLD in the application URL: Azaz, hogy az alkalmaz\u00e1s URL-je haszn\u00e1lja a <code>.dev.localhost</code> top-level-domain-t. Ennek r\u00e9szletei a hivatalos dokument\u00e1ci\u00f3ban olvashat\u00f3k.</li> </ul> </li> </ul> </li> <li> <p>L\u00e9tre is j\u00f6n a k\u00e9t projekt\u00fcnk \u00fagyhogy be\u00e1ll\u00edthatjuk, hogy a <code>BookShop.Web</code> azaz a szerver oldali projekt legyen a Startup projekt\u00fcnk. Ind\u00edtsuk is el.</p> Elindul az app <p></p> <p>A l\u00e9trehozott alkalmaz\u00e1s el is indul</p> <ul> <li>Az alkalmaz\u00e1s URL-je val\u00f3ban <code>https://bookshop-web.dev.localhost:7211/</code> lett.</li> </ul> </li> <li> <p>Ha megn\u00e9zz\u00fck f\u00e1jlrendszerben is az solution-t akkor viszont azt vehetj\u00fck \u00e9szre, hogy a <code>BookShop.Web</code> k\u00f6nyvt\u00e1r megtal\u00e1lhat\u00f3, de a <code>BookShop.Web.Client</code>-et nem l\u00e1tjuk. Ennek az az oka, hogy val\u00f3j\u00e1ban a <code>BookShop.Web</code> amit l\u00e1tunk csak egy k\u00f6nyvt\u00e1r \u00e9s azon bel\u00fcl tatl\u00e1hat\u00f3 a k\u00e9t l\u00e9trehozott projekt a megfelel\u0151 nevekkel.</p> Projekt k\u00f6nyvt\u00e1r strukt\u00far\u00e1ja <p></p> <p>L\u00e9trehozott projektek egy k\u00f6nyvt\u00e1rral lentebb tal\u00e1lhat\u00f3k</p> </li> </ol>"},{"location":"seminar/5%20-%20Blazor/5.1%20Basics/#projekt-struktura","title":"Projekt strukt\u00fara","text":"<p>A <code>BookShop.Web</code> a szerver oldali k\u00f3dot tartalmazza, ide fogjuk majd a Controller-eket l\u00e9trehozni, ami a kliens meg tud majd h\u00edvni HTTP k\u00e9r\u00e9seken kereszt\u00fcl.</p> <p>A <code>BookShop.Web.Client</code> tartalmazza a b\u00f6ng\u00e9sz\u0151ben fut\u00f3 kliens oldali k\u00f3dot. Ennek a projektnek a kimenet\u00e9t t\u00f6lti le a kliens \u00e9s futtatja a b\u00f6ng\u00e9sz\u0151ben, teh\u00e1t minden olyan oldalt \u00e9s k\u00f3dot a <code>Client</code> projektbe kell tenni, amit kliens oldalon kell el\u00e9rni.</p> <p></p> <p>A l\u00e9trehozott Blazor Web App fel\u00e9p\u00edt\u00e9se.</p>"},{"location":"seminar/5%20-%20Blazor/5.1%20Basics/#bookshopweb","title":"BookShop.Web","text":"<ol> <li> <p>A szerver oldali projekt (ami val\u00f3j\u00e1ban egy egyszer\u0171 ASP.NET Core projekt) tartalmaz egy referenci\u00e1t a kliens oldali k\u00f3dra is, ha az interakt\u00edv web assembly renderel\u00e9s be van kapcsolva. Erre az\u00e9rt van sz\u00fcks\u00e9g, hogy a <code>Program.cs</code>-ben be tudjuk h\u00fazni a kliens oldali k\u00f3dot is, illetve e miatt indul el a szerverrel egy\u00fctt a kliens is, \u00e9s \u00edgy tudjuk egyben telep\u00edteni is.</p> <ul> <li>A <code>wwwroot</code> alatt tal\u00e1lhat\u00f3k a statikusan kiszolg\u00e1land\u00f3 f\u00e1jlok. (CSS, JS, k\u00e9pek ...)</li> <li>A <code>Pages</code> alatt csak egy hibaoldal tal\u00e1lhat\u00f3. Fontos, hogy az itt tal\u00e1lhat\u00f3 oldalak szerver oldalon renderel\u0151dnek.</li> <li>Az <code>App.razor</code> tartalmazza a kliens oldali alkalmaz\u00e1s v\u00e1zat, ebbe t\u00f6lt\u0151dnek majd be a kliens oldalon defini\u00e1lt oldalak.</li> <li>Az <code>appsettings.json</code> tartalmazza a konfigur\u00e1ci\u00f3 f\u00fcgg\u0151 szerver oldali be\u00e1ll\u00edt\u00e1sokat.</li> <li>A <code>Program.cs</code> a szerver oldali alkalmaz\u00e1s bel\u00e9p\u00e9si pontja.</li> </ul> </li> </ol>"},{"location":"seminar/5%20-%20Blazor/5.1%20Basics/#apprazor","title":"App.razor","text":"<p>Az <code>App.razor</code> az alkalmaz\u00e1s gy\u00f6k\u00e9rkomponense.A gy\u00f6k\u00e9rkomponens az els\u0151 komponens, amelyet az alkalmaz\u00e1s bet\u00f6lt.</p> <p>Mint l\u00e1that\u00f3 itt hivatkozzuk be a CSS \u00e9s JS f\u00e1jlokat, t\u00f6bbek k\u00f6z\u00f6tt a <code>_framework/blazor.web.js</code>-t is amit a Blazor keretrendszer k\u00f3dja. Azt is figyelj\u00fck meg, hogy ezeket a statikus tartalmakat \u00fagy linkej\u00fck meg, hogy az <code>@Assets[]</code> t\u00f6mbb\u0151l indexelj\u00fck ki. Ez az\u00e9rt el\u0151ny\u00f6s, mert ezeket a statikus tartalmakat telep\u00edt\u00e9sk\u00f6r bet\u00f6m\u00f6r\u00edtve is felker\u00fclnek a szerverre, \u00edgy amikor a kliens let\u00f6lti, azonnak a t\u00f6m\u00f6r\u00edtett verzi\u00f3t lehet lek\u00fcldeni.</p> <ul> <li><code>&lt;ResourcePreloader /&gt;</code>: .NET 10-ben a Blazor webalkalmaz\u00e1sok ezt a komponenst haszn\u00e1lj\u00e1k a keretrendszer statikus f\u00e1jljainak el\u0151zetes bet\u00f6lt\u00e9s\u00e9hez, a  fejl\u00e9cek helyett.</li> <li><code>&lt;ImportMap /&gt;</code>: </li> <li><code>&lt;HeadOutlet @rendermode=\"InteractiveWebAssembly\" /&gt;</code>: Lehet\u0151s\u00e9get ad arra, hogy az egyes oldalakon defini\u00e1ljunk elemeket, amit a <code>&lt;head&gt;</code> HTML tag v\u00e9g\u00e9re kell f\u0171zni, mint p\u00e9ld\u00e1ul a <code>title</code> vagy <code>meta</code> tag.</li> <li><code>&lt;Routes @rendermode=\"InteractiveWebAssembly\" /&gt;</code>: A <code>.Client</code> projektben defini\u00e1lt <code>Routes.razor</code> komponenst jelen\u00edti meg.</li> </ul> App.razor<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n\n&lt;head&gt;\n    &lt;meta charset=\"utf-8\" /&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /&gt;\n    &lt;base href=\"/\" /&gt;\n    &lt;ResourcePreloader /&gt;\n    &lt;link rel=\"stylesheet\" href=\"@Assets[\"lib/bootstrap/dist/css/bootstrap.min.css\"]\" /&gt;\n    &lt;link rel=\"stylesheet\" href=\"@Assets[\"app.css\"]\" /&gt;\n    &lt;link rel=\"stylesheet\" href=\"@Assets[\"BookShop.Web.styles.css\"]\" /&gt;\n    &lt;ImportMap /&gt;\n    &lt;link rel=\"icon\" type=\"image/png\" href=\"favicon.png\" /&gt;\n    &lt;HeadOutlet @rendermode=\"InteractiveWebAssembly\" /&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n    &lt;Routes @rendermode=\"InteractiveWebAssembly\" /&gt;\n    &lt;script src=\"@Assets[\"_framework/blazor.web.js\"]\"&gt;&lt;/script&gt;\n&lt;/body&gt;\n\n&lt;/html&gt;\n</code></pre> <p>A PreRender bonyol\u00edthatja az alkalmaz\u00e1s m\u0171k\u00f6d\u00e9s\u00e9t, mivel az alkalmaz\u00e1s Razor komponenseinek k\u00e9tszer kell renderelni\u00fck: egyszer a PreRender-hez, egyszer pedig az interaktivit\u00e1s be\u00e1ll\u00edt\u00e1s\u00e1hoz. Ha a komponensek WebAssembly-n val\u00f3 futtat\u00e1sra vannak be\u00e1ll\u00edtva, akkor a komponenseket \u00fagy kell megtervezni, hogy mind a szerverr\u0151l, mind a kliensr\u0151l futtathat\u00f3k legyenek. E miatt c\u00e9lszer\u0171 a PreRender funkci\u00f3t kikapcsolni.</p> <p>A PreRender funkci\u00f3 letilt\u00e1s\u00e1hoz, \u00edrjuk \u00e1t a a <code>&lt;Routes&gt;</code> komponensben a <code>@rendermode</code> \u00e9rt\u00e9k\u00e9t az al\u00e1bbira.</p> App.razor<pre><code>&lt;Routes @rendermode=\"new InteractiveWebAssemblyRenderMode(prerender: false)\" /&gt;\n</code></pre>"},{"location":"seminar/5%20-%20Blazor/5.1%20Basics/#programcs","title":"Program.cs","text":"<p>Nagyon hasonl\u00f3 a fel\u00e9p\u00edt\u00e9se mint a kor\u00e1bban haszn\u00e1lt ASP.NET Razor Page eset\u00e9n, hiszen ez is egy ASP.NET Core projekt.     - Beregisztr\u00e1ljuk az interakt\u00edv web assembly komponenseket.     - Debug m\u00f3dban felcsatoljuk a web assembly debuggert.     - UseStatusCodePagesWithReExecute: A HTTP st\u00e1tusz k\u00f3dokhoz tudunk egyedi hibaoldalakat rendelni.     - UseAntiforgery: XSRF / CSRF t\u00e1mad\u00e1sok elleni v\u00e9dele. R\u00e9szletek a hivatalos dokument\u00e1ci\u00f3ban tal\u00e1lhat\u00f3k: Prevent Cross-Site Request Forgery (XSRF/CSRF) attacks in ASP.NET Core     - Be\u00e1ll\u00edtjuk, hogy a render mode WebAssembly legyen \u00e9s beregisztr\u00e1ljuk a kliens oldali oldalakat / komponenseket</p> Program.cs<pre><code>using BookShop.Web.Client.Pages;\nusing BookShop.Web.Components;\n\nvar builder = WebApplication.CreateBuilder(args);\n\n// Add services to the container.\nbuilder.Services.AddRazorComponents()\n    .AddInteractiveWebAssemblyComponents();\n\nvar app = builder.Build();\n\n// Configure the HTTP request pipeline.\nif (app.Environment.IsDevelopment())\n{\n    app.UseWebAssemblyDebugging();\n}\nelse\n{\n    app.UseExceptionHandler(\"/Error\", createScopeForErrors: true);\n    // The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.\n    app.UseHsts();\n}\napp.UseStatusCodePagesWithReExecute(\"/not-found\", createScopeForStatusCodePages: true);\napp.UseHttpsRedirection();\n\napp.UseAntiforgery();\n\napp.MapStaticAssets();\napp.MapRazorComponents&lt;App&gt;()\n    .AddInteractiveWebAssemblyRenderMode()\n    .AddAdditionalAssemblies(typeof(BookShop.Web.Client._Imports).Assembly);\n\napp.Run();\n</code></pre>"},{"location":"seminar/5%20-%20Blazor/5.1%20Basics/#bookshopwebclient","title":"BookShop.Web.Client","text":""},{"location":"seminar/5%20-%20Blazor/5.2%20Main%20pages/","title":"5.2. F\u0151bb oldalak l\u00e9trehoz\u00e1sa","text":""},{"location":"seminar/5%20-%20Blazor/5.2%20Main%20pages/#52-fobb-oldalak-letrehozasa","title":"5.2. F\u0151bb oldalak l\u00e9trehoz\u00e1sa","text":"<p>A labor anyag m\u00e9g fejleszt\u00e9s alatt \u00e1ll!</p>"},{"location":"seminar/5%20-%20Blazor/5.3%20Felhasznalokezeles/","title":"5.3. Felhaszn\u00e1l\u00f3 kezel\u00e9s","text":""},{"location":"seminar/5%20-%20Blazor/5.3%20Felhasznalokezeles/#53-felhasznalo-kezeles","title":"5.3. Felhaszn\u00e1l\u00f3 kezel\u00e9s","text":"<p>A labor anyag m\u00e9g fejleszt\u00e9s alatt \u00e1ll!</p>"},{"location":"seminar/5%20-%20Blazor/5.4%20Admin%20pages/","title":"5.4. Admin oldalak","text":""},{"location":"seminar/5%20-%20Blazor/5.4%20Admin%20pages/#54-admin-oldalak","title":"5.4. Admin oldalak","text":"<p>A labor anyag m\u00e9g fejleszt\u00e9s alatt \u00e1ll!</p>"}]}